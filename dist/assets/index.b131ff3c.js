const Qm=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};Qm();class Tm extends Map{set(e,t){return super.set(e,t),t}}class lh extends WeakMap{set(e,t){return super.set(e,t),t}}/*! (c) Andrea Giammarchi - ISC */const Pm=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,Am=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/?)>/g,Rm=/([^\s\\>"'=]+)\s*=\s*(['"]?)\x01/g,Cm=/[\x01\x02]/g,Im=(n,e,t)=>{let i=0;return n.join("").trim().replace(Am,(r,s,o,l)=>{let a=s+o.replace(Rm,"=$2$1").trimEnd();return l.length&&(a+=t||Pm.test(s)?" /":"></"+s),"<"+a+">"}).replace(Cm,r=>r===""?"<!--"+e+i+++"-->":e+i++)},Em=1,ad=111,Wm=({firstChild:n,lastChild:e})=>{const t=document.createRange();return t.setStartAfter(n),t.setEndAfter(e),t.deleteContents(),n},Dm=(n,e)=>n.nodeType===ad?1/e<0?e?Wm(n):n.lastChild:e?n.valueOf():n.firstChild:n,Mm=n=>{const{firstChild:e,lastChild:t}=n;if(e===t)return t||n;const{childNodes:i}=n,r=[...i];return{ELEMENT_NODE:Em,nodeType:ad,firstChild:e,lastChild:t,valueOf(){return i.length!==r.length&&n.append(...r),n}}},{isArray:Bm}=Array,Lm=n=>e=>{for(const t in e){const i=t==="role"?t:`aria-${t}`,r=e[t];r==null?n.removeAttribute(i):n.setAttribute(i,r)}},zm=(n,e)=>{let t,i=!0;const r=document.createAttributeNS(null,e);return s=>{if(t!==s)if(t=s,t==null)i||(n.removeAttributeNode(r),i=!0);else{const o=s;o==null?(i||n.removeAttributeNode(r),i=!0):(r.value=o,i&&(n.setAttributeNodeNS(r),i=!1))}}},_m=(n,e,t)=>i=>{t!==!!i&&((t=!!i)?n.setAttribute(e,""):n.removeAttribute(e))},Um=({dataset:n})=>e=>{for(const t in e){const i=e[t];i==null?delete n[t]:n[t]=i}},ac=(n,e)=>{let t,i,r=e.slice(2);return!(e in n)&&(i=e.toLowerCase())in n&&(r=i.slice(2)),s=>{const o=Bm(s)?s:[s,!1];t!==o[0]&&(t&&n.removeEventListener(r,t,o[1]),(t=o[0])&&n.addEventListener(r,t,o[1]))}},Nm=n=>{let e;return t=>{e!==t&&(e=t,typeof t=="function"?t(n):t.current=n)}},Xm=(n,e)=>e==="dataset"?Um(n):t=>{n[e]=t},Zm=n=>{let e;return t=>{e!=t&&(e=t,n.textContent=t==null?"":t)}},jm=(n,e,t,i,r)=>{const s=t.length;let o=e.length,l=s,a=0,h=0,c=null;for(;a<o||h<l;)if(o===a){const f=l<s?h?i(t[h-1],-0).nextSibling:i(t[l-h],0):r;for(;h<l;)n.insertBefore(i(t[h++],1),f)}else if(l===h)for(;a<o;)(!c||!c.has(e[a]))&&n.removeChild(i(e[a],-1)),a++;else if(e[a]===t[h])a++,h++;else if(e[o-1]===t[l-1])o--,l--;else if(e[a]===t[l-1]&&t[h]===e[o-1]){const f=i(e[--o],-1).nextSibling;n.insertBefore(i(t[h++],1),i(e[a++],-1).nextSibling),n.insertBefore(i(t[--l],1),f),e[o]=t[l]}else{if(!c){c=new Map;let f=h;for(;f<l;)c.set(t[f],f++)}if(c.has(e[a])){const f=c.get(e[a]);if(h<f&&f<l){let u=a,d=1;for(;++u<o&&u<l&&c.get(e[u])===f+d;)d++;if(d>f-h){const p=i(e[a],0);for(;h<f;)n.insertBefore(i(t[h++],1),p)}else n.replaceChild(i(t[h++],1),i(e[a++],-1))}else a++}else n.removeChild(i(e[a++],-1))}return t},{isArray:hd,prototype:Gm}=Array,{indexOf:qm}=Gm,{createDocumentFragment:Fm,createElement:Vm,createElementNS:Ym,createTextNode:Hm,createTreeWalker:Jm,importNode:Km}=new Proxy(document,{get:(n,e)=>n[e].bind(n)}),eO=n=>{const e=Vm("template");return e.innerHTML=n,e.content};let Jr;const tO=n=>{Jr||(Jr=Ym("http://www.w3.org/2000/svg","svg")),Jr.innerHTML=n;const e=Fm();return e.append(...Jr.childNodes),e},iO=(n,e)=>e?tO(n):eO(n),nO=({childNodes:n},e)=>n[e],Fn=(n,e,t)=>jm(n.parentNode,e,t,Dm,n),rO=n=>{let e,t,i=[];const r=s=>{switch(typeof s){case"string":case"number":case"boolean":e!==s&&(e=s,t||(t=Hm("")),t.data=s,i=Fn(n,i,[t]));break;case"object":case"undefined":if(s==null){e!=s&&(e=s,i=Fn(n,i,[]));break}if(hd(s)){e=s,s.length===0?i=Fn(n,i,[]):typeof s[0]=="object"?i=Fn(n,i,s):r(String(s));break}e!==s&&"ELEMENT_NODE"in s&&(e=s,i=Fn(n,i,s.nodeType===11?[...s.childNodes]:[s]));break;case"function":r(s(n));break}};return r},sO=(n,e)=>{switch(e[0]){case"?":return _m(n,e.slice(1),!1);case".":return Xm(n,e.slice(1));case"@":return ac(n,"on"+e.slice(1));case"o":if(e[1]==="n")return ac(n,e)}switch(e){case"ref":return Nm(n);case"aria":return Lm(n)}return zm(n,e)};function oO(n){const{type:e,path:t}=n,i=t.reduceRight(nO,this);return e==="node"?rO(i):e==="attr"?sO(i,n.name):Zm(i)}const Jo=n=>{const e=[];let{parentNode:t}=n;for(;t;)e.push(qm.call(t.childNodes,n)),n=t,{parentNode:t}=n;return e},Vn="is\xB5",hc=new lh,lO=/^(?:textarea|script|style|title|plaintext|xmp)$/,br=()=>({stack:[],entry:null,wire:null}),aO=(n,e)=>{const{content:t,updates:i}=cO(n,e);return{type:n,template:e,content:t,updates:i,wire:null}},hO=(n,e)=>{const t=n==="svg",i=Im(e,Vn,t),r=iO(i,t),s=Jm(r,129),o=[],l=e.length-1;let a=0,h=`${Vn}${a}`;for(;a<l;){const c=s.nextNode();if(!c)throw`bad template: ${i}`;if(c.nodeType===8)c.data===h&&(o.push({type:"node",path:Jo(c)}),h=`${Vn}${++a}`);else{for(;c.hasAttribute(h);)o.push({type:"attr",path:Jo(c),name:c.getAttribute(h)}),c.removeAttribute(h),h=`${Vn}${++a}`;lO.test(c.localName)&&c.textContent.trim()===`<!--${h}-->`&&(c.textContent="",o.push({type:"text",path:Jo(c)}),h=`${Vn}${++a}`)}}return{content:r,nodes:o}},cO=(n,e)=>{const{content:t,nodes:i}=hc.get(e)||hc.set(e,hO(n,e)),r=Km(t,!0),s=i.map(oO,r);return{content:r,updates:s}},Ls=(n,{type:e,template:t,values:i})=>{const r=cd(n,i);let{entry:s}=n;(!s||s.template!==t||s.type!==e)&&(n.entry=s=aO(e,t));const{content:o,updates:l,wire:a}=s;for(let h=0;h<r;h++)l[h](i[h]);return a||(s.wire=Mm(o))},cd=({stack:n},e)=>{const{length:t}=e;for(let i=0;i<t;i++){const r=e[i];r instanceof zs?e[i]=Ls(n[i]||(n[i]=br()),r):hd(r)?cd(n[i]||(n[i]=br()),r):n[i]=null}return t<n.length&&n.splice(t),t};class zs{constructor(e,t,i){this.type=e,this.template=t,this.values=i}}const fd=n=>{const e=new lh,t=i=>(r,...s)=>Ls(i,{type:n,template:r,values:s});return Object.assign((i,...r)=>new zs(n,i,r),{for(i,r){const s=e.get(i)||e.set(i,new Tm);return s.get(r)||s.set(r,t(br()))},node:(i,...r)=>Ls(br(),new zs(n,i,r)).valueOf()})},cc=new lh,fO=(n,e)=>{const t=typeof e=="function"?e():e,i=cc.get(n)||cc.set(n,br()),r=t instanceof zs?Ls(i,t):t;return r!==i.wire&&(i.wire=r,n.replaceChildren(r.valueOf())),n},Kt=fd("html");fd("svg");function ah(n){const e=n.codemirror.state.doc.toString(),t=e.match(/@title:\s+([^\n]+)/),i=t!==null?t[1]:"DRAFT",r=Object.fromEntries(n.savedGames);if(i in r&&r[i]===e)return;const s=[i,e],o=n.savedGames.filter(a=>a[0]!==i).slice(0,4),l=[s,...o];n.savedGames=l,window.localStorage.setItem("puzzle-lab",JSON.stringify(l))}var Tt={exports:{}},nn={exports:{}};function fc(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function uO(n){nn.exports.defaults=n}nn.exports={defaults:fc(),getDefaults:fc,changeDefaults:uO};const dO=/[&<>"']/,pO=/[&<>"']/g,gO=/[<>"']|&(?!#?\w+;)/,mO=/[<>"']|&(?!#?\w+;)/g,OO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},uc=n=>OO[n];function xO(n,e){if(e){if(dO.test(n))return n.replace(pO,uc)}else if(gO.test(n))return n.replace(mO,uc);return n}const bO=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function ud(n){return n.replace(bO,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const yO=/(^|[^\[])\^/g;function wO(n,e){n=n.source||n,e=e||"";const t={replace:(i,r)=>(r=r.source||r,r=r.replace(yO,"$1"),n=n.replace(i,r),t),getRegex:()=>new RegExp(n,e)};return t}const SO=/[^\w:]/g,kO=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function $O(n,e,t){if(n){let i;try{i=decodeURIComponent(ud(t)).replace(SO,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}e&&!kO.test(t)&&(t=dd(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const Kr={},vO=/^[^:]+:\/*[^/]*$/,QO=/^([^:]+:)[\s\S]*$/,TO=/^([^:]+:\/*[^/]*)[\s\S]*$/;function dd(n,e){Kr[" "+n]||(vO.test(n)?Kr[" "+n]=n+"/":Kr[" "+n]=pd(n,"/",!0)),n=Kr[" "+n];const t=n.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:n.replace(QO,"$1")+e:e.charAt(0)==="/"?t?e:n.replace(TO,"$1")+e:n+e}const PO={exec:function(){}};function AO(n){let e=1,t,i;for(;e<arguments.length;e++){t=arguments[e];for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n}function RO(n,e){const t=n.replace(/\|/g,(s,o,l)=>{let a=!1,h=o;for(;--h>=0&&l[h]==="\\";)a=!a;return a?"|":" |"}),i=t.split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i[i.length-1].trim()||i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function pd(n,e,t){const i=n.length;if(i===0)return"";let r=0;for(;r<i;){const s=n.charAt(i-r-1);if(s===e&&!t)r++;else if(s!==e&&t)r++;else break}return n.substr(0,i-r)}function CO(n,e){if(n.indexOf(e[1])===-1)return-1;const t=n.length;let i=0,r=0;for(;r<t;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])i++;else if(n[r]===e[1]&&(i--,i<0))return r;return-1}function IO(n){n&&n.sanitize&&!n.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function EO(n,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=n),e>>=1,n+=n;return t+n}var _n={escape:xO,unescape:ud,edit:wO,cleanUrl:$O,resolveUrl:dd,noopTest:PO,merge:AO,splitCells:RO,rtrim:pd,findClosingBracket:CO,checkSanitizeDeprecation:IO,repeatString:EO};const{defaults:WO}=nn.exports,{rtrim:Ko,splitCells:dc,escape:mt,findClosingBracket:DO}=_n;function pc(n,e,t,i){const r=e.href,s=e.title?mt(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const l={type:"link",raw:t,href:r,title:s,text:o,tokens:i.inlineTokens(o,[])};return i.state.inLink=!1,l}else return{type:"image",raw:t,href:r,title:s,text:mt(o)}}function MO(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(r=>{const s=r.match(/^\s+/);if(s===null)return r;const[o]=s;return o.length>=i.length?r.slice(i.length):r}).join(`
`)}var hh=class{constructor(e){this.options=e||WO}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:`
`}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Ko(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=MO(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim():t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=Ko(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}const r={type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:[]};return this.lexer.inline(r.text,r.tokens),r}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const i=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(i,[]),text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,r,s,o,l,a,h,c,f,u,d=t[1].trim();const p=d.length>1,g={type:"list",raw:"",ordered:p,start:p?+d.slice(0,-1):"",loose:!1,items:[]};d=p?`\\d{1,9}\\${d.slice(-1)}`:`\\${d}`,this.options.pedantic&&(d=p?d:"[*+-]");const x=new RegExp(`^( {0,3}${d})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!(this.rules.block.hr.test(e)||!(t=x.exec(e)));){f=t[2].split(`
`),this.options.pedantic?(o=2,u=f[0].trimLeft()):(o=t[2].search(/[^ ]/),o=t[1].length+(o>4?1:o),u=f[0].slice(o-t[1].length)),a=!1,i=t[0],!f[0]&&/^ *$/.test(f[1])&&(i=t[1]+f.slice(0,2).join(`
`)+`
`,g.loose=!0,f=[]);const m=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(l=1;l<f.length;l++){if(c=f[l],this.options.pedantic&&(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),m.test(c)){i=t[1]+f.slice(0,l).join(`
`)+`
`;break}if(!a){c.trim()||(a=!0),c.search(/[^ ]/)>=o?u+=`
`+c.slice(o):u+=`
`+c;continue}if(c.search(/[^ ]/)>=o||!c.trim()){u+=`
`+c.slice(o);continue}else{i=t[1]+f.slice(0,l).join(`
`)+`
`;break}}g.loose||(h?g.loose=!0:/\n *\n *$/.test(i)&&(h=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(u),r&&(s=r[0]!=="[ ] ",u=u.replace(/^\[[ xX]\] +/,""))),g.items.push({type:"list_item",raw:i,task:!!r,checked:s,loose:!1,text:u}),g.raw+=i,e=e.slice(i.length)}g.items[g.items.length-1].raw=i.trimRight(),g.items[g.items.length-1].text=u.trimRight(),g.raw=g.raw.trimRight();const Q=g.items.length;for(l=0;l<Q;l++)this.lexer.state.top=!1,g.items[l].tokens=this.lexer.blockTokens(g.items[l].text,[]),g.items[l].tokens.some(m=>m.type==="space")&&(g.loose=!0,g.items[l].loose=!0);return g}}html(e){const t=this.rules.block.html.exec(e);if(t){const i={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(t[0]):mt(t[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}}def(e){const t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));const i=t[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:i,raw:t[0],href:t[2],title:t[3]}}}table(e){const t=this.rules.block.table.exec(e);if(t){const i={type:"table",header:dc(t[1]).map(r=>({text:r})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=t[0];let r=i.align.length,s,o,l,a;for(s=0;s<r;s++)/^ *-+: *$/.test(i.align[s])?i.align[s]="right":/^ *:-+: *$/.test(i.align[s])?i.align[s]="center":/^ *:-+ *$/.test(i.align[s])?i.align[s]="left":i.align[s]=null;for(r=i.rows.length,s=0;s<r;s++)i.rows[s]=dc(i.rows[s],i.header.length).map(h=>({text:h}));for(r=i.header.length,o=0;o<r;o++)i.header[o].tokens=[],this.lexer.inlineTokens(i.header[o].text,i.header[o].tokens);for(r=i.rows.length,o=0;o<r;o++)for(a=i.rows[o],l=0;l<a.length;l++)a[l].tokens=[],this.lexer.inlineTokens(a[l].text,a[l].tokens);return i}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const i={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}text(e){const t=this.rules.block.text.exec(e);if(t){const i={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:mt(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):mt(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=Ko(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=DO(t[2],"()");if(o>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),pc(t,{href:r&&r.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let r=(i[2]||i[1]).replace(/\s+/g," ");if(r=t[r.toLowerCase()],!r||!r.href){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return pc(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrong.lDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;const s=r[1]||r[2]||"";if(!s||s&&(i===""||this.rules.inline.punctuation.exec(i))){const o=r[0].length-1;let l,a,h=o,c=0;const f=r[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+o);(r=f.exec(t))!=null;){if(l=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!l)continue;if(a=l.length,r[3]||r[4]){h+=a;continue}else if((r[5]||r[6])&&o%3&&!((o+a)%3)){c+=a;continue}if(h-=a,h>0)continue;if(a=Math.min(a,a+h+c),Math.min(o,a)%2){const d=e.slice(1,o+r.index+a);return{type:"em",raw:e.slice(0,o+r.index+a+1),text:d,tokens:this.lexer.inlineTokens(d,[])}}const u=e.slice(2,o+r.index+a-1);return{type:"strong",raw:e.slice(0,o+r.index+a+1),text:u,tokens:this.lexer.inlineTokens(u,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return r&&s&&(i=i.substring(1,i.length-1)),i=mt(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let r,s;return i[2]==="@"?(r=mt(this.options.mangle?t(i[1]):i[1]),s="mailto:"+r):(r=mt(i[1]),s=r),{type:"link",raw:i[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let r,s;if(i[2]==="@")r=mt(this.options.mangle?t(i[0]):i[0]),s="mailto:"+r;else{let o;do o=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(o!==i[0]);r=mt(i[0]),i[1]==="www."?s="http://"+r:s=r}return{type:"link",raw:i[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let r;return this.lexer.state.inRawBlock?r=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):mt(i[0]):i[0]:r=mt(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:r}}}};const{noopTest:_s,edit:me,merge:rn}=_n,ee={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:_s,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};ee._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/;ee._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;ee.def=me(ee.def).replace("label",ee._label).replace("title",ee._title).getRegex();ee.bullet=/(?:[*+-]|\d{1,9}[.)])/;ee.listItemStart=me(/^( *)(bull) */).replace("bull",ee.bullet).getRegex();ee.list=me(ee.list).replace(/bull/g,ee.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ee.def.source+")").getRegex();ee._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";ee._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;ee.html=me(ee.html,"i").replace("comment",ee._comment).replace("tag",ee._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();ee.paragraph=me(ee._paragraph).replace("hr",ee.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ee._tag).getRegex();ee.blockquote=me(ee.blockquote).replace("paragraph",ee.paragraph).getRegex();ee.normal=rn({},ee);ee.gfm=rn({},ee.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});ee.gfm.table=me(ee.gfm.table).replace("hr",ee.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ee._tag).getRegex();ee.pedantic=rn({},ee.normal,{html:me(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ee._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:_s,paragraph:me(ee.normal._paragraph).replace("hr",ee.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ee.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const Z={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:_s,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:_s,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};Z._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";Z.punctuation=me(Z.punctuation).replace(/punctuation/g,Z._punctuation).getRegex();Z.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;Z.escapedEmSt=/\\\*|\\_/g;Z._comment=me(ee._comment).replace("(?:-->|$)","-->").getRegex();Z.emStrong.lDelim=me(Z.emStrong.lDelim).replace(/punct/g,Z._punctuation).getRegex();Z.emStrong.rDelimAst=me(Z.emStrong.rDelimAst,"g").replace(/punct/g,Z._punctuation).getRegex();Z.emStrong.rDelimUnd=me(Z.emStrong.rDelimUnd,"g").replace(/punct/g,Z._punctuation).getRegex();Z._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;Z._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;Z._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;Z.autolink=me(Z.autolink).replace("scheme",Z._scheme).replace("email",Z._email).getRegex();Z._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;Z.tag=me(Z.tag).replace("comment",Z._comment).replace("attribute",Z._attribute).getRegex();Z._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;Z._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;Z._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;Z.link=me(Z.link).replace("label",Z._label).replace("href",Z._href).replace("title",Z._title).getRegex();Z.reflink=me(Z.reflink).replace("label",Z._label).getRegex();Z.reflinkSearch=me(Z.reflinkSearch,"g").replace("reflink",Z.reflink).replace("nolink",Z.nolink).getRegex();Z.normal=rn({},Z);Z.pedantic=rn({},Z.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:me(/^!?\[(label)\]\((.*?)\)/).replace("label",Z._label).getRegex(),reflink:me(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Z._label).getRegex()});Z.gfm=rn({},Z.normal,{escape:me(Z.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});Z.gfm.url=me(Z.gfm.url,"i").replace("email",Z.gfm._extended_email).getRegex();Z.breaks=rn({},Z.gfm,{br:me(Z.br).replace("{2,}","*").getRegex(),text:me(Z.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var BO={block:ee,inline:Z};const LO=hh,{defaults:zO}=nn.exports,{block:es,inline:Yn}=BO,{repeatString:gc}=_n;function _O(n){return n.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function mc(n){let e="",t,i;const r=n.length;for(t=0;t<r;t++)i=n.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e}var gd=class _l{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||zO,this.options.tokenizer=this.options.tokenizer||new LO,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:es.normal,inline:Yn.normal};this.options.pedantic?(t.block=es.pedantic,t.inline=Yn.pedantic):this.options.gfm&&(t.block=es.gfm,this.options.breaks?t.inline=Yn.breaks:t.inline=Yn.gfm),this.tokenizer.rules=t}static get rules(){return{block:es,inline:Yn}}static lex(e,t){return new _l(t).lex(e)}static lexInline(e,t){return new _l(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let i,r,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(l=>(i=l.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.type&&t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+i.raw,r.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+i.raw,r.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let l=1/0;const a=e.slice(1);let h;this.options.extensions.startBlock.forEach(function(c){h=c.call({lexer:this},a),typeof h=="number"&&h>=0&&(l=Math.min(l,h))}),l<1/0&&l>=0&&(s=e.substring(0,l+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){r=t[t.length-1],o&&r.type==="paragraph"?(r.raw+=`
`+i.raw,r.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+i.raw,r.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let i,r,s,o=e,l,a,h;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)c.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,l.index)+"["+gc("a",l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,l.index)+"["+gc("a",l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(l=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,l.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(a||(h=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>(i=c.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,h)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e,mc)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e,mc))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const f=e.slice(1);let u;this.options.extensions.startInline.forEach(function(d){u=d.call({lexer:this},f),typeof u=="number"&&u>=0&&(c=Math.min(c,u))}),c<1/0&&c>=0&&(s=e.substring(0,c+1))}if(i=this.tokenizer.inlineText(s,_O)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(h=i.raw.slice(-1)),a=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}};const{defaults:UO}=nn.exports,{cleanUrl:Oc,escape:ts}=_n;var ch=class{constructor(e){this.options=e||UO}code(e,t,i){const r=(t||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(e,r);s!=null&&s!==e&&(i=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="'+this.options.langPrefix+ts(r,!0)+'">'+(i?e:ts(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:ts(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,i,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(i)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,i){const r=t?"ol":"ul",s=t&&i!==1?' start="'+i+'"':"";return"<"+r+s+`>
`+e+"</"+r+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(e=Oc(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let r='<a href="'+ts(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+i+"</a>",r}image(e,t,i){if(e=Oc(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let r='<img src="'+e+'" alt="'+i+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">",r}text(e){return e}},fh=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}},uh=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,r=0;if(this.seen.hasOwnProperty(i)){r=this.seen[e];do r++,i=e+"-"+r;while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=r,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}};const NO=ch,XO=fh,ZO=uh,{defaults:jO}=nn.exports,{unescape:GO}=_n;var md=class Ul{constructor(e){this.options=e||jO,this.options.renderer=this.options.renderer||new NO,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new XO,this.slugger=new ZO}static parse(e,t){return new Ul(t).parse(e)}static parseInline(e,t){return new Ul(t).parseInline(e)}parse(e,t=!0){let i="",r,s,o,l,a,h,c,f,u,d,p,g,x,Q,m,b,y,w,v;const R=e.length;for(r=0;r<R;r++){if(d=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[d.type]&&(v=this.options.extensions.renderers[d.type].call({parser:this},d),v!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type))){i+=v||"";continue}switch(d.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(d.tokens),d.depth,GO(this.parseInline(d.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(d.text,d.lang,d.escaped);continue}case"table":{for(f="",c="",l=d.header.length,s=0;s<l;s++)c+=this.renderer.tablecell(this.parseInline(d.header[s].tokens),{header:!0,align:d.align[s]});for(f+=this.renderer.tablerow(c),u="",l=d.rows.length,s=0;s<l;s++){for(h=d.rows[s],c="",a=h.length,o=0;o<a;o++)c+=this.renderer.tablecell(this.parseInline(h[o].tokens),{header:!1,align:d.align[o]});u+=this.renderer.tablerow(c)}i+=this.renderer.table(f,u);continue}case"blockquote":{u=this.parse(d.tokens),i+=this.renderer.blockquote(u);continue}case"list":{for(p=d.ordered,g=d.start,x=d.loose,l=d.items.length,u="",s=0;s<l;s++)m=d.items[s],b=m.checked,y=m.task,Q="",m.task&&(w=this.renderer.checkbox(b),x?m.tokens.length>0&&m.tokens[0].type==="paragraph"?(m.tokens[0].text=w+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&m.tokens[0].tokens[0].type==="text"&&(m.tokens[0].tokens[0].text=w+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:w}):Q+=w),Q+=this.parse(m.tokens,x),u+=this.renderer.listitem(Q,y,b);i+=this.renderer.list(u,p,g);continue}case"html":{i+=this.renderer.html(d.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(d.tokens));continue}case"text":{for(u=d.tokens?this.parseInline(d.tokens):d.text;r+1<R&&e[r+1].type==="text";)d=e[++r],u+=`
`+(d.tokens?this.parseInline(d.tokens):d.text);i+=t?this.renderer.paragraph(u):u;continue}default:{const N='Token with "'+d.type+'" type was not found.';if(this.options.silent){console.error(N);return}else throw new Error(N)}}}return i}parseInline(e,t){t=t||this.renderer;let i="",r,s,o;const l=e.length;for(r=0;r<l;r++){if(s=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){i+=o||"";continue}switch(s.type){case"escape":{i+=t.text(s.text);break}case"html":{i+=t.html(s.text);break}case"link":{i+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{i+=t.image(s.href,s.title,s.text);break}case"strong":{i+=t.strong(this.parseInline(s.tokens,t));break}case"em":{i+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{i+=t.codespan(s.text);break}case"br":{i+=t.br();break}case"del":{i+=t.del(this.parseInline(s.tokens,t));break}case"text":{i+=t.text(s.text);break}default:{const a='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(a);return}else throw new Error(a)}}}return i}};const yr=gd,wr=md,Od=hh,xd=ch,qO=fh,FO=uh,{merge:Po,checkSanitizeDeprecation:bd,escape:yd}=_n,{getDefaults:VO,changeDefaults:YO,defaults:HO}=nn.exports;function te(n,e,t){if(typeof n=="undefined"||n===null)throw new Error("marked(): input parameter is undefined or null");if(typeof n!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=Po({},te.defaults,e||{}),bd(e),t){const i=e.highlight;let r;try{r=yr.lex(n,e)}catch(l){return t(l)}const s=function(l){let a;if(!l)try{e.walkTokens&&te.walkTokens(r,e.walkTokens),a=wr.parse(r,e)}catch(h){l=h}return e.highlight=i,l?t(l):t(null,a)};if(!i||i.length<3||(delete e.highlight,!r.length))return s();let o=0;te.walkTokens(r,function(l){l.type==="code"&&(o++,setTimeout(()=>{i(l.text,l.lang,function(a,h){if(a)return s(a);h!=null&&h!==l.text&&(l.text=h,l.escaped=!0),o--,o===0&&s()})},0))}),o===0&&s();return}try{const i=yr.lex(n,e);return e.walkTokens&&te.walkTokens(i,e.walkTokens),wr.parse(i,e)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+yd(i.message+"",!0)+"</pre>";throw i}}te.options=te.setOptions=function(n){return Po(te.defaults,n),YO(te.defaults),te};te.getDefaults=VO;te.defaults=HO;te.use=function(...n){const e=Po({},...n),t=te.defaults.extensions||{renderers:{},childTokens:{}};let i;n.forEach(r=>{if(r.extensions&&(i=!0,r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const o=t.renderers?t.renderers[s.name]:null;o?t.renderers[s.name]=function(...l){let a=s.renderer.apply(this,l);return a===!1&&(a=o.apply(this,l)),a}:t.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[s.level]?t[s.level].unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}s.childTokens&&(t.childTokens[s.name]=s.childTokens)})),r.renderer){const s=te.defaults.renderer||new xd;for(const o in r.renderer){const l=s[o];s[o]=(...a)=>{let h=r.renderer[o].apply(s,a);return h===!1&&(h=l.apply(s,a)),h}}e.renderer=s}if(r.tokenizer){const s=te.defaults.tokenizer||new Od;for(const o in r.tokenizer){const l=s[o];s[o]=(...a)=>{let h=r.tokenizer[o].apply(s,a);return h===!1&&(h=l.apply(s,a)),h}}e.tokenizer=s}if(r.walkTokens){const s=te.defaults.walkTokens;e.walkTokens=o=>{r.walkTokens.call(this,o),s&&s(o)}}i&&(e.extensions=t),te.setOptions(e)})};te.walkTokens=function(n,e){for(const t of n)switch(e(t),t.type){case"table":{for(const i of t.header)te.walkTokens(i.tokens,e);for(const i of t.rows)for(const r of i)te.walkTokens(r.tokens,e);break}case"list":{te.walkTokens(t.items,e);break}default:te.defaults.extensions&&te.defaults.extensions.childTokens&&te.defaults.extensions.childTokens[t.type]?te.defaults.extensions.childTokens[t.type].forEach(function(i){te.walkTokens(t[i],e)}):t.tokens&&te.walkTokens(t.tokens,e)}};te.parseInline=function(n,e){if(typeof n=="undefined"||n===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof n!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected");e=Po({},te.defaults,e||{}),bd(e);try{const t=yr.lexInline(n,e);return e.walkTokens&&te.walkTokens(t,e.walkTokens),wr.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+yd(t.message+"",!0)+"</pre>";throw t}};te.Parser=wr;te.parser=wr.parse;te.Renderer=xd;te.TextRenderer=qO;te.Lexer=yr;te.lexer=yr.lex;te.Tokenizer=Od;te.Slugger=FO;te.parse=te;var JO=te;const wd=JO,Sd=gd,kd=md,KO=hh,ex=ch,tx=fh,ix=uh;Tt.exports=wd;Tt.exports.parse=wd;Tt.exports.Parser=kd;Tt.exports.parser=kd.parse;Tt.exports.Renderer=ex;Tt.exports.TextRenderer=tx;Tt.exports.Lexer=Sd;Tt.exports.lexer=Sd.lex;Tt.exports.Tokenizer=KO;Tt.exports.Slugger=ix;var nx=Tt.exports;customElements.define("markdown-renderer",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){new MutationObserver(()=>this.update()).observe(this,{childList:!0}),this.update()}update(){let n=`${nx(this.innerHTML)}`;n=n.replaceAll("&amp;gt;",">").replaceAll("&amp;lt;","<"),this.shadowRoot.innerHTML=n}});const rx=n=>Kt`
  <markdown-renderer>
<link rel="stylesheet" href="/docs.css" />

${n.docs}
  </markdown-renderer>
`;class sx extends Map{set(e,t){return super.set(e,t),t}}class dh extends WeakMap{set(e,t){return super.set(e,t),t}}/*! (c) Andrea Giammarchi - ISC */const ox=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,lx=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/?)>/g,ax=/([^\s\\>"'=]+)\s*=\s*(['"]?)\x01/g,hx=/[\x01\x02]/g;var cx=(n,e,t)=>{let i=0;return n.join("").trim().replace(lx,(r,s,o,l)=>{let a=s+o.replace(ax,"=$2$1").trimEnd();return l.length&&(a+=t||ox.test(s)?" /":"></"+s),"<"+a+">"}).replace(hx,r=>r===""?"<!--"+e+i+++"-->":e+i++)};const fx=1,$d=111,ux=({firstChild:n,lastChild:e})=>{const t=document.createRange();return t.setStartAfter(n),t.setEndAfter(e),t.deleteContents(),n},dx=(n,e)=>n.nodeType===$d?1/e<0?e?ux(n):n.lastChild:e?n.valueOf():n.firstChild:n,px=n=>{const{firstChild:e,lastChild:t}=n;if(e===t)return t||n;const{childNodes:i}=n,r=[...i];return{ELEMENT_NODE:fx,nodeType:$d,firstChild:e,lastChild:t,valueOf(){return i.length!==r.length&&n.append(...r),n}}},{isArray:gx}=Array,mx=n=>e=>{for(const t in e){const i=t==="role"?t:`aria-${t}`,r=e[t];r==null?n.removeAttribute(i):n.setAttribute(i,r)}},Ox=(n,e)=>{let t,i=!0;const r=document.createAttributeNS(null,e);return s=>{if(t!==s)if(t=s,t==null)i||(n.removeAttributeNode(r),i=!0);else{const o=s;o==null?(i||n.removeAttributeNode(r),i=!0):(r.value=o,i&&(n.setAttributeNodeNS(r),i=!1))}}},xx=(n,e,t)=>i=>{t!==!!i&&((t=!!i)?n.setAttribute(e,""):n.removeAttribute(e))},bx=({dataset:n})=>e=>{for(const t in e){const i=e[t];i==null?delete n[t]:n[t]=i}},xc=(n,e)=>{let t,i,r=e.slice(2);return!(e in n)&&(i=e.toLowerCase())in n&&(r=i.slice(2)),s=>{const o=gx(s)?s:[s,!1];t!==o[0]&&(t&&n.removeEventListener(r,t,o[1]),(t=o[0])&&n.addEventListener(r,t,o[1]))}},yx=n=>{let e;return t=>{e!==t&&(e=t,typeof t=="function"?t(n):t.current=n)}},wx=(n,e)=>e==="dataset"?bx(n):t=>{n[e]=t},Sx=n=>{let e;return t=>{e!=t&&(e=t,n.textContent=t==null?"":t)}};var kx=(n,e,t,i,r)=>{const s=t.length;let o=e.length,l=s,a=0,h=0,c=null;for(;a<o||h<l;)if(o===a){const f=l<s?h?i(t[h-1],-0).nextSibling:i(t[l-h],0):r;for(;h<l;)n.insertBefore(i(t[h++],1),f)}else if(l===h)for(;a<o;)(!c||!c.has(e[a]))&&n.removeChild(i(e[a],-1)),a++;else if(e[a]===t[h])a++,h++;else if(e[o-1]===t[l-1])o--,l--;else if(e[a]===t[l-1]&&t[h]===e[o-1]){const f=i(e[--o],-1).nextSibling;n.insertBefore(i(t[h++],1),i(e[a++],-1).nextSibling),n.insertBefore(i(t[--l],1),f),e[o]=t[l]}else{if(!c){c=new Map;let f=h;for(;f<l;)c.set(t[f],f++)}if(c.has(e[a])){const f=c.get(e[a]);if(h<f&&f<l){let u=a,d=1;for(;++u<o&&u<l&&c.get(e[u])===f+d;)d++;if(d>f-h){const p=i(e[a],0);for(;h<f;)n.insertBefore(i(t[h++],1),p)}else n.replaceChild(i(t[h++],1),i(e[a++],-1))}else a++}else n.removeChild(i(e[a++],-1))}return t};const{isArray:vd,prototype:$x}=Array,{indexOf:vx}=$x,{createDocumentFragment:Qx,createElement:Tx,createElementNS:Px,createTextNode:Ax,createTreeWalker:Rx,importNode:Cx}=new Proxy(document,{get:(n,e)=>n[e].bind(n)}),Ix=n=>{const e=Tx("template");return e.innerHTML=n,e.content};let is;const Ex=n=>{is||(is=Px("http://www.w3.org/2000/svg","svg")),is.innerHTML=n;const e=Qx();return e.append(...is.childNodes),e},Wx=(n,e)=>e?Ex(n):Ix(n),Dx=({childNodes:n},e)=>n[e],Hn=(n,e,t)=>kx(n.parentNode,e,t,dx,n),Mx=n=>{let e,t,i=[];const r=s=>{switch(typeof s){case"string":case"number":case"boolean":e!==s&&(e=s,t||(t=Ax("")),t.data=s,i=Hn(n,i,[t]));break;case"object":case"undefined":if(s==null){e!=s&&(e=s,i=Hn(n,i,[]));break}if(vd(s)){e=s,s.length===0?i=Hn(n,i,[]):typeof s[0]=="object"?i=Hn(n,i,s):r(String(s));break}e!==s&&"ELEMENT_NODE"in s&&(e=s,i=Hn(n,i,s.nodeType===11?[...s.childNodes]:[s]));break;case"function":r(s(n));break}};return r},Bx=(n,e)=>{switch(e[0]){case"?":return xx(n,e.slice(1),!1);case".":return wx(n,e.slice(1));case"@":return xc(n,"on"+e.slice(1));case"o":if(e[1]==="n")return xc(n,e)}switch(e){case"ref":return yx(n);case"aria":return mx(n)}return Ox(n,e)};function Lx(n){const{type:e,path:t}=n,i=t.reduceRight(Dx,this);return e==="node"?Mx(i):e==="attr"?Bx(i,n.name):Sx(i)}const el=n=>{const e=[];let{parentNode:t}=n;for(;t;)e.push(vx.call(t.childNodes,n)),n=t,{parentNode:t}=n;return e},Jn="is\xB5",bc=new dh,zx=/^(?:textarea|script|style|title|plaintext|xmp)$/,Sr=()=>({stack:[],entry:null,wire:null}),_x=(n,e)=>{const{content:t,updates:i}=Nx(n,e);return{type:n,template:e,content:t,updates:i,wire:null}},Ux=(n,e)=>{const t=n==="svg",i=cx(e,Jn,t),r=Wx(i,t),s=Rx(r,129),o=[],l=e.length-1;let a=0,h=`${Jn}${a}`;for(;a<l;){const c=s.nextNode();if(!c)throw`bad template: ${i}`;if(c.nodeType===8)c.data===h&&(o.push({type:"node",path:el(c)}),h=`${Jn}${++a}`);else{for(;c.hasAttribute(h);)o.push({type:"attr",path:el(c),name:c.getAttribute(h)}),c.removeAttribute(h),h=`${Jn}${++a}`;zx.test(c.localName)&&c.textContent.trim()===`<!--${h}-->`&&(c.textContent="",o.push({type:"text",path:el(c)}),h=`${Jn}${++a}`)}}return{content:r,nodes:o}},Nx=(n,e)=>{const{content:t,nodes:i}=bc.get(e)||bc.set(e,Ux(n,e)),r=Cx(t,!0),s=i.map(Lx,r);return{content:r,updates:s}},Us=(n,{type:e,template:t,values:i})=>{const r=Qd(n,i);let{entry:s}=n;(!s||s.template!==t||s.type!==e)&&(n.entry=s=_x(e,t));const{content:o,updates:l,wire:a}=s;for(let h=0;h<r;h++)l[h](i[h]);return a||(s.wire=px(o))},Qd=({stack:n},e)=>{const{length:t}=e;for(let i=0;i<t;i++){const r=e[i];r instanceof Ns?e[i]=Us(n[i]||(n[i]=Sr()),r):vd(r)?Qd(n[i]||(n[i]=Sr()),r):n[i]=null}return t<n.length&&n.splice(t),t};class Ns{constructor(e,t,i){this.type=e,this.template=t,this.values=i}}const Td=n=>{const e=new dh,t=i=>(r,...s)=>Us(i,{type:n,template:r,values:s});return Object.assign((i,...r)=>new Ns(n,i,r),{for(i,r){const s=e.get(i)||e.set(i,new sx);return s.get(r)||s.set(r,t(Sr()))},node:(i,...r)=>Us(Sr(),new Ns(n,i,r)).valueOf()})},yc=new dh,ph=(n,e)=>{const t=typeof e=="function"?e():e,i=yc.get(n)||yc.set(n,Sr()),r=t instanceof Ns?Us(i,t):t;return r!==i.wire&&(i.wire=r,n.replaceChildren(r.valueOf())),n},yi=Td("html"),tl=Td("svg");function bn(n,e){var h;const t=n.trim().split(`
`).map(c=>c.trim()),i=t.map(c=>c.length);i.every(c=>c===i[0])||console.error("Level must be rect.");const s=t[0].length||1,o=t.length||1,l=new Uint8ClampedArray(s*o*4),a=Object.fromEntries(e);for(let c=0;c<s*o;c++){const f=n.split("").filter(x=>x.match(/\S/))[c];f in a||console.error("unknown color:",f);const[u,d,p,g]=(h=a[f])!=null?h:a["."];l[c*4]=u,l[c*4+1]=d,l[c*4+2]=p,l[c*4+3]=g}return new ImageData(l,s,o)}const wc=n=>`http://${window.location.host}/?file=http://${window.location.host}/games/${n}.js`,oi={codemirror:void 0,errorInfo:null,logs:[],editor:null,editRange:null,samples:[{name:"test",link:wc("test")},{name:"maze",link:wc("maze")}],bitmaps:{},savedGames:[],palette:[["0",[0,0,0,255]],["1",[255/2,255/2,255/2,255]],["2",[255,255,255,255]],["3",[255,0,0,255]],["4",[0,255,0,255]],["5",[0,0,255,255]],["6",[255,255,0,255]],["7",[0,255,255,255]],["8",[255,0,255,255]],[".",[0,0,0,0]]]},il=n=>{let[e,t,i,r=255]=n.match(/\w\w/g).map(s=>parseInt(s,16));return[e,t,i,r]};function Li([n,e,t,i]){return n=n.toString(16),e=e.toString(16),t=t.toString(16),i=i.toString(16),n.length==1&&(n="0"+n),e.length==1&&(e="0"+e),t.length==1&&(t="0"+t),i.length==1&&(i="0"+i),"#"+n+e+t+i}function Xx(n){const e={canvas:null,gridColors:[],tempGridColors:[],viewboxSize:[16,16],canvasSize:[1,1],maxCanvasSize:350,selected:[],tool:"brush",color:[0,0,0,255],mousedown:!1,mousedownPt:[0,0],currentPt:[0,0],showGrid:!1,gridSize:[16,16],undoRedoStack:[],animationId:null,selectHandle:{clicked:!1,dragged:!1},palette:oi.palette};function t(O,k=[]){let T=O[0],z=T.name.split(".");z[0];const W=z[z.length-1];if(k.length>0&&k.includes(W))throw"Extension not recongized: "+z;i(T)}function i(O){var k=new FileReader;k.readAsText(O),k.onloadend=T=>{k.result,o(O),c()}}function r(){const O=n.querySelector(".pixel-editor-container");O.addEventListener("drop",k=>{let z=k.dataTransfer.files;t(z),k.stopPropagation&&k.stopPropagation(),k.preventDefault&&k.preventDefault(),k.cancelBubble=!0,k.returnValue=!1}),O.addEventListener("dragover",k=>{k.stopPropagation&&k.stopPropagation(),k.preventDefault&&k.preventDefault(),k.cancelBubble=!0,k.returnValue=!1})}function s(){var D;const O=n.querySelector("#offscreen-canvas");w(O);const T=O.getContext("2d").getImageData(0,0,O.width,O.height),z=Object.fromEntries(e.palette.map(U=>[U[1].join(","),U[0]]));let W="";for(let U=0;U<T.width*T.height;U+=1){const X=T.data[U*4],_=T.data[U*4+1],q=T.data[U*4+2],I=T.data[U*4+3],V=`${X},${_},${q},${I}`,oe=(D=z[V])!=null?D:".";U%T.width===0&&U!==0&&(W+=`
`),W+=oe}W=`
`+W.trim(),ge("SET_EDITOR_TEXT",{text:W,range:oi.editRange})}const o=O=>{let k=new FileReader;k.onload=T=>{const z=T.target.result,W=n.querySelector("#offscreen-canvas"),D=W.getContext("2d");D.clearRect(0,0,W.width,W.height);const U=new Image;U.onload=()=>{const X=Math.min(U.width,e.gridSize[0]),_=Math.min(U.height,e.gridSize[1]);D.drawImage(U,0,0,X,_);const q=D.getImageData(0,0,e.gridSize[0],e.gridSize[1]);for(let I=0;I<e.gridColors.length;I++)e.gridColors[I]=[q.data[I*4],q.data[I*4+1],q.data[I*4+2],q.data[I*4+3]]},U.src=z},k.readAsDataURL(O),s()},l=([O,k],T)=>yi`
    <button
      class=${[T.tool===O?"active":""].join(" ")}
      @click=${()=>{T.tool=O,c()}}
      title=${O}
    >
      <ion-icon name=${k} />
      <div>${O}</div>
    </button>
  `,a=O=>yi`
    <link rel="stylesheet" href="./pixel-editor/pixel-styles.css">
    <div class="pixel-editor-container">
      <div class="canvas-container">
        <canvas class="drawing-canvas"></canvas>
        <canvas
          class="offscreen-canvas"
          id="offscreen-canvas"
          width=${O.viewboxSize[0]}
          height=${O.viewboxSize[1]}
        ></canvas>
      </div>
      <div class="toolbox">
        <div class="tools">
          ${[["brush","brush"],["line","arrow-forward"],["circle","ellipse"],["box","square"],["bucket","color-fill"],["move","move"]].map(k=>l(k,O))}
          <!-- <button
            @click=$() => {
              if (state.undoRedoStack.length === 0) return;
              const grid = JSON.parse(state.undoRedoStack.pop());
              state.gridColors.forEach((arr, i) => {
                state.gridColors[i] = grid[i];
              });
              stateUpdate();
            }}
            title="undo"
          >
            undo
          </button>
          <button
            title="export"
            @click=$() => {
              const canvas = target.querySelector("#offscreen-canvas");
              drawCanvasNoBg(canvas);
              const image = canvas.toDataURL();
              const aDownloadLink = document.createElement("a");
              aDownloadLink.download = "sprite.png";
              aDownloadLink.href = image;
              aDownloadLink.click();
            }}
          >
            export
          </button> -->
        </div>

        ${h(O)}
      </div>
    </div>
  `,h=O=>{const k=T=>yi`
      <div 
        class=${Li(O.color)===Li(T[1])?"active":""}
        style=${`background-color: ${Li(T[1])}`}
        @click=${()=>{O.color=T[1],c()}}>
      </div>
    `;return yi`
      <div class="colors">${O.palette.map(k)}</div>
    `},c=()=>{ph(n,a(e))},f=O=>{const k=O.width,T=O.height,z=O.getContext("2d");return[k,T,z]};function u(O,k){const T=[];if(Math.abs(O[0]-k[0])>Math.abs(O[1]-k[1])){O[0]>k[0]&&([O,k]=[k,O]);let z=(k[1]-O[1])/(k[0]-O[0]);for(let[W,D]=O;W<=k[0];W++)T.push([W,Math.round(D)]),D+=z}else{O[1]>k[1]&&([O,k]=[k,O]);let z=(k[0]-O[0])/(k[1]-O[1]);for(let[W,D]=O;D<=k[1];D++)T.push([Math.round(W),D]),W+=z}return T}const d={brush:(O,k)=>{const[T,z]=e.gridSize;e.gridColors[T*k+O]=e.color},bucket:(O,k)=>{const[T,z]=e.gridSize,W=Li(e.gridColors[T*k+O]),D=Li(e.color),U=e.gridColors,X=(q,I)=>q>=0&&I>=0&&q<T&&I<z&&Li(U[T*I+q])===W&&W!==D,_=[];for(_.push([O,k]);_.length>0;){const[q,I]=_.pop();U[T*I+q]=e.color,X(q+1,I)&&_.push([q+1,I]),X(q-1,I)&&_.push([q-1,I]),X(q,I+1)&&_.push([q,I+1]),X(q,I-1)&&_.push([q,I-1])}},move:(O,k)=>{const[T,z]=e.gridSize,W=e.gridColors,D=(I,V)=>I<0||V<0||I>T-1||V>z-1?!1:Li(W[T*V+I])!=="#00000000"&&!U.includes(V*T+I),U=[],X=[],_=(I,V)=>{X.push([I,V]),U.push(V*T+I)};for(D(O,k)&&_(O,k);X.length>0;){const[I,V]=X.pop();D(I+1,V)&&_(I+1,V),D(I+1,V+1)&&_(I+1,V+1),D(I-1,V)&&_(I-1,V),D(I-1,V-1)&&_(I-1,V-1),D(I,V+1)&&_(I,V+1),D(I-1,V+1)&&_(I-1,V+1),D(I,V-1)&&_(I,V-1),D(I+1,V-1)&&_(I+1,V-1)}const q=new Set([...e.selected,...U]);e.selected=U.length>0?[...q]:[],e.selected.length>0&&(e.selectHandle.clicked=!0)}},p={brush:(O,k)=>{if(!e.mousedown)return;const[T,z]=e.gridSize;u(e.currentPt,e.mousedownPt).forEach(([D,U])=>{e.tempGridColors[T*U+D]=e.color}),e.mousedownPt=e.currentPt},box:(O,k)=>{if(e.tempGridColors=e.tempGridColors.fill(null),!e.mousedown)return;const[T,z]=e.gridSize,W=Math.min(e.currentPt[0],e.mousedownPt[0]),D=Math.max(e.currentPt[0],e.mousedownPt[0]),U=Math.min(e.currentPt[1],e.mousedownPt[1]),X=Math.max(e.currentPt[1],e.mousedownPt[1]);for(let _=W;_<=D;_++)for(let q=U;q<=X;q++)e.tempGridColors[T*q+_]=e.color},line:(O,k)=>{if(e.tempGridColors=e.tempGridColors.fill(null),!e.mousedown)return;const[T,z]=e.gridSize;u(e.currentPt,e.mousedownPt).forEach(([D,U])=>{e.tempGridColors[T*U+D]=e.color})},circle:(O,k)=>{if(e.tempGridColors=e.tempGridColors.fill(null),!e.mousedown)return;const[T,z]=e.gridSize,W=Math.min(e.currentPt[0],e.mousedownPt[0]),D=Math.max(e.currentPt[0],e.mousedownPt[0]),U=Math.min(e.currentPt[1],e.mousedownPt[1]),X=Math.max(e.currentPt[1],e.mousedownPt[1]),_=(D-W)/2,q=(X-U)/2,I=[W+_,U+q],V=(oe,ue)=>Math.pow(oe-I[0],2)/Math.pow(_,2)+Math.pow(ue-I[1],2)/Math.pow(q,2)<1;for(let oe=W;oe<=D;oe++)for(let ue=U;ue<=X;ue++)V(oe,ue)&&(e.tempGridColors[T*ue+oe]=e.color)}},g=O=>{const k=O%e.gridSize[0],T=Math.floor(O/e.gridSize[1]);return[k,T]},x=il("#b4e2fc87"),Q=il("#e3e3e34a"),m=document.createElement("canvas"),b=m.getContext("2d"),y=(O,k=!0)=>{const T=O.getContext("2d");T.fillStyle="white",T.fillRect(0,0,O.width,O.height);const z=e.tempGridColors.map((I,V)=>I===null?e.gridColors[V]:I),[W,D]=f(O),[U,X]=k?e.viewboxSize:e.gridSize,_=new Uint8ClampedArray(e.gridSize[0]*e.gridSize[1]*4);z.forEach((I,V)=>{if(I[3]===0){const[ue,A]=g(V);I=ue%2===0&&A%2===1||ue%2===1&&A%2===0?x:Q}let oe=V*4;_[oe]=I[0],_[oe+1]=I[1],_[oe+2]=I[2],_[oe+3]=I[3]}),m.width=U,m.height=X,T.webkitImageSmoothingEnabled=!1,T.mozImageSmoothingEnabled=!1,T.imageSmoothingEnabled=!1;const q=new ImageData(_,e.gridSize[0],e.gridSize[1]);b.putImageData(q,0,0),e.selected.forEach(I=>{const[V,oe]=g(I);b.fillStyle="#aaaaaaaa",b.fillRect(V,oe,1,1)}),T.drawImage(m,0,0,W,D)},w=(O,k=!0)=>{const T=O.getContext("2d");T.fillStyle="white",T.fillRect(0,0,O.width,O.height),f(O),k?e.viewboxSize:e.gridSize;const z=new Uint8ClampedArray(e.gridSize[0]*e.gridSize[1]*4).fill(0);e.gridColors.forEach((D,U)=>{let X=U*4;z[X]=D[0],z[X+1]=D[1],z[X+2]=D[2],z[X+3]=D[3]}),T.webkitImageSmoothingEnabled=!1,T.mozImageSmoothingEnabled=!1,T.imageSmoothingEnabled=!1;const W=new ImageData(z,e.gridSize[0],e.gridSize[1]);T.putImageData(W,0,0)},v=O=>{e.viewboxSize[0]<e.viewboxSize[1]?(e.canvasSize[0]=e.viewboxSize[0]/e.viewboxSize[1]*e.maxCanvasSize,e.canvasSize[1]=e.maxCanvasSize):(e.canvasSize[0]=e.maxCanvasSize,e.canvasSize[1]=e.viewboxSize[1]/e.viewboxSize[0]*e.maxCanvasSize),O.width=e.canvasSize[0],O.height=e.canvasSize[1]},R=(O,k,T)=>Math.min(Math.max(O,k),T);function N(O){const k=n.querySelector(".drawing-canvas"),T=k.getBoundingClientRect(),z=O.clientX-T.left,W=O.clientY-T.top,[D,U,X]=f(k),[_,q]=e.viewboxSize,I=D/_,V=U/q;let oe=Math.floor(z/I),ue=Math.floor(W/V);return oe=R(oe,0,e.gridSize[0]-1),ue=R(ue,0,e.gridSize[1]-1),[oe,ue]}const M=O=>{c();const k=n.querySelector(".drawing-canvas");O.canvas=k,v(k),O.viewboxSize,O.gridColors=new Array(O.gridSize[0]*O.gridSize[1]).fill(il("#00000000")),O.tempGridColors=new Array(O.gridSize[0]*O.gridSize[1]).fill(null),C(),r(),k.addEventListener("mousedown",z=>{O.undoRedoStack.push(JSON.stringify(O.gridColors)),O.undoRedoStack.length>15&&O.undoRedoStack.unshift(),O.mousedown=!0;const W=N(z);O.mousedownPt=W,O.tool in d&&d[O.tool](...W)}),k.addEventListener("mousemove",z=>{const W=N(z);O.currentPt=W,O.tool in p&&p[O.tool](...W),O.selectHandle.clicked&&(O.tempGridColors.fill(null),O.selected.forEach(D=>{const[U,X]=g(D),_=W[0]-O.mousedownPt[0],q=W[1]-O.mousedownPt[1],I=U+_,V=X+q;if(I<0||I>=O.gridSize[0]||V<0||V>=O.gridSize[1])return;const oe=O.gridSize[0]*V+I,ue=O.gridColors[D];O.tempGridColors[oe]=ue}),O.selectHandle.dragged=!0)});const T=z=>{O.mousedown=!1,O.mousedownPt=[0,0],O.currentPt=[0,0],O.selectHandle.dragged&&(O.selected.forEach(W=>{O.gridColors[W]=[0,0,0,0]}),O.selected=[]),O.selectHandle.clicked=!1,O.selectHandle.dragged=!1,O.tempGridColors.forEach((W,D)=>{W!==null&&(O.gridColors[D]=W)}),O.tempGridColors.fill(null),s()};k.addEventListener("mouseup",z=>{T()}),k.addEventListener("mouseleave",z=>{T()})},C=()=>{y(e.canvas),e.animationId=window.requestAnimationFrame(C)};return M(e),{loadInitValue({text:O}){console.log(O,e.palette);const k=bn(O,e.palette);for(let T=0;T<e.gridColors.length;T++)e.gridColors[T]=[k.data[T*4],k.data[T*4+1],k.data[T*4+2],k.data[T*4+3]]},setGridColors:({colors:O,size:k})=>{e.gridColors=O,e.gridSize=k,e.viewboxSize=k},createEmptyGrid:()=>({size:e.gridSize,colors:new Array(e.gridSize[0]*e.gridSize[1]).fill([0,0,0,0])}),gridColors:()=>e.gridColors,end(){e.animationId&&window.cancelAnimationFrame(e.animationId)}}}class Zx extends HTMLElement{constructor(){super()}connectedCallback(){const e=this.attachShadow({mode:"open"}),t=Xx(e);for(const i in t)this[i]=t[i]}disconnectedCallback(){this.end()}}customElements.define("pixel-editor",Zx);let Qs={c:16.35,"c#":17.32,d:18.35,"d#":19.45,e:20.6,f:21.83,"f#":23.12,g:24.5,"g#":25.96,a:27.5,"a#":29.14,b:30.87};for(let n=1;n<10;n++)for(const e in Qs)Qs[`${e}${n}`]=Qs[e]*2**n;const jx=window.AudioContext||window.webkitAudioContext,di=new jx;function Gx(n,e,t){var i=di.createOscillator(),r=di.createGain();i.frequency.value=n,i.type=t!=null?t:"sine",i.connect(r),r.connect(di.destination),i.start();const s=di.currentTime+e*2/1e3;i.stop(s),r.gain.setValueAtTime(0,di.currentTime),r.gain.linearRampToValueAtTime(.2,di.currentTime+e/5/1e3),r.gain.exponentialRampToValueAtTime(1e-5,di.currentTime+e/1e3),r.gain.linearRampToValueAtTime(0,di.currentTime+e*2/1e3),i.onended=()=>{r.disconnect()}}function Nl(n,e,t){let i=Qs[n];Gx(i,e,t)}const qx={B0:31,C1:33,"C#1":35,D1:37,"D#1":39,E1:41,F1:44,"F#1":46,G1:49,"G#1":52,A1:55,"A#1":58,B1:62,C2:65,"C#2":69,D2:73,"D#2":78,E2:82,F2:87,"F#2":93,G2:98,"G#2":104,A2:110,"A#2":117,B2:123,C3:131,"C#3":139,D3:147,"D#3":156,E3:165,F3:175,"F#3":185,G3:196,"G#3":208,A3:220,"A#3":233,B3:247,C4:262,"C#4":277,D4:294,"D#4":311,E4:330,F4:349,"F#4":370,G4:392,"G#4":415,A4:440,"A#4":466,B4:494,C5:523,"C#5":554,D5:587,"D#5":622,E5:659,F5:698,"F#5":740,G5:784,"G#5":831,A5:880,"A#5":932,B5:988,C6:1047,"C#6":1109,D6:1175,"D#6":1245,E6:1319,F6:1397,"F#6":1480,G6:1568,"G#6":1661,A6:1760,"A#6":1865,B6:1976,C7:2093,"C#7":2217,D7:2349,"D#7":2489,E7:2637,F7:2794,"F#7":2960,G7:3136,"G#7":3322,A7:3520,"A#7":3729,B7:3951,C8:4186,"C#8":4435,D8:4699,"D#8":4978},Pd={"~":"sine","-":"square","^":"triangle","/":"sawtooth"},Fx=Object.fromEntries(Object.entries(Pd).map(([n,e])=>[e,n]));function Ad(n){const e=n.replace(/\s/g,"").split(","),t=[];for(const i of e){if(!i)continue;const[r,s]=i.split(":"),o=Math.round(parseInt(r)),l=(s||"").split("+").map(a=>{if(!a)return[];const[,h,c,f]=a.match(/^(.+)([~\-^\/])(.+)$/);return[Pd[c],isNaN(parseInt(h,10))?h:parseInt(h,10),parseInt(f,10)]});t.push([o,...l].flat())}return t}function Vx(n){const e=r=>{const s=[];for(let o=0;o<r.length;o++)o%3===0?s.push([r[o]]):s[s.length-1].push(r[o]);return s},t=([r,...s])=>s.length===0?r:`${r}: ${e(s).map(i).join(" + ")}`,i=([r,s,o])=>`${s}${Fx[r]}${o}`;return n.map(t).join(`,
`)}const Sc={sine:"red",square:"blue",sawtooth:"orange",triangle:"green"},yn={13:"c4",12:"d4",11:"e4",10:"f4",9:"g4",8:"a4",7:"b4",6:"c5",5:"d5",4:"e5",3:"f5",2:"g5",1:"a5",0:"b5"};function Yx(n,e,t){const i=[];Object.entries(n).forEach(([r,s])=>{const[o,l]=r.split("_").map(Number);o===t&&i.push([l,s])}),i.forEach(([r,s])=>{const o=yn[r],l=1e3*60/e;Nl(o,l,s)})}function Hx(n,e,t){const i=[],r=6e4/e,s=o=>Object.entries(n).filter(([l])=>l.split("_")[0]===o.toString()).map(([l,a])=>[Number(l.split("_")[1]),a]);for(let o=0;o<t;o++){let l=0;for(;s(o).length===0&&o<t;)l++,o++;if(l&&i.push([l*r]),o>=t)break;const a=s(o);i.push([r,...a.map(([h,c])=>[c,yn[h],r])].flat())}return i}function Jx(n){const e=n.filter(s=>s.length>1);if(!e.length)return{};const t=e[0][0],i={};let r=0;for(const[s,...o]of n){for(let l=0;l<o.length;l+=3){const[a,h]=o.slice(l,l+2),c=typeof h=="string"?h.toLowerCase():Object.entries(qx).find(([,u])=>u===h)[0].toLowerCase(),f=Object.entries(yn).find(([,u])=>u===c)[0];i[`${r}_${f}`]=a}o.length?r++:r+=s/t}return i}function Kx(n,e){const t=new Blob([e],{type:"text/plain"});var i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=`${n}`,i.click(),URL.revokeObjectURL(i)}function e1(n,e,t,i){const r=[];for(let s=0;s<t;s++)r.push([]);for(const s in n){const[o,l]=s.split("_").map(Number);r[o].push([i[l],1e3*60/e,n[s]])}return r}function t1(n,e){const t=[];if(Math.abs(n[0]-e[0])>Math.abs(n[1]-e[1])){n[0]>e[0]&&([n,e]=[e,n]);let i=(e[1]-n[1])/(e[0]-n[0]);for(let[r,s]=n;r<=e[0];r++)t.push([r,Math.round(s)]),s+=i}else{n[1]>e[1]&&([n,e]=[e,n]);let i=(e[0]-n[0])/(e[1]-n[1]);for(let[r,s]=n;s<=e[1];s++)t.push([Math.round(r),s]),r+=i}return t}function i1(n){const e={numberX:32,numberY:14,svg:null,instrument:"sine",cells:{},beat:0,bpm:120,interval:null,lastPt:[0,0],drawing:!1,erasing:!1,data:{}};function t(m,b=[]){let y=m[0],w=y.name.split(".");if(w[0],w[w.length-1],b.length>0&&b.includes(enxtension))throw"Extension not recognized: "+w;i(y)}function i(m){var b=new FileReader;b.readAsText(m),b.onloadend=y=>{let w=b.result;const v=JSON.parse(w),{song:R,cells:N,bpm:M}=v;for(const C in e.cells)delete e.cells[C];for(const C in N)e.cells[C]=N[C];e.bpm=M,e.data.cells=e.cells,e.data.bpm=e.bpm,e.data.song=R,g()}}function r(){const m=n.querySelector(".container");m.addEventListener("drop",b=>{let w=b.dataTransfer.files;t(w),b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),b.cancelBubble=!0,b.returnValue=!1}),m.addEventListener("dragover",b=>{b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),b.cancelBubble=!0,b.returnValue=!1})}const s=m=>{const b=(y,w,v)=>`${y} ${v===0?"M":"L"} ${w.join(",")}`;return m.reduce(b,"")},o=(m,b,y)=>{const{left:w,right:v,bottom:R,top:N,width:M,height:C}=y.getBoundingClientRect(),O=[];let k=M/m,T=C/b,z=0;for(;(z+1)*k<M;)O.push([[(z+1)*k,0],[(z+1)*k,C]]),z++;let W=0;for(;(W+1)*T<C;)O.push([[0,(W+1)*T],[M,(W+1)*T]]),W++;return O.map(D=>tl`
      <path 
        stroke="black"
        vector-effect="non-scaling-stroke" 
        stroke-width="1" d="${s(D)}"/>
    `)},l=m=>{const{left:b,right:y,bottom:w,top:v,width:R,height:N}=m.svg.getBoundingClientRect(),M=R/m.numberX;return N/m.numberY,tl`
      <rect 
        fill=#72cacb33
        x=${m.beat*M} 
        y=${0} 
        width=${M} 
        height=${N}/>
    `},a=({cells:m,svg:b,numberX:y,numberY:w})=>{const{left:v,right:R,bottom:N,top:M,width:C,height:O}=b.getBoundingClientRect(),k=C/y,T=O/w,z=([D,U,X])=>tl`
        <rect 
          fill=${X}
          x=${D*k} 
          y=${U*T} 
          width=${k} 
          height=${T}/>
      `,W=[];for(const D in m){const[U,X]=D.split("_").map(Number),_=Sc[m[D]];W.push([U,X,_])}return W.map(z)},h=(m,b)=>{const y={sine:"~",triangle:"^",square:"-",sawtooth:"/"}[m];return yi`
      <div 
        class="instrument" 
        style=${`
          background: ${b};
          width:50px;
          height:50px;
          border: ${e.instrument===m?"2px solid black":"none"};
          box-sizing: border-box;
          `} 
        @click=${()=>{e.instrument=m,g()}}>
        ${y}
        </div>
    `},c=m=>yi`
    <link rel="stylesheet" href="./sequencer/sequencer.css">
    <div class="container" @mouseup=${p}>
      <svg 
        class="svg-container" 
        @mousedown=${u} 
        @mousemove=${d}>
        ${m.svg?a(m):""}
        ${m.svg?l(m):""}
        ${m.svg?o(m.numberX,m.numberY,m.svg):""}
      </svg>
      <div class="sequencer-toolbox">
        <div class="play-pause">
          <button @click=${()=>{m.interval?(clearInterval(m.interval),m.interval=null):m.interval=x()}}>play/pause</button>
          <button @click=${()=>{const b=e1(m.cells,m.bpm,m.numberX,yn);Kx("jam.json",JSON.stringify({song:b,cells:m.cells,bpm:m.bpm}))}}>export</button>
        </div>
        <div class="bpm">
          <div style="padding-right: 10px;">BPM:</div>
          <div 
            class="bpm-control" 
            style="padding-right: 5px;" 
            @click=${()=>{m.bpm=Math.max(m.bpm-1,1),m.data.bpm=m.bpm,m.interval&&(clearInterval(m.interval),m.interval=x()),g()}}>-</div>
          <input @input=${b=>{m.bpm=Number(b.target.value),m.data.bpm=m.bpm,m.interval&&(clearInterval(m.interval),m.interval=x()),g()}} type="range" min="1" max="2000" .value=${m.bpm}>
          </input>
          <span style="width: 30px;">${m.bpm}</span>
          <div 
            class="bpm-control" 
            style="padding-left: 5px;" 
            @click=${()=>{m.bpm=Math.min(m.bpm+1,2e3),m.data.bpm=m.bpm,m.interval&&(clearInterval(m.interval),m.interval=x()),g()}}>+</div>
        </div>
        <div class="instruments">
          ${Object.entries(Sc).map(b=>h(b[0],b[1]))}
        </div>
      </div>
    </div>
  `,f=m=>{const{left:b,right:y,bottom:w,top:v,width:R,height:N}=e.svg.getBoundingClientRect(),M=R/e.numberX,C=N/e.numberY,O=Math.floor(m.offsetX/M),k=Math.floor(m.offsetY/C);return[O,k]},u=m=>{let[b,y]=f(m);b=Math.max(Math.min(b,e.numberX-1),0),y=Math.max(Math.min(y,e.numberY-1),0);const w=`${b}_${y}`;if(w in e.cells&&e.cells[w]===e.instrument)delete e.cells[w],e.erasing=!0;else{e.cells[w]=e.instrument;const v=yn[y],R=1e3*60/e.bpm;Nl(v,R,e.instrument),e.drawing=!0}e.lastPt=[b,y],g()},d=m=>{const b=f(m);(e.drawing||e.erasing)&&t1(e.lastPt,b).forEach(([w,v])=>{const R=`${w}_${v}`;if(e.erasing)delete e.cells[R];else{if(e.cells[R]!==e.instrument){const N=yn[v],M=1e3*60/e.bpm;Nl(N,M,e.instrument)}e.cells[R]=e.instrument}}),e.lastPt=b,g()},p=m=>{e.erasing=!1,e.drawing=!1;let b=Vx(Hx(e.cells,e.bpm,e.numberX));b=`
`+b.trim(),ge("SET_EDITOR_TEXT",{text:b,range:oi.editRange}),g()},g=()=>{ph(n,c(e))},x=()=>setInterval(()=>{e.beat=(e.beat+1)%e.numberX,Yx(e.cells,e.bpm,e.beat),g()},1e3*60/e.bpm);return(m=>{g(),m.svg=n.querySelector("svg"),n.querySelector("link").addEventListener("load",g,{once:!0}),r()})(e),{loadInitValue({text:m}){e.cells=Jx(Ad(m));let b=m.match(/(.+):/);b?b=60*1e3/Number(b[1]):b=120,e.bpm=Math.round(b),g()},end(){e.interval&&clearInterval(e.interval)},setTune(m){const{cells:b,bpm:y}=m;e.cells=b,e.bpm=y,e.data=m,g()},getTune(){return{cells:e.cells,bpm:e.bpm}}}}class n1 extends HTMLElement{constructor(){super()}connectedCallback(){const e=this.attachShadow({mode:"open"}),t=i1(e);for(let i in t)this[i]=t[i]}disconnectedCallback(){this.end()}}customElements.define("sequencer-editor",n1);const an=16;function r1(n){const e={canvas:null,width:10,height:6,activeBitmap:"",mouseDown:0,updateTextDebounce:null,cells:[[]],legend:{},palette:oi.palette},t=[],i=c=>yi`
    <link rel="stylesheet" href="./map-editor/map-styles.css">
    <div class="map-editor-container">
      <div class="canvas-container">
        <canvas></canvas>
      </div>
      <div class="sprites">
        ${Object.entries(c.legend).map(([f,u])=>yi`<button
            class=${c.activeBitmap===f?"active":""}
            @click=${()=>{c.activeBitmap=f,r()}}
          >
            <bitmap-preview text="${u.text}" />
          </button>
        `)}<button
          class=${c.activeBitmap==="."?"active":""}
          @click=${()=>{c.activeBitmap=".",r()}}
        />
      </div>
    </div>
  `,r=()=>{ph(n,i(e))},s=()=>{if(e.canvas.width=e.width*an,e.canvas.height=e.height*an,e.cells.length<e.height)for(;e.cells.length<e.height;)e.cells.push([]);else e.cells.length>e.height&&(e.cells=e.cells.slice(0,e.height));for(let c=0;c<e.height;c++)e.cells[c].length<e.width?e.cells[c]=e.cells[c].concat(new Array(e.width-e.cells[c].length).fill(".")):e.cells[c].length>e.width&&(e.cells[c]=e.cells[c].slice(0,e.width))},o=()=>{let c="";for(let f=0;f<e.height;f++){for(let u=0;u<e.width;u++)c+=e.cells[f]&&e.cells[f][u]||".";c+=`
`}c=`
`+c.trim(),ge("SET_EDITOR_TEXT",{text:c,range:oi.editRange})},l=()=>{const c=e.canvas.getContext("2d");c.clearRect(0,0,e.canvas.width,e.canvas.height);for(let f=0;f<e.height;f++)for(let u=0;u<e.width;u++){if(!e.cells[f])continue;const d=e.legend[e.cells[f][u]];!d||c.putImageData(d.imageData,u*an,f*an,0,0,an,an)}},a=c=>{const[f,u]=[c.pageX-e.canvas.offsetLeft,c.pageY-e.canvas.offsetTop],[d,p]=[e.canvas.offsetWidth/e.width,e.canvas.offsetHeight/e.height],[g,x]=[Math.floor(f/d),Math.floor(u/p)];e.mouseDown>0&&(e.legend[e.activeBitmap]||e.activeBitmap===".")&&g<e.width&&x<e.height&&g>=0&&x>=0&&(e.cells[x]&&e.cells[x][g])!==e.activeBitmap&&(e.cells[x][g]=e.activeBitmap,l(),clearTimeout(e.updateTextDebounce),e.updateTextDebounce=setTimeout(o,100))};return(()=>{r(),e.canvas=n.querySelector(".canvas-container > canvas");const c=u=>{e.mouseDown++,a(u)};document.addEventListener("mousedown",c),t.push(()=>document.removeEventListener("mousedown",c));const f=u=>{e.mouseDown=Math.max(0,e.mouseDown-1)};document.addEventListener("mouseup",f),t.push(()=>document.removeEventListener("mouseup",f)),e.canvas.addEventListener("mousemove",a),s(),l()})(),{loadInitValue({text:c,bitmaps:f}){const u={};for(let d in f){const p=f[d];if(p.type!=="or")if(p.type==="and"){let g=[];p.list.forEach(Q=>{const m=f[Q].text.replace(/ +?/g,"");g.length===0?g=m.split(""):m.split("").forEach((b,y)=>{b!=="."&&(g[y]=b)})});const x=g.join("");u[d]={text:x,imageData:bn(x,e.palette)}}else u[d]={...p,imageData:bn(p.text,e.palette)}}e.legend=u,Object.fromEntries(Object.entries(f).filter(([,d])=>!!d.text).map(([d,p])=>[d,{...p,imageData:bn(p.text,e.palette)}])),c&&(e.cells=c.trim().split(`
`).map(d=>[...d.trim()]),e.width=e.cells[0].length,e.height=e.cells.length),s(),l(),r()},end(){t.forEach(c=>c())}}}class s1 extends HTMLElement{constructor(){super()}connectedCallback(){const e=this.attachShadow({mode:"open"}),t=r1(e);for(const i in t)this[i]=t[i]}disconnectedCallback(){this.end()}}customElements.define("map-editor",s1);const o1=oi.palette;class l1 extends HTMLElement{constructor(){super()}connectedCallback(){const e=this.attachShadow({mode:"open"});this.canvas=e.appendChild(document.createElement("canvas")),this.canvas.style.display="block",this.canvas.style.width="100%",this.canvas.style.imageRendering="pixelated",this.attributeChangedCallback()}attributeChangedCallback(){var t;if(!this.canvas)return;const e=bn((t=this.getAttribute("text"))!=null?t:"",o1);this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext("2d").clearRect(0,0,e.width,e.height),this.canvas.getContext("2d").putImageData(e,0,0),this.staleCanvas=!1}static get observedAttributes(){return["text"]}}customElements.define("bitmap-preview",l1);const a1=n=>Kt`
  ${c1(n)}

  <div class="main-container">
    <div class="code-container">
      <div id="code-editor"></div>
      <div class=${["logs",n.errorInfo?"erred":""].join(" ")}>
        ${n.logs.map(e=>Kt`${e}<br>`)}
      </div>
    </div>
    
    <div class="game-docs-container">
      <div class="game-canvas-container">
        <canvas class="game-canvas"></canvas>
      </div>
      <div class="docs">
        ${rx(n)}
      </div>
    </div>

    <div class="vertical-bar"></div>
  </div>

  <div class=${["asset-editor-container",n.editor?"":"hide"].join(" ")}  @click=${e=>{for(const t of e.composedPath())if(t.classList&&t.classList.contains("asset-editor-content"))return;ge("SET_ASSET_EDITOR",{type:null,text:null})}}>
    <button class="close"><ion-icon icon="close" /></button>
    <div class="asset-editor-content">
      ${{bitmap:Kt`<pixel-editor id="asset-editor"></pixel-editor>`,sequencer:Kt`<sequencer-editor id="asset-editor"></sequencer-editor>`,map:Kt`<map-editor id="asset-editor"></map-editor>`,[void 0]:""}[n.editor]}
    </div>
  </div>
`,h1=(n,e,t)=>{const[i,r]=n;return Kt`
    <div @click=${()=>{ah(t);const l=Object.fromEntries(t.savedGames)[i],a=t.codemirror.state.doc.toString();ge("SET_EDITOR_TEXT",{text:l,range:[0,a.length]})}}>${i}</div>
  `},c1=n=>Kt`
  <div class="menu">
    <div class="menu-item dropdown-container">
      files
      <div class="dropdown-list">
        ${n.savedGames.map((e,t)=>h1(e,t,n))}
      </div>
    </div>
    <div class="menu-item dropdown-container">
      export
      <div class="dropdown-list">
        <div @click=${e=>ge("SAVE_TO_FILE")}>js</div>
        <div>TODO: link</div>
        <div>TODO: html</div>
      </div>
    </div>
    <div class="menu-item dropdown-container">
      samples
      <div class="dropdown-list">
        ${n.samples.map(f1)}
      </div>
    </div>
    <div 
      class="menu-item" 
      @click=${()=>ge("UPLOAD")}>
      upload
    </div>
    <div 
      class="menu-item docs-trigger">
      docs
    </div>
    <div 
      class="menu-item run" 
      @click=${()=>ge("RUN")}>
      <ion-icon name="play" style="margin-right: 6px;" />
      run
    </div>

    <div class="spacer" aria-hidden="true" />

    <a class="menu-item" href="https://github.com/hackclub/gamelab/">
      <ion-icon name="logo-github" />
    </a>
  </div>
`,f1=({name:n,link:e})=>Kt`
    <a href=${e}>
      ${n}
    </a>
  `;class je{emit(e){this._events=this._events||{};var t,i,r,s,o;if(t=Array.prototype.slice.call(arguments,1),o=this._events[e],o){for(o=o.slice(),i=0,r=o.length;i<r;++i)s=o[i],s.apply(this,t);return!0}return!1}eventNames(){return Object.keys(this._events=this._events||{})}getMaxListeners(){return typeof this._maxListeners=="number"?this._maxListeners:je.defaultMaxListeners}hasListeners(e){return this._events=this._events||{},(this._events[e]||[]).length>0}listenerCount(e){return this._events=this._events||{},(this._events[e]||[]).length}listeners(e){return this._events=this._events||{},Array.prototype.slice.call(this._events[e]||[])}off(e,t){var i=arguments.length;return i===0||i===1?this.removeAllListeners.apply(this,arguments):i===2?this.removeListener.apply(this,arguments):this}on(e,t){return je._.append(this,e,t),this}once(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,je._.append(this,e,i,t),this}prependListener(e,t){return je._.prepend(this,e,t),this}prependOnceListener(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,je._.prepend(this,e,i,t),this}removeListener(e,t){this._events=this._events||{};var i,r,s;if(r=this._events[e],!r)return this;for(s=0;s<r.length;++s)if(i=r[s],i===t||i.fn===t){r.splice(s,1),this.emit("removeListener",e,t);break}return r.length===0&&delete this._events[e],this}removeAllListeners(e){this._events=this._events||{};var t,i,r,s;if(arguments.length===0){for(e in this._events)if(e!="removeListener"){for(t=this._events[e],i=0,r=t.length;i<r;++i)s=t[i],this.emit("removeListener",e,s);delete this._events[e]}delete this._events.removeListener,this._events={}}else if(arguments.length===1){if(t=this._events[e],t)for(i=0,r=t.length;i<r;++i)s=t[i],this.emit("removeListener",e,s);delete this._events[e]}return this}setMaxListeners(e){if(typeof e!="number"||Number.isNaN(e)||e<0)throw new TypeError("n must be a positive number");return this._maxListeners=e,this}}je.defaultMaxListeners=10;je._={checkMaxListeners:function(n,e){var t=n._events[e].length;t>n.getMaxListeners()&&console.warn("possible EventEmitter memory leak detected. %d %s listeners added. Use emitter.setMaxListeners() to increase limit.",t,e)},append:function(n,e,t,i){n._events=n._events||{},n.emit("newListener",e,i||t),(n._events[e]=n._events[e]||[]).push(t),this.checkMaxListeners(n,e)},prepend:function(n,e,t,i){n._events=n._events||{},n.emit("newListener",e,i||t),(n._events[e]=n._events[e]||[]).splice(0,0,t),this.checkMaxListeners(n,e)}};je.prototype.trigger=je.prototype.emit;je.prototype.addListener=je.prototype.addEventListener=je.prototype.on;je.prototype.removeEventListener=je.prototype.removeListener;class u1 extends je{constructor(e){super(),this.serial=e,this.reader=null}async getInfo(){return this.serial.getInfo()}open(e){return new Promise((t,i)=>{this.serial.open(e).then(()=>{const r=()=>{const s=this.serial.readable.getReader();this.reader=s,s.read().then(({value:o,done:l})=>{s.releaseLock(),o&&this.emit("data",o),l||r()}).catch(o=>{console.log(o),this.emit("disconnect")})};r(),this.emit("connect"),t()}).catch(r=>{i(r)})})}close(){return new Promise((e,t)=>{this.reader?this.reader.cancel().then(()=>this.serial.close()).then(()=>e()).catch(i=>t(i)):(this.reader=null,this.serial.close().then(()=>e()).catch(i=>t(i)))})}write(e,t="string"){return new Promise((i,r)=>{const s=this.serial.writable.getWriter();if(t==="string"){const o=new TextEncoder;s.write(o.encode(e)).then(()=>i()).catch(l=>r(l))}else t==="binary"&&s.write(e).then(()=>i()).catch(o=>r(o));s.releaseLock()})}}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const Xl=(()=>{const n={};n.byteLength=a,n.toByteArray=c,n.fromByteArray=d;for(var e=[],t=[],i=typeof Uint8Array!="undefined"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=r.length;s<o;++s)e[s]=r[s],t[r.charCodeAt(s)]=s;t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;function l(p){var g=p.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=p.indexOf("=");x===-1&&(x=g);var Q=x===g?0:4-x%4;return[x,Q]}function a(p){var g=l(p),x=g[0],Q=g[1];return(x+Q)*3/4-Q}function h(p,g,x){return(g+x)*3/4-x}function c(p){var g,x=l(p),Q=x[0],m=x[1],b=new i(h(p,Q,m)),y=0,w=m>0?Q-4:Q,v;for(v=0;v<w;v+=4)g=t[p.charCodeAt(v)]<<18|t[p.charCodeAt(v+1)]<<12|t[p.charCodeAt(v+2)]<<6|t[p.charCodeAt(v+3)],b[y++]=g>>16&255,b[y++]=g>>8&255,b[y++]=g&255;return m===2&&(g=t[p.charCodeAt(v)]<<2|t[p.charCodeAt(v+1)]>>4,b[y++]=g&255),m===1&&(g=t[p.charCodeAt(v)]<<10|t[p.charCodeAt(v+1)]<<4|t[p.charCodeAt(v+2)]>>2,b[y++]=g>>8&255,b[y++]=g&255),b}function f(p){return e[p>>18&63]+e[p>>12&63]+e[p>>6&63]+e[p&63]}function u(p,g,x){for(var Q,m=[],b=g;b<x;b+=3)Q=(p[b]<<16&16711680)+(p[b+1]<<8&65280)+(p[b+2]&255),m.push(f(Q));return m.join("")}function d(p){for(var g,x=p.length,Q=x%3,m=[],b=16383,y=0,w=x-Q;y<w;y+=b)m.push(u(p,y,y+b>w?w:y+b));return Q===1?(g=p[x-1],m.push(e[g>>2]+e[g<<4&63]+"==")):Q===2&&(g=(p[x-2]<<8)+p[x-1],m.push(e[g>>10]+e[g>>4&63]+e[g<<2&63]+"=")),m.join("")}return n})(),Un={read:function(n,e,t,i,r){let s,o;const l=r*8-i-1,a=(1<<l)-1,h=a>>1;let c=-7,f=t?r-1:0;const u=t?-1:1;let d=n[e+f];for(f+=u,s=d&(1<<-c)-1,d>>=-c,c+=l;c>0;)s=s*256+n[e+f],f+=u,c-=8;for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;)o=o*256+n[e+f],f+=u,c-=8;if(s===0)s=1-h;else{if(s===a)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-h}return(d?-1:1)*o*Math.pow(2,s-i)},write:function(n,e,t,i,r,s){let o,l,a,h=s*8-r-1;const c=(1<<h)-1,f=c>>1,u=r===23?Math.pow(2,-24)-Math.pow(2,-77):0;let d=i?0:s-1;const p=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-o))<1&&(o--,a*=2),o+f>=1?e+=u/a:e+=u*Math.pow(2,1-f),e*a>=2&&(o++,a/=2),o+f>=c?(l=0,o=c):o+f>=1?(l=(e*a-1)*Math.pow(2,r),o=o+f):(l=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;)n[t+d]=l&255,d+=p,l/=256,r-=8;for(o=o<<r|l,h+=r;h>0;)n[t+d]=o&255,d+=p,o/=256,h-=8;n[t+d-p]|=g*128}},kc=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,d1=50,Zl=2147483647;$.TYPED_ARRAY_SUPPORT=p1();!$.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p1(){try{const n=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(n,e),n.foo()===42}catch{return!1}}Object.defineProperty($.prototype,"parent",{enumerable:!0,get:function(){if(!!$.isBuffer(this))return this.buffer}});Object.defineProperty($.prototype,"offset",{enumerable:!0,get:function(){if(!!$.isBuffer(this))return this.byteOffset}});function ei(n){if(n>Zl)throw new RangeError('The value "'+n+'" is invalid for option "size"');const e=new Uint8Array(n);return Object.setPrototypeOf(e,$.prototype),e}function $(n,e,t){if(typeof n=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return gh(n)}return Rd(n,e,t)}$.poolSize=8192;function Rd(n,e,t){if(typeof n=="string")return m1(n,e);if(ArrayBuffer.isView(n))return O1(n);if(n==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(Ut(n,ArrayBuffer)||n&&Ut(n.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ut(n,SharedArrayBuffer)||n&&Ut(n.buffer,SharedArrayBuffer)))return Gl(n,e,t);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=n.valueOf&&n.valueOf();if(i!=null&&i!==n)return $.from(i,e,t);const r=x1(n);if(r)return r;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return $.from(n[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}$.from=function(n,e,t){return Rd(n,e,t)};Object.setPrototypeOf($.prototype,Uint8Array.prototype);Object.setPrototypeOf($,Uint8Array);function Cd(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(n<0)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function g1(n,e,t){return Cd(n),n<=0?ei(n):e!==void 0?typeof t=="string"?ei(n).fill(e,t):ei(n).fill(e):ei(n)}$.alloc=function(n,e,t){return g1(n,e,t)};function gh(n){return Cd(n),ei(n<0?0:mh(n)|0)}$.allocUnsafe=function(n){return gh(n)};$.allocUnsafeSlow=function(n){return gh(n)};function m1(n,e){if((typeof e!="string"||e==="")&&(e="utf8"),!$.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=Id(n,e)|0;let i=ei(t);const r=i.write(n,e);return r!==t&&(i=i.slice(0,r)),i}function jl(n){const e=n.length<0?0:mh(n.length)|0,t=ei(e);for(let i=0;i<e;i+=1)t[i]=n[i]&255;return t}function O1(n){if(Ut(n,Uint8Array)){const e=new Uint8Array(n);return Gl(e.buffer,e.byteOffset,e.byteLength)}return jl(n)}function Gl(n,e,t){if(e<0||n.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(n):t===void 0?i=new Uint8Array(n,e):i=new Uint8Array(n,e,t),Object.setPrototypeOf(i,$.prototype),i}function x1(n){if($.isBuffer(n)){const e=mh(n.length)|0,t=ei(e);return t.length===0||n.copy(t,0,0,e),t}if(n.length!==void 0)return typeof n.length!="number"||xh(n.length)?ei(0):jl(n);if(n.type==="Buffer"&&Array.isArray(n.data))return jl(n.data)}function mh(n){if(n>=Zl)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Zl.toString(16)+" bytes");return n|0}$.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==$.prototype};$.compare=function(e,t){if(Ut(e,Uint8Array)&&(e=$.from(e,e.offset,e.byteLength)),Ut(t,Uint8Array)&&(t=$.from(t,t.offset,t.byteLength)),!$.isBuffer(e)||!$.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,r=t.length;for(let s=0,o=Math.min(i,r);s<o;++s)if(e[s]!==t[s]){i=e[s],r=t[s];break}return i<r?-1:r<i?1:0};$.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};$.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return $.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const r=$.allocUnsafe(t);let s=0;for(i=0;i<e.length;++i){let o=e[i];if(Ut(o,Uint8Array))s+o.length>r.length?($.isBuffer(o)||(o=$.from(o)),o.copy(r,s)):Uint8Array.prototype.set.call(r,o,s);else if($.isBuffer(o))o.copy(r,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return r};function Id(n,e){if($.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||Ut(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);const t=n.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let r=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return ql(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Ud(n).length;default:if(r)return i?-1:ql(n).length;e=(""+e).toLowerCase(),r=!0}}$.byteLength=Id;function b1(n,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(n||(n="utf8");;)switch(n){case"hex":return A1(this,e,t);case"utf8":case"utf-8":return Wd(this,e,t);case"ascii":return T1(this,e,t);case"latin1":case"binary":return P1(this,e,t);case"base64":return v1(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R1(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),i=!0}}$.prototype._isBuffer=!0;function Xi(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}$.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Xi(this,t,t+1);return this};$.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Xi(this,t,t+3),Xi(this,t+1,t+2);return this};$.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Xi(this,t,t+7),Xi(this,t+1,t+6),Xi(this,t+2,t+5),Xi(this,t+3,t+4);return this};$.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?Wd(this,0,e):b1.apply(this,arguments)};$.prototype.toLocaleString=$.prototype.toString;$.prototype.equals=function(e){if(!$.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:$.compare(this,e)===0};$.prototype.inspect=function(){let e="";const t=d1;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};kc&&($.prototype[kc]=$.prototype.inspect);$.prototype.compare=function(e,t,i,r,s){if(Ut(e,Uint8Array)&&(e=$.from(e,e.offset,e.byteLength)),!$.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),r===void 0&&(r=0),s===void 0&&(s=this.length),t<0||i>e.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&t>=i)return 0;if(r>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,s>>>=0,this===e)return 0;let o=s-r,l=i-t;const a=Math.min(o,l),h=this.slice(r,s),c=e.slice(t,i);for(let f=0;f<a;++f)if(h[f]!==c[f]){o=h[f],l=c[f];break}return o<l?-1:l<o?1:0};function Ed(n,e,t,i,r){if(n.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,xh(t)&&(t=r?0:n.length-1),t<0&&(t=n.length+t),t>=n.length){if(r)return-1;t=n.length-1}else if(t<0)if(r)t=0;else return-1;if(typeof e=="string"&&(e=$.from(e,i)),$.isBuffer(e))return e.length===0?-1:$c(n,e,t,i,r);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?r?Uint8Array.prototype.indexOf.call(n,e,t):Uint8Array.prototype.lastIndexOf.call(n,e,t):$c(n,[e],t,i,r);throw new TypeError("val must be string, number or Buffer")}function $c(n,e,t,i,r){let s=1,o=n.length,l=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(n.length<2||e.length<2)return-1;s=2,o/=2,l/=2,t/=2}function a(c,f){return s===1?c[f]:c.readUInt16BE(f*s)}let h;if(r){let c=-1;for(h=t;h<o;h++)if(a(n,h)===a(e,c===-1?0:h-c)){if(c===-1&&(c=h),h-c+1===l)return c*s}else c!==-1&&(h-=h-c),c=-1}else for(t+l>o&&(t=o-l),h=t;h>=0;h--){let c=!0;for(let f=0;f<l;f++)if(a(n,h+f)!==a(e,f)){c=!1;break}if(c)return h}return-1}$.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};$.prototype.indexOf=function(e,t,i){return Ed(this,e,t,i,!0)};$.prototype.lastIndexOf=function(e,t,i){return Ed(this,e,t,i,!1)};function y1(n,e,t,i){t=Number(t)||0;const r=n.length-t;i?(i=Number(i),i>r&&(i=r)):i=r;const s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){const l=parseInt(e.substr(o*2,2),16);if(xh(l))return o;n[t+o]=l}return o}function w1(n,e,t,i){return Ao(ql(e,n.length-t),n,t,i)}function S1(n,e,t,i){return Ao(W1(e),n,t,i)}function k1(n,e,t,i){return Ao(Ud(e),n,t,i)}function $1(n,e,t,i){return Ao(D1(e,n.length-t),n,t,i)}$.prototype.write=function(e,t,i,r){if(t===void 0)r="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")r=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,r===void 0&&(r="utf8")):(r=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return y1(this,e,t,i);case"utf8":case"utf-8":return w1(this,e,t,i);case"ascii":case"latin1":case"binary":return S1(this,e,t,i);case"base64":return k1(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $1(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}};$.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function v1(n,e,t){return e===0&&t===n.length?Xl.fromByteArray(n):Xl.fromByteArray(n.slice(e,t))}function Wd(n,e,t){t=Math.min(n.length,t);const i=[];let r=e;for(;r<t;){const s=n[r];let o=null,l=s>239?4:s>223?3:s>191?2:1;if(r+l<=t){let a,h,c,f;switch(l){case 1:s<128&&(o=s);break;case 2:a=n[r+1],(a&192)===128&&(f=(s&31)<<6|a&63,f>127&&(o=f));break;case 3:a=n[r+1],h=n[r+2],(a&192)===128&&(h&192)===128&&(f=(s&15)<<12|(a&63)<<6|h&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:a=n[r+1],h=n[r+2],c=n[r+3],(a&192)===128&&(h&192)===128&&(c&192)===128&&(f=(s&15)<<18|(a&63)<<12|(h&63)<<6|c&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,l=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),r+=l}return Q1(i)}const vc=4096;function Q1(n){const e=n.length;if(e<=vc)return String.fromCharCode.apply(String,n);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,n.slice(i,i+=vc));return t}function T1(n,e,t){let i="";t=Math.min(n.length,t);for(let r=e;r<t;++r)i+=String.fromCharCode(n[r]&127);return i}function P1(n,e,t){let i="";t=Math.min(n.length,t);for(let r=e;r<t;++r)i+=String.fromCharCode(n[r]);return i}function A1(n,e,t){const i=n.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let r="";for(let s=e;s<t;++s)r+=M1[n[s]];return r}function R1(n,e,t){const i=n.slice(e,t);let r="";for(let s=0;s<i.length-1;s+=2)r+=String.fromCharCode(i[s]+i[s+1]*256);return r}$.prototype.slice=function(e,t){const i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,$.prototype),r};function De(n,e,t){if(n%1!==0||n<0)throw new RangeError("offset is not uint");if(n+e>t)throw new RangeError("Trying to access beyond buffer length")}$.prototype.readUintLE=$.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||De(e,t,this.length);let r=this[e],s=1,o=0;for(;++o<t&&(s*=256);)r+=this[e+o]*s;return r};$.prototype.readUintBE=$.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||De(e,t,this.length);let r=this[e+--t],s=1;for(;t>0&&(s*=256);)r+=this[e+--t]*s;return r};$.prototype.readUint8=$.prototype.readUInt8=function(e,t){return e=e>>>0,t||De(e,1,this.length),this[e]};$.prototype.readUint16LE=$.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||De(e,2,this.length),this[e]|this[e+1]<<8};$.prototype.readUint16BE=$.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||De(e,2,this.length),this[e]<<8|this[e+1]};$.prototype.readUint32LE=$.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||De(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};$.prototype.readUint32BE=$.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||De(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};$.prototype.readBigUInt64LE=Di(function(e){e=e>>>0,Nn(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Lr(e,this.length-8);const r=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(r)+(BigInt(s)<<BigInt(32))});$.prototype.readBigUInt64BE=Di(function(e){e=e>>>0,Nn(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Lr(e,this.length-8);const r=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(r)<<BigInt(32))+BigInt(s)});$.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||De(e,t,this.length);let r=this[e],s=1,o=0;for(;++o<t&&(s*=256);)r+=this[e+o]*s;return s*=128,r>=s&&(r-=Math.pow(2,8*t)),r};$.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||De(e,t,this.length);let r=t,s=1,o=this[e+--r];for(;r>0&&(s*=256);)o+=this[e+--r]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};$.prototype.readInt8=function(e,t){return e=e>>>0,t||De(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};$.prototype.readInt16LE=function(e,t){e=e>>>0,t||De(e,2,this.length);const i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};$.prototype.readInt16BE=function(e,t){e=e>>>0,t||De(e,2,this.length);const i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};$.prototype.readInt32LE=function(e,t){return e=e>>>0,t||De(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};$.prototype.readInt32BE=function(e,t){return e=e>>>0,t||De(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};$.prototype.readBigInt64LE=Di(function(e){e=e>>>0,Nn(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Lr(e,this.length-8);const r=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});$.prototype.readBigInt64BE=Di(function(e){e=e>>>0,Nn(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Lr(e,this.length-8);const r=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});$.prototype.readFloatLE=function(e,t){return e=e>>>0,t||De(e,4,this.length),Un.read(this,e,!0,23,4)};$.prototype.readFloatBE=function(e,t){return e=e>>>0,t||De(e,4,this.length),Un.read(this,e,!1,23,4)};$.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||De(e,8,this.length),Un.read(this,e,!0,52,8)};$.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||De(e,8,this.length),Un.read(this,e,!1,52,8)};function ot(n,e,t,i,r,s){if(!$.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>n.length)throw new RangeError("Index out of range")}$.prototype.writeUintLE=$.prototype.writeUIntLE=function(e,t,i,r){if(e=+e,t=t>>>0,i=i>>>0,!r){const l=Math.pow(2,8*i)-1;ot(this,e,t,i,l,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};$.prototype.writeUintBE=$.prototype.writeUIntBE=function(e,t,i,r){if(e=+e,t=t>>>0,i=i>>>0,!r){const l=Math.pow(2,8*i)-1;ot(this,e,t,i,l,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};$.prototype.writeUint8=$.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,1,255,0),this[t]=e&255,t+1};$.prototype.writeUint16LE=$.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};$.prototype.writeUint16BE=$.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};$.prototype.writeUint32LE=$.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};$.prototype.writeUint32BE=$.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function Dd(n,e,t,i,r){_d(e,i,r,n,t,7);let s=Number(e&BigInt(4294967295));n[t++]=s,s=s>>8,n[t++]=s,s=s>>8,n[t++]=s,s=s>>8,n[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return n[t++]=o,o=o>>8,n[t++]=o,o=o>>8,n[t++]=o,o=o>>8,n[t++]=o,t}function Md(n,e,t,i,r){_d(e,i,r,n,t,7);let s=Number(e&BigInt(4294967295));n[t+7]=s,s=s>>8,n[t+6]=s,s=s>>8,n[t+5]=s,s=s>>8,n[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return n[t+3]=o,o=o>>8,n[t+2]=o,o=o>>8,n[t+1]=o,o=o>>8,n[t]=o,t+8}$.prototype.writeBigUInt64LE=Di(function(e,t=0){return Dd(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});$.prototype.writeBigUInt64BE=Di(function(e,t=0){return Md(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});$.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t=t>>>0,!r){const a=Math.pow(2,8*i-1);ot(this,e,t,i,a-1,-a)}let s=0,o=1,l=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&l===0&&this[t+s-1]!==0&&(l=1),this[t+s]=(e/o>>0)-l&255;return t+i};$.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t=t>>>0,!r){const a=Math.pow(2,8*i-1);ot(this,e,t,i,a-1,-a)}let s=i-1,o=1,l=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&l===0&&this[t+s+1]!==0&&(l=1),this[t+s]=(e/o>>0)-l&255;return t+i};$.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};$.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};$.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};$.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};$.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||ot(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};$.prototype.writeBigInt64LE=Di(function(e,t=0){return Dd(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});$.prototype.writeBigInt64BE=Di(function(e,t=0){return Md(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Bd(n,e,t,i,r,s){if(t+i>n.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Ld(n,e,t,i,r){return e=+e,t=t>>>0,r||Bd(n,e,t,4),Un.write(n,e,t,i,23,4),t+4}$.prototype.writeFloatLE=function(e,t,i){return Ld(this,e,t,!0,i)};$.prototype.writeFloatBE=function(e,t,i){return Ld(this,e,t,!1,i)};function zd(n,e,t,i,r){return e=+e,t=t>>>0,r||Bd(n,e,t,8),Un.write(n,e,t,i,52,8),t+8}$.prototype.writeDoubleLE=function(e,t,i){return zd(this,e,t,!0,i)};$.prototype.writeDoubleBE=function(e,t,i){return zd(this,e,t,!1,i)};$.prototype.copy=function(e,t,i,r){if(!$.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!r&&r!==0&&(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);const s=r-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),s};$.prototype.fill=function(e,t,i,r){if(typeof e=="string"){if(typeof t=="string"?(r=t,t=0,i=this.length):typeof i=="string"&&(r=i,i=this.length),r!==void 0&&typeof r!="string")throw new TypeError("encoding must be a string");if(typeof r=="string"&&!$.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(e.length===1){const o=e.charCodeAt(0);(r==="utf8"&&o<128||r==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{const o=$.isBuffer(e)?e:$.from(e,r),l=o.length;if(l===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%l]}return this};const wn={};function Oh(n,e,t){wn[n]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${n}]`,this.stack,delete this.name}get code(){return n}set code(r){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:r,writable:!0})}toString(){return`${this.name} [${n}]: ${this.message}`}}}Oh("ERR_BUFFER_OUT_OF_BOUNDS",function(n){return n?`${n} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Oh("ERR_INVALID_ARG_TYPE",function(n,e){return`The "${n}" argument must be of type number. Received type ${typeof e}`},TypeError);Oh("ERR_OUT_OF_RANGE",function(n,e,t){let i=`The value of "${n}" is out of range.`,r=t;return Number.isInteger(t)&&Math.abs(t)>2**32?r=Qc(String(t)):typeof t=="bigint"&&(r=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(r=Qc(r)),r+="n"),i+=` It must be ${e}. Received ${r}`,i},RangeError);function Qc(n){let e="",t=n.length;const i=n[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${n.slice(t-3,t)}${e}`;return`${n.slice(0,t)}${e}`}function C1(n,e,t){Nn(e,"offset"),(n[e]===void 0||n[e+t]===void 0)&&Lr(e,n.length-(t+1))}function _d(n,e,t,i,r,s){if(n>t||n<e){const o=typeof e=="bigint"?"n":"";let l;throw s>3?e===0||e===BigInt(0)?l=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:l=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:l=`>= ${e}${o} and <= ${t}${o}`,new wn.ERR_OUT_OF_RANGE("value",l,n)}C1(i,r,s)}function Nn(n,e){if(typeof n!="number")throw new wn.ERR_INVALID_ARG_TYPE(e,"number",n)}function Lr(n,e,t){throw Math.floor(n)!==n?(Nn(n,t),new wn.ERR_OUT_OF_RANGE(t||"offset","an integer",n)):e<0?new wn.ERR_BUFFER_OUT_OF_BOUNDS:new wn.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,n)}const I1=/[^+/0-9A-Za-z-_]/g;function E1(n){if(n=n.split("=")[0],n=n.trim().replace(I1,""),n.length<2)return"";for(;n.length%4!==0;)n=n+"=";return n}function ql(n,e){e=e||1/0;let t;const i=n.length;let r=null;const s=[];for(let o=0;o<i;++o){if(t=n.charCodeAt(o),t>55295&&t<57344){if(!r){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),r=t;continue}t=(r-55296<<10|t-56320)+65536}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function W1(n){const e=[];for(let t=0;t<n.length;++t)e.push(n.charCodeAt(t)&255);return e}function D1(n,e){let t,i,r;const s=[];for(let o=0;o<n.length&&!((e-=2)<0);++o)t=n.charCodeAt(o),i=t>>8,r=t%256,s.push(r),s.push(i);return s}function Ud(n){return Xl.toByteArray(E1(n))}function Ao(n,e,t,i){let r;for(r=0;r<i&&!(r+t>=e.length||r>=n.length);++r)e[r+t]=n[r];return r}function Ut(n,e){return n instanceof e||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===e.name}function xh(n){return n!==n}const M1=function(){const n="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const i=t*16;for(let r=0;r<16;++r)e[i+r]=n[t]+n[r]}return e}();function Di(n){return typeof BigInt=="undefined"?B1:n}function B1(){throw new Error("BigInt not supported")}const L1=(n,e=0)=>{let t=~~e,i=0;for(let r=0;r<n.length;r++)i+=n[r];return t+=i%256,t%256},Tc=(n,e)=>$.from(n,e);function Pt(n,e){const t=(i,r)=>e(Tc(i),r)>>>0;return t.signed=(i,r)=>e(Tc(i),r),t.unsigned=t,t.model=n,t}Pt("crc1",L1);let Fl=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];typeof Int32Array!="undefined"&&(Fl=new Int32Array(Fl));const z1=(n,e=0)=>{let t=~~e;for(let i=0;i<n.length;i++)t=Fl[(t^n[i])&255]&255;return t};Pt("crc-8",z1);let Vl=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];typeof Int32Array!="undefined"&&(Vl=new Int32Array(Vl));const _1=(n,e=0)=>{let t=~~e;for(let i=0;i<n.length;i++)t=Vl[(t^n[i])&255]&255;return t};Pt("dallas-1-wire",_1);let Yl=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];typeof Int32Array!="undefined"&&(Yl=new Int32Array(Yl));const U1=(n,e=0)=>{let t=~~e;for(let i=0;i<n.length;i++)t=(Yl[(t^n[i])&255]^t>>8)&65535;return t};Pt("crc-16",U1);let Hl=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];typeof Int32Array!="undefined"&&(Hl=new Int32Array(Hl));const N1=(n,e)=>{let t=typeof e!="undefined"?~~e:65535;for(let i=0;i<n.length;i++)t=(Hl[(t>>8^n[i])&255]^t<<8)&65535;return t};Pt("ccitt",N1);let Jl=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];typeof Int32Array!="undefined"&&(Jl=new Int32Array(Jl));const X1=(n,e)=>{let t=typeof e!="undefined"?~~e:65535;for(let i=0;i<n.length;i++)t=(Jl[(t^n[i])&255]^t>>8)&65535;return t};Pt("crc-16-modbus",X1);const Z1=(n,e)=>{let t=typeof e!="undefined"?~~e:0;for(let i=0;i<n.length;i++){let r=t>>>8&255;r^=n[i]&255,r^=r>>>4,t=t<<8&65535,t^=r,r=r<<5&65535,t^=r,r=r<<7&65535,t^=r}return t},j1=Pt("xmodem",Z1);let Kl=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];typeof Int32Array!="undefined"&&(Kl=new Int32Array(Kl));const G1=(n,e)=>{let t=typeof e!="undefined"?~~e:0;for(let i=0;i<n.length;i++)t=(Kl[(t^n[i])&255]^t>>8)&65535;return t};Pt("kermit",G1);let ea=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];typeof Int32Array!="undefined"&&(ea=new Int32Array(ea));const q1=(n,e)=>{let t=typeof e!="undefined"?~~e:11994318;for(let i=0;i<n.length;i++)t=(ea[(t>>16^n[i])&255]^t<<8)&16777215;return t};Pt("crc-24",q1);let ta=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array!="undefined"&&(ta=new Int32Array(ta));const F1=(n,e)=>{let t=e===0?0:~~e^-1;for(let i=0;i<n.length;i++)t=ta[(t^n[i])&255]^t>>>8;return t^-1};Pt("crc-32",F1);let ia=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array!="undefined"&&(ia=new Int32Array(ia));const V1=(n,e=-1)=>{let t=e===0?0:~~e;for(let i=0;i<n.length;i++)t=ia[(t^n[i])&255]^t>>>8;return t};Pt("jam",V1);const fn=1024,Pc=2,Y1=4,H1=6,J1=21,K1=24,eb=67;function tb(n,e){var t=$.alloc(fn,0),i=0;return n&&(t.write(n,i),i=n.length+1),e&&t.write(e.toString()+" ",i),t}function Ac(n,e,t){if(n.byteLength>e){for(var i=[],r=0,s=r+e-1;r<n.byteLength;){s>=n.byteLength&&(s=n.byteLength-1);var o=$.alloc(t||s-r+1,255);n.copy(o,0,r,s+1),i.push(o),r=r+e,s=r+e-1}return i}else{var l=$.alloc(t||e,255);return n.copy(l,0,0,n.byteLength),[l]}}function ib(n,e,t){return new Promise((i,r)=>{var s=[],o=0,l=0,a=0,h=!1,c=!1,f=!1;t=$.from(t.buffer);function u(m){async function b(){var y=Ac(m,256);for(const v of y){var w=new Uint8Array(v.buffer);await n.write(w,"binary")}}return b()}function d(){if(a<s.length){var m=$.alloc(3+fn+2);m[0]=Pc,m[1]=a,m[2]=255-m[1];var b=s[a];b.copy(m,3);var y=j1(b);m.writeUInt16BE(y,m.byteLength-2),u(m)}else c&&u($.from([Y1]))}function p(m){for(var b=0;b<m.byteLength;b++)if(!f){var y=m[b];if(y===eb)c||(d(),c=!0);else if(y===H1){if(h||g(),c)if(a<s.length)l<o&&(l=(a+1)*fn,l>o&&(l=o)),a++,d();else{c=!1,h=!1;var w=$.alloc(fn+5,0);w[0]=Pc,w[1]=0,w[2]=255,u(w)}}else y===J1?d():y===K1&&g()}}function g(){h=!1,c=!1,n.removeListener("data",p),f||i({filePath:e,totalBytes:o,writtenBytes:l}),f=!0}o=t.byteLength;var x=tb(e,o);s.push(x);var Q=Ac(t,fn,fn);Q.forEach(m=>{s.push(m)}),h=!0,n.on("data",p)})}let Yt;function Rc(n){return new Promise(e=>{setTimeout(()=>{e()},n)})}function Cc(n){const e=[...n.data],{width:t,height:i}=n,r=new Uint8Array(t*i*2),s=(l,a,h)=>(l&248)<<8|(a&252)<<3|h>>3;for(let l=0;l<t;l++)for(let a=0;a<i;a++){let h=a*t+l;const[c,f,u,d]=e.slice(h*4,(h+1)*4);if(d<255)continue;const p=s(Math.max(u,5),Math.max(f,5),Math.max(c,5));r[h*2+0]=p>>8,r[h*2+1]=p}return`{
    data: new Uint16Array([${[...new Uint16Array(r.buffer)]}]),
    width: ${t},
    height: ${i}
  }`}let Ht;const na={list:(()=>{var t;const n=JSON.parse((t=localStorage.getItem("beaker-games"))!=null?t:"[]"),e=Array.isArray(n)?n:[];return[...Array(3)].map((i,r)=>{var s;return(s=e[r])!=null?s:{name:"<empty>",code:""}})})(),save(){localStorage.setItem("beaker-games",JSON.stringify(this.list))},add(n){do if(Ht=prompt(`
Your Beaker has 3 slots:
${this.list.map((t,i)=>`[${i}] - ${t==null?void 0:t.name}`).join(`
`)}
Where shall we write your game? [0, 1, 2]
      `),Ht==null)return null;while(!["0","1","2"].includes(Ht));Ht=+Ht;let e;for(;!(e=prompt("What do you call your game?")););alert(`Press upload again to write "${e}" to slot ${Ht}!`),this.list[Ht]={code:n,name:e},this.save()}};function nb(){const n=(e,t=80,i=16)=>{const r=document.createElement("canvas");r.width=t,r.height=i;const s=r.getContext("2d");return s.fillStyle="white",s.fillRect(0,0,108,108),s.fillStyle="black",s.fillText(e,2,10),s.getImageData(0,0,t,i)};return n("maze game"),n("suckyban"),`
    const games = [
      ${na.list.map(({name:e,code:t})=>`{
        code: \`${t.replaceAll("`","\\`")}\`,
        img: ${Cc(n(e))},
      }`).join(`,
`)}
    ];
    const cr = ${Cc(n(">",16,16))};

    /* input */
    const { GPIO } = require("gpio");
    const btn = pin => ({
      last: 1,
      pin: new GPIO(pin, INPUT_PULLUP),
      read() {
        const now = this.pin.read();
        return (now != this.last && !(this.last = now));
      }
    });
    const down = btn(0);
    const open = btn(1);

    /* drawin */
    const width = 128, height = 160;
    const pixels = new Uint16Array(width * height);
    const { rfill, sprdraw } = global.require("native");
    const { screen } = require("screen");

    const gc = screen.getContext("buffer");

    let ts = 0;
    let i = 0;
    const loop = (function loop() {
      i = (i + down.read()) % games.length;
      if (open.read()) {
        if (games[i].code) {
          eval(games[i].code);
          return;
        }
        console.log("there's no game there!");
      }
      rfill(pixels, gc.color16(255, 255, 255), width*height);

      let y = 20;
      for (const { img } of games) {
        sprdraw(img.data, img.width, img.height, pixels, 30, y);
        y += 30
      }
      let t = Math.sin(ts++ / 5) * 4;
      sprdraw(cr.data, cr.width, cr.height, pixels, 10+t, 20+30*i);
      
      const pixels8 = new Uint8Array(pixels.buffer);
      screen.fillImage(0, 0, width, height, pixels8);
      setTimeout(loop, 1000/20);
    })();
  `}async function rb(n){if(Ht==null){na.add(n);return}if(na.list[Ht].code=n,!Yt){const t=await navigator.serial.requestPort();Yt=new u1(t),await Yt.open({baudRate:115200});let i;Yt.on("data",r=>{for(let s of r){if(s==10)return;s==13?(console.log(i),i=""):i+=String.fromCharCode(s)}}),Yt.write("\r.hi\r")}await Yt.write("\r"),await Yt.write(".flash -w\r"),await Rc(500);const e=await ib(Yt,"code",new TextEncoder().encode(nb()));console.log("ymodem transfer result: ",e),await Rc(500),Yt.write("\r.load\r")}let nl=null;function sb(n){let e=n.cloneNode(!0);n.parentNode.replaceChild(e,n),n=e;const t=n.getContext("2d");t.webkitImageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1,n.setAttribute("tabindex","1");function i(){t.fillStyle="white",t.fillRect(0,0,n.width,n.height),X(),s=window.requestAnimationFrame(i)}function r(){window.cancelAnimationFrame(s)}nl&&nl(),nl=r;let s=window.requestAnimationFrame(i);function o(A,E){n.width=A,n.height=E,E*5/4>A?(n.style.height="100%",n.style.removeProperty("width")):(n.style.width="100%",n.style.removeProperty("height")),t.webkitImageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1}let l={},a={width:0,height:0,maxTileDim:0},h=[],c={up:[],down:[],left:[],right:[],i:[],j:[],k:[],l:[]},f=[],u=[],d={},p=[],g="";document.createElement("canvas");class x{constructor(E,J,F){this._type=E,this._x=J,this._y=F,this.dx=0,this.dy=0}set type(E){if(!(E in l))throw new Error(`"${E}" not in legend.`);this.remove(),w(E,this._x,this._y)}get type(){return this._type}set x(E){const J=E-this.x;return Q(this,J,0)&&(this.dx=J),this}get x(){return this._x}set y(E){const J=E-this.y;return Q(this,0,J)&&(this.dy=J),this}get y(){return this._y}remove(){return h=h.filter(E=>E!==this),this}}const Q=(A,E,J)=>{const{x:F,y:re,type:we}=A,{width:de,height:ce}=a,xe=F+E+(re+J)*de;if(!(F+E<de&&F+E>=0&&re+J<ce&&re+J>=0))return!1;const pt=m(),fi=!u.includes(we),Vr=E===0&&J===0,Yr=xe<pt.length&&pt[xe].length===0;if(fi||Vr||Yr)return A._x+=E,A._y+=J,!0;let St=!0;return pt[xe].forEach(Bi=>{const Ft=u.includes(Bi.type),ln=we in d&&d[we].includes(Bi.type);Ft&&!ln&&(St=!1),Ft&&ln&&(St=St&&Q(Bi,E,J))}),St&&(A._x+=E,A._y+=J),St};n.addEventListener("keydown",A=>{const E=A.key;!["w","a","s","d","i","j","k","l"].includes(E)||(E==="w"&&c.up.forEach(F=>F()),E==="a"&&c.left.forEach(F=>F()),E==="s"&&c.down.forEach(F=>F()),E==="d"&&c.right.forEach(F=>F()),E==="i"&&c.i.forEach(F=>F()),E==="j"&&c.j.forEach(F=>F()),E==="k"&&c.k.forEach(F=>F()),E==="l"&&c.l.forEach(F=>F()),f.forEach(F=>F()),h.forEach(F=>{F.dx=0,F.dy=0}),A.preventDefault())});const m=()=>{const{width:A,height:E}=a,J=new Array(A*E).fill(0).map(F=>[]);return h.forEach(F=>{const re=F.x+F.y*A;J[re].push(F)}),J},b=(A,E)=>{const{width:J,height:F}=a;if(A>J||A<0||E<0||E>F)throw new Error("Sprite out of bounds.")},y=A=>{if(!(A in l))throw new Error(`Unknown sprite type: ${A}`)},w=(A,E,J)=>{if(A===".")return;if(A==="*")throw new Error("* wildcards are read-only.");if(b(E,J),y(A),l[A].type!==void 0){const re=l[A].type;if(re==="and"&&l[A].list.forEach(we=>{const de=new x(we,E,J);h.push(de)}),re==="or")throw new Error('"anyOf" combinations are read only.')}else{const re=new x(A,E,J);h.push(re)}},v=(...A)=>({type:"or",list:A}),R=(...A)=>({type:"and",list:A});let N={};function M(A){for(const E of Object.keys(A))[".","*"].includes(E)?(console.warn(`Legend key "${E}" has a special meaning in some case, you should avoid it`),delete A[E]):E.length>1&&(console.warn(`Legend key "${E}" is too long, you should only use single-character keys`),delete A[E]);l=A,N={},ge("SET_BITMAPS",{bitmaps:A})}function C(A){if(!(A in l))throw new Error(`Type not in legend: ${A}`);const E=l[A];if(E.type!==void 0)throw new Error("Can not draw combination sprites.");if(!(A in N)){const F=document.createElement("canvas");F.width=E.imageData.width,F.height=E.imageData.height;const re=F.getContext("2d");re.webkitImageSmoothingEnabled=!1,re.mozImageSmoothingEnabled=!1,re.imageSmoothingEnabled=!1,re.putImageData(E.imageData,0,0),N[A]=F}return N[A]}const O=A=>A.every(E=>E===A[0]);function k(A){const E=A.trim().split(`
`).map(ce=>ce.trim()),J=E.map(ce=>ce.length);O(J)||console.error("Level must be rect.");const re=E[0].length,we=E.length;a.width=re,a.height=we,h=[];const de=Math.min(n.width/re,n.height/we);a.maxTileDim=de,o(re*de,we*de);for(let ce=0;ce<re*we;ce++){const xe=A.split("").filter(fi=>fi.match(/\S/))[ce],wt=ce%re,pt=Math.floor(ce/re);w(xe,wt,pt)}}function T(A,E){h=h.filter(J=>J.x!==A||J.y!==E)}function z(A,E){return m()[a.width*E+A]}function W(A){u=A}function D(A){d=A}function U(A,E){A in c||console.error("Unknown input type:",A),c[A].push(E)}function X(){const A=m(),{width:E,maxTileDim:J}=a;for(let F=0;F<A.length;F++){const re=F%E,we=Math.floor(F/E),de=A[F];if(g!==""){const ce=C(g);t.drawImage(ce,re*J,we*J,J,J)}de.sort((ce,xe)=>p.indexOf(xe.type)-p.indexOf(ce.type)).forEach(({type:ce})=>{const xe=C(ce);t.drawImage(xe,re*J,we*J,J,J)})}}function _(A){const E=[],J=A.trim().split(`
`).map(xe=>xe.trim()),F=J.map(xe=>xe.length);if(!O(F))throw new Error("Pattern must be rectangle.");const we=J[0].length,de=J.length;for(let xe=0;xe<we*de;xe++){const wt=A.split("").filter(pt=>pt.match(/\S/))[xe];E.push(wt)}return{width:we,height:de,pattern:E}}function q(A){var xe,wt,pt;const{width:E,height:J}=a,{width:F,height:re,pattern:we}=A;let de=[];const ce=m();for(let fi=0;fi<ce.length;fi++){const Vr=fi%E,Yr=Math.floor(fi/E);if(Vr+F>E||Yr+re>J)continue;let St=!0,Bi=[];for(let Ft=0;Ft<F*re;Ft++){const ln=Ft%F,$m=Math.floor(Ft/F),Vt=we[Ft],vm=ln+Vr+($m+Yr)*E;let qn=ce[vm],Me;if(((xe=l[Vt])==null?void 0:xe.type)==="and"){const ui=l[Vt].list,Hr=[];qn.forEach(Ho=>{ui.includes(Ho.type)&&!Hr.includes(Ho)&&Hr.push(Ho)}),Hr.length===ui.length&&(Me=Hr)}else((wt=l[Vt])==null?void 0:wt.type)==="or"?(Me=qn.find(ui=>l[Vt].list.includes(ui.type)),Me!==void 0?Me=[Me]:St=!1):Vt==="*"?(Me=qn.find(ui=>ui.type),Me===void 0?Me=[]:Me=[Me]):Vt==="."&&qn.length===0?Me=[]:Vt in l&&((pt=l[Vt])==null?void 0:pt.type)===void 0&&(Me=qn.find(ui=>ui.type===Vt),Me!==void 0?Me=[Me]:St=!1);St=St&&Me!==void 0,Bi.push(Me)}St&&(Bi.some(ln=>de.flat().includes(ln))||de.push(Bi))}return de}function I(A){const E=_(A);return q(E)}function V(A,E){const J=_(A),F=q(J),re=_(E);if(J.width!==re.width||J.height!==re.height)throw new Error("Patterns passed to replacePattern must be the same size");return F.forEach(we=>{we.forEach((de,ce)=>{const xe=re.pattern[ce];Array.isArray(de)?de.forEach((wt,pt)=>{wt.remove(),pt===0&&w(xe,wt.x,wt.y)}):(de.remove(),w(xe,de.x,de.y))})}),F.length>0}function oe(A){f.push(A)}function ue(A){return(E,...J)=>{if(typeof E=="string")throw new Error("Tagged template literal must be used like name`text`, instead of name(`text`)");const F=E.reduce((re,we,de)=>{var ce;return re+we+((ce=J[de])!=null?ce:"")},"");return A(F)}}return{setScreenSize:o,setLegend:M,setMap:k,addSprite:w,getGrid:m,getTile:z,clearTile:T,onInput:U,setSolids:W,setPushables:D,afterInput:oe,map:ue(A=>A),tune:ue(A=>Ad(A)),bitmap:ue(A=>({text:A,imageData:bn(A,oi.palette)})),match:I,replace:V,getFirst:A=>h.find(E=>E.type===A),getAll:A=>A?h.filter(E=>E.type===A):h,anyOf:v,allOf:R,setZOrder:A=>{p=A},setBackground:A=>{y(A),g=A}}}const ob=window.AudioContext||window.webkitAudioContext,pi=new ob,lb={B0:31,C1:33,"C#1":35,D1:37,"D#1":39,E1:41,F1:44,"F#1":46,G1:49,"G#1":52,A1:55,"A#1":58,B1:62,C2:65,"C#2":69,D2:73,"D#2":78,E2:82,F2:87,"F#2":93,G2:98,"G#2":104,A2:110,"A#2":117,B2:123,C3:131,"C#3":139,D3:147,"D#3":156,E3:165,F3:175,"F#3":185,G3:196,"G#3":208,A3:220,"A#3":233,B3:247,C4:262,"C#4":277,D4:294,"D#4":311,E4:330,F4:349,"F#4":370,G4:392,"G#4":415,A4:440,"A#4":466,B4:494,C5:523,"C#5":554,D5:587,"D#5":622,E5:659,F5:698,"F#5":740,G5:784,"G#5":831,A5:880,"A#5":932,B5:988,C6:1047,"C#6":1109,D6:1175,"D#6":1245,E6:1319,F6:1397,"F#6":1480,G6:1568,"G#6":1661,A6:1760,"A#6":1865,B6:1976,C7:2093,"C#7":2217,D7:2349,"D#7":2489,E7:2637,F7:2794,"F#7":2960,G7:3136,"G#7":3322,A7:3520,"A#7":3729,B7:3951,C8:4186,"C#8":4435,D8:4699,"D#8":4978},ab=async n=>new Promise(e=>setTimeout(e,n)),hb=["sine","triangle","square","sawtooth"];async function cb(n,e,t){for(let i=0;i<n.length*e;i++){const r=i%n.length;if(!t.playing)break;const s=n[r],o=s[0];for(let l=1;l<s.length;l+=3){const a=s[l],h=s[l+1],c=s[l+2],f=typeof h=="string"?lb[h.toUpperCase()]:2**((h-69)/12)*440;hb.includes(a)&&f!==void 0&&ub(f,c,a)}await ab(o)}}function fb(n,e=1){let t={playing:!0};return cb(n,e,t),{end(){t.playing=!1},isPlaying(){return t.playing}}}function ub(n,e,t){var i=pi.createOscillator(),r=pi.createGain();i.frequency.value=n,i.type=t!=null?t:"sine",i.connect(r),r.connect(pi.destination),i.start();const s=pi.currentTime+e*2/1e3;i.stop(s),r.gain.setValueAtTime(0,pi.currentTime),r.gain.linearRampToValueAtTime(.2,pi.currentTime+e/5/1e3),r.gain.exponentialRampToValueAtTime(1e-5,pi.currentTime+e/1e3),r.gain.linearRampToValueAtTime(0,pi.currentTime+e*2/1e3),i.onended=()=>{r.disconnect()}}let rl=[];function db(n,e){const t=document.querySelector(".game-canvas"),i=sb(t);rl.forEach(r=>r.end()),rl=[],i.playTune=(r,s)=>{const o=fb(r,s);rl.push(o)};try{return new Function(...Object.keys(i),n)(...Object.values(i)),null}catch(r){return r}}function pb(n,e){ah(e),e.logs=[],e.errorInfo=null;const t=document.querySelectorAll(".cm-line");for(let s=0;s<t.length;s++){const o=t[s];o.style.background="",o.classList.remove("err-line")}const i=e.codemirror.state.doc.toString(),r=db(i,e.palette);r&&ge("LOG_ERROR",{err:r}),ge("RENDER")}const gb=n=>fetch(n,{mode:"cors"}).then(e=>e.text());function mb(n){return new URLSearchParams(window.location.search).get(n)}async function Ob(){let n=mb("file");return n?await gb(n):void 0}class ae{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(t,this.length,r,1),zt.from(r,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];return this.decompose(e,t,i,0),zt.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new fr(this),s=new fr(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=i)return!0}}iter(e=1){return new fr(this,e)}iterRange(e,t=this.length){return new Nd(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Xd(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?ae.empty:e.length<=32?new Qe(e):zt.from(Qe.split(e,[]))}}class Qe extends ae{constructor(e,t=xb(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?i:l)>=e)return new bb(r,l,i,o);r=l+1,i++}}decompose(e,t,i,r){let s=e<=0&&t>=this.length?this:new Qe(Ic(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),l=Ts(s.text,o.text.slice(),0,s.length);if(l.length<=32)i.push(new Qe(l,o.length+s.length));else{let a=l.length>>1;i.push(new Qe(l.slice(0,a)),new Qe(l.slice(a)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Qe))return super.replace(e,t,i);let r=Ts(this.text,Ts(i.text,Ic(this.text,0,e)),t),s=this.length+i.length-(t-e);return r.length<=32?new Qe(r,s):zt.from(Qe.split(r,[]),s)}sliceString(e,t=this.length,i=`
`){let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=i),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(t.push(new Qe(i,r)),i=[],r=-1);return r>-1&&t.push(new Qe(i,r)),t}}class zt extends ae{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=i+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,i,r);r=l+1,i=a+1}}decompose(e,t,i,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let h=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!h?i.push(l):l.decompose(e-o,t-o,i,h)}o=a+1}}replace(e,t,i){if(i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,i),h=this.lines-o.lines+a.lines;if(a.lines<h>>5-1&&a.lines>h>>5+1){let c=this.children.slice();return c[r]=a,new zt(c,this.length-(t-e)+i.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=i),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,i)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof zt))return 0;let i=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return i;let a=this.children[r],h=e.children[s];if(a!=h)return i+a.scanIdentical(h,t);i+=a.length+1}}static from(e,t=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let d of e)i+=d.lines;if(i<32){let d=[];for(let p of e)p.flatten(d);return new Qe(d,t)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,l=[],a=0,h=-1,c=[];function f(d){let p;if(d.lines>s&&d instanceof zt)for(let g of d.children)f(g);else d.lines>o&&(a>o||!a)?(u(),l.push(d)):d instanceof Qe&&a&&(p=c[c.length-1])instanceof Qe&&d.lines+p.lines<=32?(a+=d.lines,h+=d.length+1,c[c.length-1]=new Qe(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>r&&u(),a+=d.lines,h+=d.length+1,c.push(d))}function u(){a!=0&&(l.push(c.length==1?c[0]:zt.from(c,h)),h=-1,a=c.length=0)}for(let d of e)f(d);return u(),l.length==1?l[0]:new zt(l,t)}}ae.empty=new Qe([""],0);function xb(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Ts(n,e,t=0,i=1e9){for(let r=0,s=0,o=!0;s<n.length&&r<=i;s++){let l=n[s],a=r+l.length;a>=t&&(a>i&&(l=l.slice(0,i-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function Ic(n,e,t){return Ts(n,[""],e,t)}class fr{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Qe?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,l=r instanceof Qe?r.text.length:r.children.length;if(o==(t>0?l:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Qe){let a=r.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof Qe?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Nd{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new fr(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=i?r:t<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Xd{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:r}=this.inner.next(e);return t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(ae.prototype[Symbol.iterator]=function(){return this.iter()},fr.prototype[Symbol.iterator]=Nd.prototype[Symbol.iterator]=Xd.prototype[Symbol.iterator]=function(){return this});class bb{constructor(e,t,i,r){this.from=e,this.to=t,this.number=i,this.text=r}get length(){return this.to-this.from}}let Sn="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<Sn.length;n++)Sn[n]+=Sn[n-1];function yb(n){for(let e=1;e<Sn.length;e+=2)if(Sn[e]>n)return Sn[e-1]<=n;return!1}function Ec(n){return n>=127462&&n<=127487}const Wc=8205;function ft(n,e,t=!0,i=!0){return(t?Zd:wb)(n,e,i)}function Zd(n,e,t){if(e==n.length)return e;e&&jd(n.charCodeAt(e))&&Gd(n.charCodeAt(e-1))&&e--;let i=Ze(n,e);for(e+=Ot(i);e<n.length;){let r=Ze(n,e);if(i==Wc||r==Wc||t&&yb(r))e+=Ot(r),i=r;else if(Ec(r)){let s=0,o=e-2;for(;o>=0&&Ec(Ze(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function wb(n,e,t){for(;e>0;){let i=Zd(n,e-2,t);if(i<e)return i;e--}return 0}function jd(n){return n>=56320&&n<57344}function Gd(n){return n>=55296&&n<56320}function Ze(n,e){let t=n.charCodeAt(e);if(!Gd(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return jd(i)?(t-55296<<10)+(i-56320)+65536:t}function bh(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Ot(n){return n<65536?1:2}const ra=/\r\n?|\n/;var _e=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(_e||(_e={}));class ti{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,t=!1){sa(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];r<0?e.push(i,r):e.push(r,i)}return new ti(e)}composeDesc(e){return this.empty?e:e.empty?this:qd(this,e)}mapDesc(e,t=!1){return e.empty?this:oa(this,e,t)}mapPos(e,t=-1,i=_e.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],h=r+l;if(a<0){if(h>e)return s+(e-r);s+=l}else{if(i!=_e.Simple&&h>=e&&(i==_e.TrackDel&&r<e&&h>e||i==_e.TrackBefore&&r<e||i==_e.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=h}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let i=0,r=0;i<this.sections.length&&r<=t;){let s=this.sections[i++],o=this.sections[i++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ti(e)}}class Ie extends ti{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return sa(this,(t,i,r,s,o)=>e=e.replace(r,r+(i-t),o),!1),e}mapDesc(e,t=!1){return oa(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;i.length<a;)i.push(ae.empty);i.push(o?e.slice(s,s+o):ae.empty)}s+=o}return new Ie(t,i)}compose(e){return this.empty?e:e.empty?this:qd(this,e,!0)}map(e,t=!1){return e.empty?this:oa(this,e,t,!0)}iterChanges(e,t=!1){sa(this,e,t)}get desc(){return new ti(this.sections)}filter(e){let t=[],i=[],r=[],s=new kr(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,a-l);qe(r,c,-1);let f=s.ins==-1?-1:s.off==0?s.ins:0;qe(t,c,f),f>0&&Zi(i,t,s.text),s.forward(c),l+=c}let h=e[o++];for(;l<h;){if(s.done)break e;let c=Math.min(s.len,h-l);qe(t,c,-1),qe(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),l+=c}}return{changes:new Ie(t,i),filtered:new ti(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],r=this.sections[t+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let r=[],s=[],o=0,l=null;function a(c=!1){if(!c&&!r.length)return;o<t&&qe(r,t-o,-1);let f=new Ie(r,s);l=l?l.compose(f.map(l)):f,r=[],s=[],o=0}function h(c){if(Array.isArray(c))for(let f of c)h(f);else if(c instanceof Ie){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);a(),l=l?l.compose(c.map(l)):c}else{let{from:f,to:u=f,insert:d}=c;if(f>u||f<0||u>t)throw new RangeError(`Invalid change range ${f} to ${u} (in doc of length ${t})`);let p=d?typeof d=="string"?ae.of(d.split(i||ra)):d:ae.empty,g=p.length;if(f==u&&g==0)return;f<o&&a(),f>o&&qe(r,f-o,-1),qe(r,u-f,g),Zi(s,r,p),o=u}}return h(e),a(!l),l}static empty(e){return new Ie(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<r;)i.push(ae.empty);i[r]=ae.of(s.slice(1)),t.push(s[0],i[r].length)}}}return new Ie(t,i)}}function qe(n,e,t,i=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:e==0&&n[r]==0?n[r+1]+=t:i?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function Zi(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(ae.empty);n.push(t)}}function sa(n,e,t){let i=n.inserted;for(let r=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,f=ae.empty;for(;h+=l,c+=a,a&&i&&(f=f.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(r,h,s,c,f),r=h,s=c}}}function oa(n,e,t,i=!1){let r=[],s=i?[]:null,o=new kr(n),l=new kr(e);for(let a=0,h=0;;)if(o.ins==-1)a+=o.len,o.next();else if(l.ins==-1&&h<a){let c=Math.min(l.len,a-h);l.forward(c),qe(r,c,-1),h+=c}else if(l.ins>=0&&(o.done||h<a||h==a&&(l.len<o.len||l.len==o.len&&!t))){for(qe(r,l.ins,-1);a>h&&!o.done&&a+o.len<h+l.len;)a+=o.len,o.next();h+=l.len,l.next()}else if(o.ins>=0){let c=0,f=a+o.len;for(;;)if(l.ins>=0&&h>a&&h+l.len<f)c+=l.ins,h+=l.len,l.next();else if(l.ins==-1&&h<f){let u=Math.min(l.len,f-h);c+=u,l.forward(u),h+=u}else break;qe(r,c,o.ins),s&&Zi(s,r,o.text),a=f,o.next()}else{if(o.done&&l.done)return s?new Ie(r,s):new ti(r);throw new Error("Mismatched change set lengths")}}function qd(n,e,t=!1){let i=[],r=t?[]:null,s=new kr(n),o=new kr(e);for(let l=!1;;){if(s.done&&o.done)return r?new Ie(i,r):new ti(i);if(s.ins==0)qe(i,s.len,0,l),s.next();else if(o.len==0&&!o.done)qe(i,0,o.ins,l),r&&Zi(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),h=i.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;qe(i,a,c,l),r&&c&&Zi(r,i,o.text)}else o.ins==-1?(qe(i,s.off?0:s.len,a,l),r&&Zi(r,i,s.textBit(a))):(qe(i,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&Zi(r,i,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||i.length>h),s.forward2(a),o.forward(a)}}}}class kr{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?ae.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?ae.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class gn{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new gn(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return P.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return P.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return P.range(e.anchor,e.head)}}class P{constructor(e,t=0){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:P.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new P([this.main])}addRange(e,t=!0){return P.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,P.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new P(e.ranges.map(t=>gn.fromJSON(t)),e.main)}static single(e,t=e){return new P([P.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return Sb(e.slice(),t);i=s.to}return new P(e,t)}static cursor(e,t=0,i,r){return new gn(e,e,(t==0?0:t<0?4:8)|(i==null?3:Math.min(2,i))|(r!=null?r:33554431)<<5)}static range(e,t,i){let r=(i!=null?i:33554431)<<5;return t<e?new gn(t,e,16|r|8):new gn(e,t,r|(t>e?4:0))}}function Sb(n,e=0){let t=n[e];n.sort((i,r)=>i.from-r.from),e=n.indexOf(t);for(let i=1;i<n.length;i++){let r=n[i],s=n[i-1];if(r.empty?r.from<=s.to:r.from<s.to){let o=s.from,l=Math.max(r.to,s.to);i<=e&&e--,n.splice(--i,2,r.anchor>r.head?P.range(l,o):P.range(o,l))}}return new P(n,e)}function Fd(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let yh=0;class G{constructor(e,t,i,r,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=r,this.extensions=s,this.id=yh++,this.default=e([])}static define(e={}){return new G(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:wh),!!e.static,e.enables)}of(e){return new Ps([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ps(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ps(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function wh(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class Ps{constructor(e,t,i,r){this.dependencies=e,this.facet=t,this.type=i,this.value=r,this.id=yh++}dynamicSlot(e){var t;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,h=!1,c=[];for(let f of this.dependencies)f=="doc"?a=!0:f=="selection"?h=!0:(((t=e[f.id])!==null&&t!==void 0?t:1)&1)==0&&c.push(e[f.id]);return{create(f){return f.values[o]=i(f),1},update(f,u){if(a&&u.docChanged||h&&(u.docChanged||u.selection)||la(f,c)){let d=i(f);if(l?!Dc(d,f.values[o],r):!r(d,f.values[o]))return f.values[o]=d,1}return 0},reconfigure:(f,u)=>{let d=i(f),p=u.config.address[s];if(p!=null){let g=Zs(u,p);if(this.dependencies.every(x=>x instanceof G?u.facet(x)===f.facet(x):x instanceof Ce?u.field(x,!1)==f.field(x,!1):!0)||(l?Dc(d,g,r):r(d,g)))return f.values[o]=g,0}return f.values[o]=d,1}}}}function Dc(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function la(n,e){let t=!1;for(let i of e)ur(n,i)&1&&(t=!0);return t}function kb(n,e,t){let i=t.map(a=>n[a.id]),r=t.map(a=>a.type),s=i.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let h=[];for(let c=0;c<i.length;c++){let f=Zs(a,i[c]);if(r[c]==2)for(let u of f)h.push(u);else h.push(f)}return e.combine(h)}return{create(a){for(let h of i)ur(a,h);return a.values[o]=l(a),1},update(a,h){if(!la(a,s))return 0;let c=l(a);return e.compare(c,a.values[o])?0:(a.values[o]=c,1)},reconfigure(a,h){let c=la(a,i),f=h.config.facets[e.id],u=h.facet(e);if(f&&!c&&wh(t,f))return a.values[o]=u,0;let d=l(a);return e.compare(d,u)?(a.values[o]=u,0):(a.values[o]=d,1)}}}const Mc=G.define({static:!0});class Ce{constructor(e,t,i,r,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new Ce(yh++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Mc).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,r)=>{let s=i.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,r)=>r.config.address[this.id]!=null?(i.values[t]=r.field(this),0):(i.values[t]=this.create(i),1)}}init(e){return[this,Mc.of({field:this,create:e})]}get extension(){return this}}const un={lowest:4,low:3,default:2,high:1,highest:0};function Kn(n){return e=>new Vd(e,n)}const Xn={highest:Kn(un.highest),high:Kn(un.high),default:Kn(un.default),low:Kn(un.low),lowest:Kn(un.lowest)};class Vd{constructor(e,t){this.inner=e,this.prec=t}}class Ro{of(e){return new aa(this,e)}reconfigure(e){return Ro.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class aa{constructor(e,t){this.compartment=e,this.inner=t}}class Xs{constructor(e,t,i,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let r=[],s=Object.create(null),o=new Map;for(let u of $b(e,t,o))u instanceof Ce?r.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let l=Object.create(null),a=[],h=[];for(let u of r)l[u.id]=h.length<<1,h.push(d=>u.slot(d));let c=i==null?void 0:i.config.facets;for(let u in s){let d=s[u],p=d[0].facet,g=c&&c[u]||[];if(d.every(x=>x.type==0))if(l[p.id]=a.length<<1|1,wh(g,d))a.push(i.facet(p));else{let x=p.combine(d.map(Q=>Q.value));a.push(i&&p.compare(x,i.facet(p))?i.facet(p):x)}else{for(let x of d)x.type==0?(l[x.id]=a.length<<1|1,a.push(x.value)):(l[x.id]=h.length<<1,h.push(Q=>x.dynamicSlot(Q)));l[p.id]=h.length<<1,h.push(x=>kb(x,p,d))}}let f=h.map(u=>u(l));return new Xs(e,o,f,l,a,s)}}function $b(n,e,t){let i=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a<=l)return;let h=i[a].indexOf(o);h>-1&&i[a].splice(h,1),o instanceof aa&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let h of o)s(h,l);else if(o instanceof aa){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),s(h,l)}else if(o instanceof Vd)s(o.inner,o.prec);else if(o instanceof Ce)i[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof Ps)i[l].push(o),o.facet.extensions&&s(o.facet.extensions,l);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(h,l)}}return s(n,un.default),i.reduce((o,l)=>o.concat(l))}function ur(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function Zs(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const Yd=G.define(),Hd=G.define({combine:n=>n.some(e=>e),static:!0}),Jd=G.define({combine:n=>n.length?n[0]:void 0,static:!0}),Kd=G.define(),e0=G.define(),t0=G.define(),i0=G.define({combine:n=>n.length?n[0]:!1});class Mi{constructor(e,t){this.type=e,this.value=t}static define(){return new vb}}class vb{of(e){return new Mi(this,e)}}class Qb{constructor(e){this.map=e}of(e){return new K(this,e)}}class K{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new K(this.type,t)}is(e){return this.type==e}static define(e={}){return new Qb(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(t);s&&i.push(s)}return i}}K.reconfigure=K.define();K.appendConfig=K.define();class Ee{constructor(e,t,i,r,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Fd(i,t.newLength),s.some(l=>l.type==Ee.time)||(this.annotations=s.concat(Ee.time.of(Date.now())))}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Ee.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Ee.time=Mi.define();Ee.userEvent=Mi.define();Ee.addToHistory=Mi.define();Ee.remote=Mi.define();function Tb(n,e){let t=[];for(let i=0,r=0;;){let s,o;if(i<n.length&&(r==e.length||e[r]>=n[i]))s=n[i++],o=n[i++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function n0(n,e,t){var i;let r,s,o;return t?(r=e.changes,s=Ie.empty(e.changes.length),o=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=n.selection)===null||i===void 0?void 0:i.map(r),effects:K.mapEffects(n.effects,r).concat(K.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function ha(n,e,t){let i=e.selection,r=kn(e.annotations);return e.userEvent&&(r=r.concat(Ee.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ie?e.changes:Ie.of(e.changes||[],t,n.facet(Jd)),selection:i&&(i instanceof P?i:P.single(i.anchor,i.head)),effects:kn(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function r0(n,e,t){let i=ha(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=n0(i,ha(n,e[s],o?i.changes.newLength:n.doc.length),o)}let r=new Ee(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return Ab(t?Pb(r):r)}function Pb(n){let e=n.startState,t=!0;for(let r of e.facet(Kd)){let s=r(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:Tb(t,s))}if(t!==!0){let r,s;if(t===!1)s=n.changes.invertedDesc,r=Ie.empty(e.doc.length);else{let o=n.changes.filter(t);r=o.changes,s=o.filtered.invertedDesc}n=new Ee(e,r,n.selection&&n.selection.map(s),K.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let i=e.facet(e0);for(let r=i.length-1;r>=0;r--){let s=i[r](n);s instanceof Ee?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Ee?n=s[0]:n=r0(e,kn(s),!1)}return n}function Ab(n){let e=n.startState,t=e.facet(t0),i=n;for(let r=t.length-1;r>=0;r--){let s=t[r](n);s&&Object.keys(s).length&&(i=n0(n,ha(e,s,n.changes.newLength),!0))}return i==n?n:new Ee(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const Rb=[];function kn(n){return n==null?Rb:Array.isArray(n)?n:[n]}var Ye=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(Ye||(Ye={}));const Cb=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ca;try{ca=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Ib(n){if(ca)return ca.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Cb.test(t)))return!0}return!1}function Eb(n){return e=>{if(!/\S/.test(e))return Ye.Space;if(Ib(e))return Ye.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return Ye.Word;return Ye.Other}}class le{constructor(e,t,i,r,s,o){this.config=e,this.doc=t,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)ur(this,l<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return ur(this,i),Zs(this,i)}update(...e){return r0(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:r}=t;for(let o of e.effects)o.is(Ro.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,a)=>r.set(a,l)),t=null),r.set(o.value.compartment,o.value.extension)):o.is(K.reconfigure)?(t=null,i=o.value):o.is(K.appendConfig)&&(t=null,i=kn(i).concat(o.value));let s;t?s=e.startState.values.slice():(t=Xs.resolve(i,r,this),s=new le(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,a)=>a.reconfigure(l,this),null).values),new le(t,e.newDoc,e.newSelection,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:P.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),r=this.changes(i.changes),s=[i.range],o=kn(i.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),h=this.changes(a.changes),c=h.map(r);for(let u=0;u<l;u++)s[u]=s[u].map(c);let f=r.mapDesc(h,!0);s.push(a.range.map(f)),r=r.compose(c),o=K.mapEffects(o,c).concat(K.mapEffects(kn(a.effects),f))}return{changes:r,selection:P.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ie?e:Ie.of(e,this.doc.length,this.facet(le.lineSeparator))}toText(e){return ae.of(e.split(this.facet(le.lineSeparator)||ra))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(ur(this,t),Zs(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof Ce&&(t[i]=r.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i)for(let s in i){let o=i[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}return le.create({doc:e.doc,selection:P.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Xs.resolve(e.extensions||[],new Map),i=e.doc instanceof ae?e.doc:ae.of((e.doc||"").split(t.staticFacet(le.lineSeparator)||ra)),r=e.selection?e.selection instanceof P?e.selection:P.single(e.selection.anchor,e.selection.head):P.single(0);return Fd(r,i.length),t.staticFacet(Hd)||(r=r.asSingle()),new le(t,i,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(le.tabSize)}get lineBreak(){return this.facet(le.lineSeparator)||`
`}get readOnly(){return this.facet(i0)}phrase(e){for(let t of this.facet(le.phrases))if(Object.prototype.hasOwnProperty.call(t,e))return t[e];return e}languageDataAt(e,t,i=-1){let r=[];for(let s of this.facet(Yd))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return Eb(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,l=e-i;for(;o>0;){let a=ft(t,o,!1);if(s(t.slice(a,o))!=Ye.Word)break;o=a}for(;l<r;){let a=ft(t,l);if(s(t.slice(l,a))!=Ye.Word)break;l=a}return o==l?null:P.range(o+i,l+i)}}le.allowMultipleSelections=Hd;le.tabSize=G.define({combine:n=>n.length?n[0]:4});le.lineSeparator=Jd;le.readOnly=i0;le.phrases=G.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(r=>n[r]==e[r])}});le.languageData=Yd;le.changeFilter=Kd;le.transactionFilter=e0;le.transactionExtender=t0;Ro.reconfigure=K.define();function hi(n,e,t={}){let i={};for(let r of n)for(let s of Object.keys(r)){let o=r[s],l=i[s];if(l===void 0)i[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class Hi{eq(e){return this==e}range(e,t=e){return new fa(e,t,this)}}Hi.prototype.startSide=Hi.prototype.endSide=0;Hi.prototype.point=!1;Hi.prototype.mapMode=_e.TrackDel;class fa{constructor(e,t,i){this.from=e,this.to=t,this.value=i}}function ua(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Sh{constructor(e,t,i,r){this.from=e,this.to=t,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,r=0){let s=i?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,h=s[a]-e||(i?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return h>=0?o:l;h>=0?l=a:o=a+1}}between(e,t,i,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let h=this.value[a],c=this.from[a]+e,f=this.to[a]+e,u,d;if(c==f){let p=t.mapPos(c,h.startSide,h.mapMode);if(p==null||(u=d=p,h.startSide!=h.endSide&&(d=t.mapPos(c,h.endSide),d<u)))continue}else if(u=t.mapPos(c,h.startSide),d=t.mapPos(f,h.endSide),u>d||u==d&&h.startSide>0&&h.endSide<=0)continue;(d-u||h.endSide-h.startSide)<0||(o<0&&(o=u),h.point&&(l=Math.max(l,d-u)),i.push(h),r.push(u-o),s.push(d-o))}return{mapped:i.length?new Sh(r,s,i,l):null,pos:o}}}class he{constructor(e,t,i=he.empty,r){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=r}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(ua)),this.isEmpty)return t.length?he.of(t):this;let l=new s0(this,null,-1).goto(0),a=0,h=[],c=new Ai;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let f=t[a++];c.addInner(f.from,f.to,f.value)||h.push(f)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||h.push(new fa(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?he.empty:this.nextLayer.update({add:h,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],h=e.touchesRange(l,l+a.length);if(h===!1)r=Math.max(r,a.maxPoint),t.push(a),i.push(e.mapPos(l));else if(h===!0){let{mapped:c,pos:f}=a.map(l,e);c&&(r=Math.max(r,c.maxPoint),t.push(c),i.push(f))}}let s=this.nextLayer.map(e);return t.length==0?s:new he(i,t,s,r)}between(e,t,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return $r.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return $r.from(e).goto(t)}static compare(e,t,i,r,s=-1){let o=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),l=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),a=Bc(o,l,i),h=new er(o,a,s),c=new er(l,a,s);i.iterGaps((f,u,d)=>Lc(h,f,c,u,d,r)),i.empty&&i.length==0&&Lc(h,0,c,0,0,r)}static eq(e,t,i=0,r){r==null&&(r=1e9);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Bc(s,o),a=new er(s,l,0).goto(i),h=new er(o,l,0).goto(i);for(;;){if(a.to!=h.to||!da(a.active,h.active)||a.point&&(!h.point||!a.point.eq(h.point)))return!1;if(a.to>r)return!0;a.next(),h.next()}}static spans(e,t,i,r,s=-1){let o=new er(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let h=Math.min(o.to,i);if(o.point?(r.point(l,h,o.point,o.activeForPoint(o.to),a,o.pointRank),a=o.openEnd(h)+(o.to>h?1:0)):h>l&&(r.span(l,h,o.active,a),a=o.openEnd(h)),o.to>i)break;l=o.to,o.next()}return a}static of(e,t=!1){let i=new Ai;for(let r of e instanceof fa?[e]:t?Wb(e):e)i.add(r.from,r.to,r.value);return i.finish()}}he.empty=new he([],[],null,-1);function Wb(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(ua(e,i)>0)return n.slice().sort(ua);e=i}return n}he.empty.nextLayer=he.empty;class Ai{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Sh(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new Ai)).add(e,t,i)}addInner(e,t,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(he.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=new he(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Bc(n,e,t){let i=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=i.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class s0{constructor(e,t,i,r=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class $r{constructor(e){this.heap=e}static from(e,t=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new s0(o,t,i,s));return r.length==1?r[0]:new $r(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)sl(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)sl(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),sl(this.heap,0)}}}function sl(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let r=n[i];if(i+1<n.length&&r.compare(n[i+1])>=0&&(r=n[i+1],i++),t.compare(r)<0)break;n[i]=t,n[e]=r,e=i}}class er{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=$r.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ns(this.active,e),ns(this.activeTo,e),ns(this.activeRank,e),this.minActive=zc(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=s;)t++;rs(this.active,t,i),rs(this.activeTo,t,r),rs(this.activeRank,t,s),e&&rs(e,t,this.cursor.from),this.minActive=zc(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,r=0;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&ns(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.from<e&&(r=1),this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){let s=0;for(;s<i.length&&i[s]<e;)s++;this.openStart=s+r}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function Lc(n,e,t,i,r,s){n.goto(e),t.goto(i);let o=i+r,l=i,a=i-e;for(;;){let h=n.to+a-t.to||n.endSide-t.endSide,c=h<0?n.to+a:t.to,f=Math.min(c,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&da(n.activeForPoint(n.to+a),t.activeForPoint(t.to))||s.comparePoint(l,f,n.point,t.point):f>l&&!da(n.active,t.active)&&s.compareRange(l,f,n.active,t.active),c>o)break;l=c,h<=0&&n.next(),h>=0&&t.next()}}function da(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function ns(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function rs(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function zc(n,e){let t=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||n[r].endSide-n[t].endSide)<0&&(t=r,i=e[r]);return t}function zr(n,e,t=n.length){let i=0;for(let r=0;r<t;)n.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=ft(n,r));return i}function pa(n,e,t,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==n.length)break;s+=n.charCodeAt(r)==9?t-s%t:1,r=ft(n,r)}return i===!0?-1:n.length}const ga="\u037C",_c=typeof Symbol=="undefined"?"__"+ga:Symbol.for(ga),ma=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Uc=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class Ri{constructor(e,t){this.rules=[];let{finish:i}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,h){let c=[],f=/^@(\w+)\b/.exec(o[0]),u=f&&f[1]=="keyframes";if(f&&l==null)return a.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))s(d.split(/,\s*/).map(g=>o.map(x=>g.replace(/&/,x))).reduce((g,x)=>g.concat(x)),p,a);else if(p&&typeof p=="object"){if(!f)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(r(d),p,c,u)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+p+";")}(c.length||u)&&a.push((i&&!f&&!h?o.map(i):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Uc[_c]||1;return Uc[_c]=e+1,ga+e.toString(36)}static mount(e,t){(e[ma]||new Db(e)).mount(Array.isArray(t)?t:[t])}}let ss=null;class Db{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet!="undefined"){if(ss)return e.adoptedStyleSheets=[ss.sheet].concat(e.adoptedStyleSheets),e[ma]=ss;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),ss=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[ma]=this}mount(e){let t=this.sheet,i=0,r=0;for(let s=0;s<e.length;s++){let o=e[s],l=this.modules.indexOf(o);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,o),t)for(let a=0;a<o.rules.length;a++)t.insertRule(o.rules[a],i++)}else{for(;r<l;)i+=this.modules[r++].rules.length;i+=o.rules.length,r++}}if(!t){let s="";for(let o=0;o<this.modules.length;o++)s+=this.modules[o].getRules()+`
`;this.styleTag.textContent=s}}}var Ci={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},js={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Nc=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent),Mb=typeof navigator!="undefined"&&/Apple Computer/.test(navigator.vendor),Bb=typeof navigator!="undefined"&&/Gecko\/\d+/.test(navigator.userAgent),Xc=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Lb=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),zb=Nc&&(Xc||+Nc[1]<57)||Bb&&Xc;for(var Le=0;Le<10;Le++)Ci[48+Le]=Ci[96+Le]=String(Le);for(var Le=1;Le<=24;Le++)Ci[Le+111]="F"+Le;for(var Le=65;Le<=90;Le++)Ci[Le]=String.fromCharCode(Le+32),js[Le]=String.fromCharCode(Le);for(var ol in Ci)js.hasOwnProperty(ol)||(js[ol]=Ci[ol]);function _b(n){var e=zb&&(n.ctrlKey||n.altKey||n.metaKey)||(Mb||Lb)&&n.shiftKey&&n.key&&n.key.length==1,t=!e&&n.key||(n.shiftKey?js:Ci)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Gs(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Rn(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Ub(){let n=document.activeElement;for(;n&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function Oa(n,e){if(!e.anchorNode)return!1;try{return Rn(n,e.anchorNode)}catch{return!1}}function vr(n){return n.nodeType==3?Qr(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function qs(n,e,t,i){return t?Zc(n,e,t,i,-1)||Zc(n,e,t,i,1):!1}function xa(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Zc(n,e,t,i,r){for(;;){if(n==t&&e==i)return!0;if(e==(r<0?0:Fs(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=xa(n)+(r<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=r<0?Fs(n):0}else return!1}}function Fs(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const o0={left:0,right:0,top:0,bottom:0};function Co(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Nb(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function Xb(n,e,t,i,r,s,o,l){let a=n.ownerDocument,h=a.defaultView;for(let c=n;c;)if(c.nodeType==1){let f,u=c==a.body;if(u)f=Nb(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let g=c.getBoundingClientRect();f={left:g.left,right:g.left+c.clientWidth,top:g.top,bottom:g.top+c.clientHeight}}let d=0,p=0;if(r=="nearest")e.top<f.top?(p=-(f.top-e.top+o),t>0&&e.bottom>f.bottom+p&&(p=e.bottom-f.bottom+p+o)):e.bottom>f.bottom&&(p=e.bottom-f.bottom+o,t<0&&e.top-p<f.top&&(p=-(f.top+p-e.top+o)));else{let g=e.bottom-e.top,x=f.bottom-f.top;p=(r=="center"&&g<=x?e.top+g/2-x/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-x+o)-f.top}if(i=="nearest"?e.left<f.left?(d=-(f.left-e.left+s),t>0&&e.right>f.right+d&&(d=e.right-f.right+d+s)):e.right>f.right&&(d=e.right-f.right+s,t<0&&e.left<f.left+d&&(d=-(f.left+d-e.left+s))):d=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==l?e.left-s:e.right-(f.right-f.left)+s)-f.left,d||p)if(u)h.scrollBy(d,p);else{if(p){let g=c.scrollTop;c.scrollTop+=p,p=c.scrollTop-g}if(d){let g=c.scrollLeft;c.scrollLeft+=d,d=c.scrollLeft-g}e={left:e.left-d,top:e.top-p,right:e.right-d,bottom:e.bottom-p}}if(u)break;c=c.assignedSlot||c.parentNode,i=r="nearest"}else if(c.nodeType==11)c=c.host;else break}class Zb{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=r}}let hn=null;function l0(n){if(n.setActive)return n.setActive();if(hn)return n.focus(hn);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(hn==null?{get preventScroll(){return hn={preventScroll:!0},!0}}:void 0),!hn){hn=!1;for(let t=0;t<e.length;){let i=e[t++],r=e[t++],s=e[t++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let jc;function Qr(n,e,t=e){let i=jc||(jc=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function dr(n,e,t){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0},r=new KeyboardEvent("keydown",i);r.synthetic=!0,n.dispatchEvent(r);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,n.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function jb(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function a0(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}class Ue{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new Ue(e.parentNode,xa(e),t)}static after(e,t){return new Ue(e.parentNode,xa(e)+1,t)}}const kh=[];class ke{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(this.dirty&2){let t=this.dom,i=null,r;for(let s of this.children){if(s.dirty){if(!s.dom&&(r=i?i.nextSibling:t.firstChild)){let o=ke.get(r);(!o||!o.parent&&o.constructor==s.constructor)&&s.reuseDOM(r)}s.sync(e),s.dirty=0}if(r=i?i.nextSibling:t.firstChild,e&&!e.written&&e.node==t&&r!=s.dom&&(e.written=!0),s.dom.parentNode==t)for(;r&&r!=s.dom;)r=Gc(r);else t.insertBefore(s.dom,r);i=s.dom}for(r=i?i.nextSibling:t.firstChild,r&&e&&e.node==t&&(e.written=!0);r;)r=Gc(r)}else if(this.dirty&1)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let r=Fs(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!ke.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,h=i,c=i;a<this.children.length;a++){let f=this.children[a],u=h+f.length;if(h<e&&u>t)return f.domBoundsAround(e,t,h);if(u>=e&&r==-1&&(r=a,s=h),h>t&&f.dom.parentNode==this.dom){o=a,l=c;break}c=u,h=u+f.breakAfter}return{from:s,to:l<0?i+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=kh){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&s.destroy()}this.children.splice(e,t-e,...i);for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new h0(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,i,r,s,o){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}}ke.prototype.breakAfter=0;function Gc(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class h0{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function c0(n,e,t,i,r,s,o,l,a){let{children:h}=n,c=h.length?h[e]:null,f=s.length?s[s.length-1]:null,u=f?f.breakAfter:o;if(!(e==i&&c&&!o&&!u&&s.length<2&&c.merge(t,r,s.length?f:null,t==0,l,a))){if(i<h.length){let d=h[i];d&&r<d.length?(e==i&&(d=d.split(r),r=0),!u&&f&&d.merge(0,r,f,!0,0,a)?s[s.length-1]=d:(r&&d.merge(0,r,null,!1,0,a),s.push(d))):d!=null&&d.breakAfter&&(f?f.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,l,0),e++));e<i&&s.length;)if(h[i-1].become(s[s.length-1]))i--,s.pop(),a=s.length?0:l;else if(h[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&i<h.length&&!h[e-1].breakAfter&&h[i].merge(0,0,h[e-1],!1,l,a)&&e--,(e<i||s.length)&&n.replaceChildren(e,i,s)}}function f0(n,e,t,i,r,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:h,off:c}=o.findPos(e,-1),f=e-t;for(let u of i)f+=u.length;n.length+=f,c0(n,h,c,l,a,i,0,r,s)}let at=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},ba=typeof document!="undefined"?document:{documentElement:{style:{}}};const ya=/Edge\/(\d+)/.exec(at.userAgent),u0=/MSIE \d/.test(at.userAgent),wa=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(at.userAgent),Io=!!(u0||wa||ya),qc=!Io&&/gecko\/(\d+)/i.test(at.userAgent),ll=!Io&&/Chrome\/(\d+)/.exec(at.userAgent),Fc="webkitFontSmoothing"in ba.documentElement.style,d0=!Io&&/Apple Computer/.test(at.vendor),Vc=d0&&(/Mobile\/\w+/.test(at.userAgent)||at.maxTouchPoints>2);var H={mac:Vc||/Mac/.test(at.platform),windows:/Win/.test(at.platform),linux:/Linux|X11/.test(at.platform),ie:Io,ie_version:u0?ba.documentMode||6:wa?+wa[1]:ya?+ya[1]:0,gecko:qc,gecko_version:qc?+(/Firefox\/(\d+)/.exec(at.userAgent)||[0,0])[1]:0,chrome:!!ll,chrome_version:ll?+ll[1]:0,ios:Vc,android:/Android\b/.test(at.userAgent),webkit:Fc,safari:d0,webkit_version:Fc?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:ba.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Gb=256;class Ii extends ke{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return i&&(!(i instanceof Ii)||this.length-(t-e)+i.length>Gb)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Ii(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Ue(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Sa(this.dom,e,t)}}class jt extends ke{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let r of t)r.setParent(this)}setAttrs(e){if(a0(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,i,r,s,o){return i&&(!(i instanceof jt&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(f0(this,e,t,i?i.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,r=-1,s=0;for(let l of this.children){let a=i+l.length;a>e&&t.push(i<e?l.split(e-i):l),r<0&&i>=e&&(r=s),i=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new jt(this.mark,t,o)}domAtPos(e){return m0(this.dom,this.children,e)}coordsAt(e,t){return x0(this,e,t)}}function Sa(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?H.chrome||H.gecko||(e?(r--,o=1):(s++,o=-1)):t<0?r--:s++;let l=Qr(n,r,s).getClientRects();if(!l.length)return o0;let a=l[(o?o<0:t>=0)?0:l.length-1];return H.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,h=>h.width)||a),o?Co(a,o<0):a||null}class wi extends ke{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}static create(e,t,i){return new(e.customView||wi)(e,t,i)}split(e){let t=wi.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,r,s,o){return i&&(!(i instanceof wi)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof wi&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return ae.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,i=t&&t.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):ae.empty}domAtPos(e){return e==0?Ue.before(this.dom):Ue.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),r=null;if(!i.length)return o0;for(let s=e>0?i.length-1:0;r=i[s],!(e>0?s==0:s==i.length-1||r.top<r.bottom);s+=e>0?-1:1);return e==0&&t>0||e==this.length&&t<=0?r:Co(r,e==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class p0 extends wi{domAtPos(e){let{topView:t,text:i}=this.widget;return t?ka(e,0,t,i,(r,s)=>r.domAtPos(s),r=>new Ue(i,Math.min(r,i.nodeValue.length))):new Ue(i,Math.min(e,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:i,text:r}=this.widget;return i?g0(e,t,i,r):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:i,text:r}=this.widget;return i?ka(e,t,i,r,(s,o,l)=>s.coordsAt(o,l),(s,o)=>Sa(r,s,o)):Sa(r,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}}function ka(n,e,t,i,r,s){if(t instanceof jt){for(let o of t.children){let l=Rn(o.dom,i),a=l?i.nodeValue.length:o.length;if(n<a||n==a&&o.getSide()<=0)return l?ka(n,e,o,i,r,s):r(o,n,e);n-=a}return r(t,t.length,-1)}else return t.dom==i?s(n,e):r(t,n,e)}function g0(n,e,t,i){if(t instanceof jt)for(let r of t.children){let s=0,o=Rn(r.dom,i);if(Rn(r.dom,n))return s+(o?g0(n,e,r,i):r.localPosFromDOM(n,e));s+=o?i.nodeValue.length:r.length}else if(t.dom==i)return Math.min(e,i.nodeValue.length);return t.localPosFromDOM(n,e)}class Cn extends ke{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Cn&&e.side==this.side}split(){return new Cn(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return Ue.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),i=qb(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return ae.empty}}Ii.prototype.children=wi.prototype.children=Cn.prototype.children=kh;function qb(n,e){let t=n.parent,i=t?t.children.indexOf(n):-1;for(;t&&i>=0;)if(e<0?i>0:i<t.children.length){let r=t.children[i+e];if(r instanceof Ii){let s=r.coordsAt(e<0?r.length:0,e);if(s)return s}i+=e}else if(t instanceof jt&&t.parent)i=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let r=t.dom.lastChild;if(r&&r.nodeName=="BR")return r.getClientRects()[0];break}}function m0(n,e,t){let i=0;for(let r=0;i<e.length;i++){let s=e[i],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(t>r&&t<o&&s.dom.parentNode==n)return s.domAtPos(t-r);if(t<=r)break;r=o}}for(;i>0;i--){let r=e[i-1].dom;if(r.parentNode==n)return Ue.after(r)}return new Ue(n,0)}function O0(n,e,t){let i,{children:r}=n;t>0&&e instanceof jt&&r.length&&(i=r[r.length-1])instanceof jt&&i.mark.eq(e.mark)?O0(i,e.children[0],t-1):(r.push(e),e.setParent(n)),n.length+=e.length}function x0(n,e,t){for(let s=0,o=0;o<n.children.length;o++){let l=n.children[o],a=s+l.length,h;if((t<=0||a==n.length||l.getSide()>0?a>=e:a>e)&&(e<a||o+1==n.children.length||(h=n.children[o+1]).length||h.getSide()>0)){let c=0;if(a==s){if(l.getSide()<=0)continue;c=t=-l.getSide()}let f=l.coordsAt(Math.max(0,e-s),t);return c&&f?Co(f,t<0):f}s=a}let i=n.dom.lastChild;if(!i)return n.dom.getBoundingClientRect();let r=vr(i);return r[r.length-1]||null}function $a(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}function $h(n,e){if(n==e)return!0;if(!n||!e)return!1;let t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r of t)if(i.indexOf(r)==-1||n[r]!==e[r])return!1;return!0}function va(n,e,t){let i=null;if(e)for(let r in e)t&&r in t||n.removeAttribute(i=r);if(t)for(let r in t)e&&e[r]==t[r]||n.setAttribute(i=r,t[r]);return!!i}class At{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var fe=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(fe||(fe={}));class j extends Hi{constructor(e,t,i,r){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Eo(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new Ji(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=b0(e,t);i=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new Ji(e,i,r,t,e.widget||null,!0)}static line(e){return new _r(e)}static set(e,t=!1){return he.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}j.none=he.empty;class Eo extends j{constructor(e){let{start:t,end:i}=b0(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof Eo&&this.tagName==e.tagName&&this.class==e.class&&$h(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Eo.prototype.point=!1;class _r extends j{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof _r&&$h(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}_r.prototype.mapMode=_e.TrackBefore;_r.prototype.point=!0;class Ji extends j{constructor(e,t,i,r,s,o){super(t,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?_e.TrackBefore:_e.TrackAfter:_e.TrackDel}get type(){return this.startSide<this.endSide?fe.WidgetRange:this.startSide<=0?fe.WidgetBefore:fe.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Ji&&Fb(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Ji.prototype.point=!0;function b0(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t!=null?t:e,end:i!=null?i:e}}function Fb(n,e){return n==e||!!(n&&e&&n.compare(e))}function Qa(n,e,t,i=0){let r=t.length-1;r>=0&&t[r]+i>=n?t[r]=Math.max(t[r],e):t.push(n,e)}class He extends ke{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,r,s,o){if(i){if(!(i instanceof He))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),f0(this,e,t,i?i.children:[],s,o),!0}split(e){let t=new He;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:r}=this.childPos(e);r&&(t.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){$h(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){O0(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=$a(t,this.attrs||{})),i&&(this.attrs=$a({class:i},this.attrs||{}))}domAtPos(e){return m0(this.dom,this.children,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?this.dirty&4&&(a0(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(va(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let i=this.dom.lastChild;for(;i&&ke.get(i)instanceof jt;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((t=ke.get(i))===null||t===void 0?void 0:t.isEditable)==!1&&(!H.ios||!this.children.some(r=>r instanceof Ii))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof Ii))return null;let i=vr(t.dom);if(i.length!=1)return null;e+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return x0(this,e,t)}become(e){return!1}get type(){return fe.Text}static find(e,t){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=t){if(s instanceof He)return s;if(o>t)break}r=o+s.breakAfter}return null}}class Vi extends ke{constructor(e,t,i){super(),this.widget=e,this.length=t,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,r,s,o){return i&&(!(i instanceof Vi)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Ue.before(this.dom):Ue.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new Vi(this.widget,t,this.type);return i.breakAfter=this.breakAfter,i}get children(){return kh}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ae.empty}domBoundsAround(){return null}become(e){return e instanceof Vi&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class vh{constructor(e,t,i,r){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof Vi&&e.type==fe.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new He),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(os(new Cn(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,i)),this.getLine().append(os(new Ii(this.text.slice(this.textOff,this.textOff+r)),t),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,t,i,r){this.buildText(t-e,i,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof Ji){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(i instanceof Ji)if(i.block){let{type:a}=i;a==fe.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Vi(i.widget||new Yc("div"),l,a))}else{let a=wi.create(i.widget||new Yc("span"),l,i.startSide),h=this.atCursorPos&&!a.isEditable&&s<=r.length&&(e<t||i.startSide>0),c=!a.isEditable&&(e<t||i.startSide<=0),f=this.getLine();this.pendingBuffer==2&&!h&&(this.pendingBuffer=0),this.flushBuffer(r),h&&(f.append(os(new Cn(1),r),s),s=r.length+Math.max(0,s-r.length)),f.append(os(a,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,i,r,s){let o=new vh(e,t,i,s);return o.openEnd=he.spans(r,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function os(n,e){for(let t of e)n=new jt(t,[n],n.length);return n}class Yc extends At{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const y0=G.define(),w0=G.define(),S0=G.define(),k0=G.define(),Ta=G.define(),$0=G.define(),v0=G.define({combine:n=>n.some(e=>e)});class Vs{constructor(e,t="nearest",i="nearest",r=5,s=5){this.range=e,this.y=t,this.x=i,this.yMargin=r,this.xMargin=s}map(e){return e.empty?this:new Vs(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const Hc=K.define({map:(n,e)=>n.map(e)});function dt(n,e,t){let i=n.facet(k0);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Ur=G.define({combine:n=>n.length?n[0]:!0});let Vb=0;const or=G.define();class Pe{constructor(e,t,i,r){this.id=e,this.create=t,this.domEventHandlers=i,this.extension=r(this)}static define(e,t){const{eventHandlers:i,provide:r,decorations:s}=t||{};return new Pe(Vb++,e,i,o=>{let l=[or.of(o)];return s&&l.push(Tr.of(a=>{let h=a.plugin(o);return h?s(h):j.none})),r&&l.push(r(o)),l})}static fromClass(e,t){return Pe.define(i=>new e(i),t)}}class al{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(dt(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){dt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){dt(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Q0=G.define(),T0=G.define(),Tr=G.define(),P0=G.define(),A0=G.define(),lr=G.define();class ii{constructor(e,t,i,r){this.fromA=e,this.toA=t,this.fromB=i,this.toB=r}join(e){return new ii(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let r=0,s=0,o=0,l=0;;r++){let a=r==e.length?null:e[r],h=o-l,c=a?a.fromB:1e9;for(;s<t.length&&t[s]<c;){let f=t[s],u=t[s+1],d=Math.max(l,f),p=Math.min(c,u);if(d<=p&&new ii(d+h,p+h,d,p).addToSet(i),u>c)break;s+=2}if(!a)return i;new ii(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),o=a.toA,l=a.toB}}}class Ys{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Ie.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let r=[];this.changes.iterChangedRanges((o,l,a,h)=>r.push(new ii(o,l,a,h))),this.changedRanges=r;let s=e.hasFocus;s!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=s,this.flags|=1)}static create(e,t,i){return new Ys(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var ye=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(ye||(ye={}));const Pa=ye.LTR,Yb=ye.RTL;function R0(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const Hb=R0("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Jb=R0("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Aa=Object.create(null),Rt=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Aa[e]=t,Aa[t]=-e}function Kb(n){return n<=247?Hb[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?Jb[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203||n==8204?256:1}const ey=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class $n{constructor(e,t,i){this.from=e,this.to=t,this.level=i}get dir(){return this.level%2?Yb:Pa}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,r){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==i)return o;(s<0||(r!=0?r<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}const be=[];function ty(n,e){let t=n.length,i=e==Pa?1:2,r=e==Pa?2:1;if(!n||i==1&&!ey.test(n))return C0(t);for(let o=0,l=i,a=i;o<t;o++){let h=Kb(n.charCodeAt(o));h==512?h=l:h==8&&a==4&&(h=16),be[o]=h==4?2:h,h&7&&(a=h),l=h}for(let o=0,l=i,a=i;o<t;o++){let h=be[o];if(h==128)o<t-1&&l==be[o+1]&&l&24?h=be[o]=l:be[o]=256;else if(h==64){let c=o+1;for(;c<t&&be[c]==64;)c++;let f=o&&l==8||c<t&&be[c]==8?a==1?1:8:256;for(let u=o;u<c;u++)be[u]=f;o=c-1}else h==8&&a==1&&(be[o]=1);l=h,h&7&&(a=h)}for(let o=0,l=0,a=0,h,c,f;o<t;o++)if(c=Aa[h=n.charCodeAt(o)])if(c<0){for(let u=l-3;u>=0;u-=3)if(Rt[u+1]==-c){let d=Rt[u+2],p=d&2?i:d&4?d&1?r:i:0;p&&(be[o]=be[Rt[u]]=p),l=u;break}}else{if(Rt.length==189)break;Rt[l++]=o,Rt[l++]=h,Rt[l++]=a}else if((f=be[o])==2||f==1){let u=f==i;a=u?0:1;for(let d=l-3;d>=0;d-=3){let p=Rt[d+2];if(p&2)break;if(u)Rt[d+2]|=2;else{if(p&4)break;Rt[d+2]|=4}}}for(let o=0;o<t;o++)if(be[o]==256){let l=o+1;for(;l<t&&be[l]==256;)l++;let a=(o?be[o-1]:i)==1,h=(l<t?be[l]:i)==1,c=a==h?a?1:2:i;for(let f=o;f<l;f++)be[f]=c;o=l-1}let s=[];if(i==1)for(let o=0;o<t;){let l=o,a=be[o++]!=1;for(;o<t&&a==(be[o]!=1);)o++;if(a)for(let h=o;h>l;){let c=h,f=be[--h]!=2;for(;h>l&&f==(be[h-1]!=2);)h--;s.push(new $n(h,c,f?2:1))}else s.push(new $n(l,o,0))}else for(let o=0;o<t;){let l=o,a=be[o++]==2;for(;o<t&&a==(be[o]==2);)o++;s.push(new $n(l,o,a?1:2))}return s}function C0(n){return[new $n(0,n,0)]}let I0="";function iy(n,e,t,i,r){var s;let o=i.head-n.from,l=-1;if(o==0){if(!r||!n.length)return null;e[0].level!=t&&(o=e[0].side(!1,t),l=0)}else if(o==n.length){if(r)return null;let u=e[e.length-1];u.level!=t&&(o=u.side(!0,t),l=e.length-1)}l<0&&(l=$n.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc));let a=e[l];o==a.side(r,t)&&(a=e[l+=r?1:-1],o=a.side(!r,t));let h=r==(a.dir==t),c=ft(n.text,o,h);if(I0=n.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,t))return P.cursor(c+n.from,h?-1:1,a.level);let f=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return!f&&a.level!=t?P.cursor(r?n.to:n.from,r?-1:1,t):f&&f.level<a.level?P.cursor(f.side(!r,t)+n.from,r?1:-1,f.level):P.cursor(c+n.from,r?-1:1,a.level)}const Si="\uFFFF";class E0{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(le.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Si}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r),this.readNode(r);let s=r.nextSibling;if(s==t)break;let o=ke.get(r),l=ke.get(s);(o&&l?o.breakAfter:(o?o.breakAfter:Jc(r))||Jc(s)&&(r.nodeName!="BR"||r.cmIgnore))&&this.lineBreak(),r=s}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=r.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let t=ke.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+Math.min(t,i.offset))}}function Jc(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class Kc{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class ef extends ke{constructor(e){super(),this.view=e,this.compositionDeco=j.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new He],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ii(0,0,0,e.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:o,toA:l})=>l<this.minWidthFrom||o>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=j.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=ry(this.view,e.changes)),(H.ie||H.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,r=this.updateDeco(),s=ay(i,r,e.changes);return t=ii.extendWithRanges(t,s),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.minWidth=this.minWidth?this.minWidth+"px":"";let s=H.chrome||H.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(s),this.dirty=0,s&&(s.written||i.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""});let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof Vi&&s.widget instanceof tf&&r.push(s.dom);i.updateGaps(r)}updateChildren(e,t){let i=this.childCursor(t);for(let r=e.length-1;;r--){let s=r>=0?e[r]:null;if(!s)break;let{fromA:o,toA:l,fromB:a,toB:h}=s,{content:c,breakAtStart:f,openStart:u,openEnd:d}=vh.build(this.view.state.doc,a,h,this.decorations,this.dynamicDecorationMap),{i:p,off:g}=i.findPos(l,1),{i:x,off:Q}=i.findPos(o,-1);c0(this,x,Q,p,g,c,f,u,d)}}updateSelection(e=!1,t=!1){if(e&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection())||H.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,s=this.domAtPos(r.anchor),o=r.empty?s:this.domAtPos(r.head);if(H.gecko&&r.empty&&ny(s)){let a=document.createTextNode("");this.view.observer.ignore(()=>s.node.insertBefore(a,s.node.childNodes[s.offset]||null)),s=o=new Ue(a,0),i=!0}let l=this.view.observer.selectionRange;(i||!l.focusNode||!qs(s.node,s.offset,l.anchorNode,l.anchorOffset)||!qs(o.node,o.offset,l.focusNode,l.focusOffset))&&(this.view.observer.ignore(()=>{H.android&&H.chrome&&this.dom.contains(l.focusNode)&&hy(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let a=Gs(this.root);if(r.empty){if(H.gecko){let h=oy(s.node,s.offset);if(h&&h!=3){let c=D0(s.node,s.offset,h==1?1:-1);c&&(s=new Ue(c,h==1?0:c.nodeValue.length))}}a.collapse(s.node,s.offset),r.bidiLevel!=null&&l.cursorBidiLevel!=null&&(l.cursorBidiLevel=r.bidiLevel)}else if(a.extend)a.collapse(s.node,s.offset),a.extend(o.node,o.offset);else{let h=document.createRange();r.anchor>r.head&&([s,o]=[o,s]),h.setEnd(o.node,o.offset),h.setStart(s.node,s.offset),a.removeAllRanges(),a.addRange(h)}}),this.view.observer.setSelectionRange(s,o)),this.impreciseAnchor=s.precise?null:new Ue(l.anchorNode,l.anchorOffset),this.impreciseHead=o.precise?null:new Ue(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=Gs(this.root);if(!e.empty||!e.assoc||!t.modify)return;let i=He.find(this,e.head);if(!i)return;let r=i.posAtStart;if(e.head==r||e.head==r+i.length)return;let s=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(!s||!o||s.bottom>o.top)return;let l=this.domAtPos(e.head+e.assoc);t.collapse(l.node,l.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(Ur)?this.root.activeElement==this.dom:Oa(this.dom,this.view.observer.selectionRange)}nearest(e){for(let t=e;t;){let i=ke.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(i<r.length||r instanceof He)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,r=this.children.length-1;;r--){let s=this.children[r],o=i-s.breakAfter-s.length;if(e>o||e==o&&s.type!=fe.WidgetBefore&&s.type!=fe.WidgetAfter&&(!r||t==2||this.children[r-1].breakAfter||this.children[r-1].type==fe.WidgetBefore&&t>-2))return s.coordsAt(e-o,t);i=o}}measureVisibleLineHeights(e){let t=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==ye.LTR;for(let h=0,c=0;c<this.children.length;c++){let f=this.children[c],u=h+f.length;if(u>r)break;if(h>=i){let d=f.dom.getBoundingClientRect();if(t.push(d.height),o){let p=f.dom.lastChild,g=p?vr(p):[];if(g.length){let x=g[g.length-1],Q=a?x.right-d.left:d.right-x.left;Q>l&&(l=Q,this.minWidth=s,this.minWidthFrom=h,this.minWidthTo=u)}}}h=u+f.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?ye.RTL:ye.LTR}measureTextSize(){for(let r of this.children)if(r instanceof He){let s=r.measureTextSize();if(s)return s}let e=document.createElement("div"),t,i;return e.className="cm-line",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let r=vr(e.firstChild)[0];t=e.getBoundingClientRect().height,i=r?r.width/27:7,e.remove()}),{lineHeight:t,charWidth:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new h0(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>i){let l=t.lineBlockAt(o).bottom-t.lineBlockAt(i).top;e.push(j.replace({widget:new tf(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return j.set(e)}updateDeco(){let e=this.view.state.facet(Tr).map((t,i)=>(this.dynamicDecorationMap[i]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!i)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=0,o=0,l=0,a=0;for(let c of this.view.state.facet(A0).map(f=>f(this.view)))if(c){let{left:f,right:u,top:d,bottom:p}=c;f!=null&&(s=Math.max(s,f)),u!=null&&(o=Math.max(o,u)),d!=null&&(l=Math.max(l,d)),p!=null&&(a=Math.max(a,p))}let h={left:i.left-s,top:i.top-l,right:i.right+o,bottom:i.bottom+a};Xb(this.view.scrollDOM,h,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==ye.LTR)}}function ny(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class tf extends At{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function W0(n){let e=n.observer.selectionRange,t=e.focusNode&&D0(e.focusNode,e.focusOffset,0);if(!t)return null;let i=n.docView.nearest(t);if(!i)return null;if(i instanceof He){let r=t;for(;r.parentNode!=i.dom;)r=r.parentNode;let s=r.previousSibling;for(;s&&!ke.get(s);)s=s.previousSibling;let o=s?ke.get(s).posAtEnd:i.posAtStart;return{from:o,to:o,node:r,text:t}}else{for(;;){let{parent:s}=i;if(!s)return null;if(s instanceof He)break;i=s}let r=i.posAtStart;return{from:r,to:r+i.length,node:i.dom,text:t}}}function ry(n,e){let t=W0(n);if(!t)return j.none;let{from:i,to:r,node:s,text:o}=t,l=e.mapPos(i,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=n,c=s.nodeType==3?s.nodeValue:new E0([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),Si)==c)a=l+c.length;else if(h.doc.sliceString(Math.max(0,a-c.length),a,Si)==c)l=a-c.length;else return j.none;else if(h.doc.sliceString(l,a,Si)!=c)return j.none;let f=ke.get(s);return f instanceof p0?f=f.widget.topView:f&&(f.parent=null),j.set(j.replace({widget:new sy(s,o,f),inclusive:!0}).range(l,a))}class sy extends At{constructor(e,t,i){super(),this.top=e,this.text=t,this.topView=i}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return p0}}function D0(n,e,t){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0&&t<=0)n=n.childNodes[e-1],e=Fs(n);else if(n.nodeType==1&&e<n.childNodes.length&&t>=0)n=n.childNodes[e],e=0;else return null}}function oy(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class ly{constructor(){this.changes=[]}compareRange(e,t){Qa(e,t,this.changes)}comparePoint(e,t){Qa(e,t,this.changes)}}function ay(n,e,t){let i=new ly;return he.compare(n,e,t,i),i.changes}function hy(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function cy(n,e,t=1){let i=n.charCategorizer(e),r=n.doc.lineAt(e),s=e-r.from;if(r.length==0)return P.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=ft(r.text,s,!1):l=ft(r.text,s);let a=i(r.text.slice(o,l));for(;o>0;){let h=ft(r.text,o,!1);if(i(r.text.slice(h,o))!=a)break;o=h}for(;l<r.length;){let h=ft(r.text,l);if(i(r.text.slice(l,h))!=a)break;l=h}return P.range(o+r.from,l+r.from)}function fy(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function uy(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function hl(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function nf(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function rf(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function Ra(n,e,t){let i,r,s,o,l,a,h,c;for(let d=n.firstChild;d;d=d.nextSibling){let p=vr(d);for(let g=0;g<p.length;g++){let x=p[g];r&&hl(r,x)&&(x=nf(rf(x,r.bottom),r.top));let Q=fy(e,x),m=uy(t,x);if(Q==0&&m==0)return d.nodeType==3?sf(d,e,t):Ra(d,e,t);(!i||o>m||o==m&&s>Q)&&(i=d,r=x,s=Q,o=m),Q==0?t>x.bottom&&(!h||h.bottom<x.bottom)?(l=d,h=x):t<x.top&&(!c||c.top>x.top)&&(a=d,c=x):h&&hl(h,x)?h=rf(h,x.bottom):c&&hl(c,x)&&(c=nf(c,x.top))}}if(h&&h.bottom>=t?(i=l,r=h):c&&c.top<=t&&(i=a,r=c),!i)return{node:n,offset:0};let f=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return sf(i,f,t);if(!s&&i.contentEditable=="true")return Ra(i,f,t);let u=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:n,offset:u}}function sf(n,e,t){let i=n.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<i;l++){let a=Qr(n,l,l+1).getClientRects();for(let h=0;h<a.length;h++){let c=a[h];if(c.top==c.bottom)continue;o||(o=e-c.left);let f=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&f<s){let u=e>=(c.left+c.right)/2,d=u;if((H.chrome||H.gecko)&&Qr(n,l).getBoundingClientRect().left==c.right&&(d=!u),f<=0)return{node:n,offset:l+(d?1:0)};r=l+(d?1:0),s=f}}}return{node:n,offset:r>-1?r:o>0?n.nodeValue.length:0}}function M0(n,{x:e,y:t},i,r=-1){var s;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,a,{docHeight:h}=n.viewState,c=t-l;if(c<0)return 0;if(c>h)return n.state.doc.length;for(let Q=n.defaultLineHeight/2,m=!1;a=n.elementAtHeight(c),a.type!=fe.Text;)for(;c=r>0?a.bottom+Q:a.top-Q,!(c>=0&&c<=h);){if(m)return i?null:0;m=!0,r=-r}t=l+c;let f=a.from;if(f<n.viewport.from)return n.viewport.from==0?0:i?null:of(n,o,a,e,t);if(f>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:i?null:of(n,o,a,e,t);let u=n.dom.ownerDocument,d=n.root.elementFromPoint?n.root:u,p=d.elementFromPoint(e,t);p&&!n.contentDOM.contains(p)&&(p=null),p||(e=Math.max(o.left+1,Math.min(o.right-1,e)),p=d.elementFromPoint(e,t),p&&!n.contentDOM.contains(p)&&(p=null));let g,x=-1;if(p&&((s=n.docView.nearest(p))===null||s===void 0?void 0:s.isEditable)!=!1){if(u.caretPositionFromPoint){let Q=u.caretPositionFromPoint(e,t);Q&&({offsetNode:g,offset:x}=Q)}else if(u.caretRangeFromPoint){let Q=u.caretRangeFromPoint(e,t);Q&&({startContainer:g,startOffset:x}=Q,H.safari&&dy(g,x,e)&&(g=void 0))}}if(!g||!n.docView.dom.contains(g)){let Q=He.find(n.docView,f);if(!Q)return c>a.top+a.height/2?a.to:a.from;({node:g,offset:x}=Ra(Q.dom,e,t))}return n.docView.posFromDOM(g,x)}function of(n,e,t,i,r){let s=Math.round((i-e.left)*n.defaultCharacterWidth);n.lineWrapping&&t.height>n.defaultLineHeight*1.5&&(s+=Math.floor((r-t.top)/n.defaultLineHeight)*n.viewState.heightOracle.lineLength);let o=n.state.sliceDoc(t.from,t.to);return t.from+pa(o,s,n.state.tabSize)}function dy(n,e,t){let i;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(let r=n.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Qr(n,i-1,i).getBoundingClientRect().left>t}function py(n,e,t,i){let r=n.state.doc.lineAt(e.head),s=!i||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let a=n.dom.getBoundingClientRect(),h=n.textDirectionAt(r.from),c=n.posAtCoords({x:t==(h==ye.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(c!=null)return P.cursor(c,t?-1:1)}let o=He.find(n.docView,e.head),l=o?t?o.posAtEnd:o.posAtStart:t?r.to:r.from;return P.cursor(l,t?-1:1)}function lf(n,e,t,i){let r=n.state.doc.lineAt(e.head),s=n.bidiSpans(r),o=n.textDirectionAt(r.from);for(let l=e,a=null;;){let h=iy(r,s,o,l,t),c=I0;if(!h){if(r.number==(t?n.state.doc.lines:1))return l;c=`
`,r=n.state.doc.line(r.number+(t?1:-1)),s=n.bidiSpans(r),h=P.cursor(t?r.from:r.to)}if(a){if(!a(c))return l}else{if(!i)return h;a=i(c)}l=h}}function gy(n,e,t){let i=n.state.charCategorizer(e),r=i(t);return s=>{let o=i(s);return r==Ye.Space&&(r=o),r==o}}function my(n,e,t,i){let r=e.head,s=t?1:-1;if(r==(t?n.state.doc.length:0))return P.cursor(r,e.assoc);let o=e.goalColumn,l,a=n.contentDOM.getBoundingClientRect(),h=n.coordsAtPos(r),c=n.documentTop;if(h)o==null&&(o=h.left-a.left),l=s<0?h.top:h.bottom;else{let d=n.viewState.lineBlockAt(r);o==null&&(o=Math.min(a.right-a.left,n.defaultCharacterWidth*(r-d.from))),l=(s<0?d.top:d.bottom)+c}let f=a.left+o,u=i!=null?i:n.defaultLineHeight>>1;for(let d=0;;d+=10){let p=l+(u+d)*s,g=M0(n,{x:f,y:p},!1,s);if(p<a.top||p>a.bottom||(s<0?g<r:g>r))return P.cursor(g,e.assoc,void 0,o)}}function cl(n,e,t){let i=n.state.facet(P0).map(r=>r(n));for(;;){let r=!1;for(let s of i)s.between(t.from-1,t.from+1,(o,l,a)=>{t.from>o&&t.from<l&&(t=e.from>t.from?P.cursor(o,1):P.cursor(l,-1),r=!0)});if(!r)return t}}class Oy{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let t in We){let i=We[t];e.contentDOM.addEventListener(t,r=>{!af(e,r)||this.ignoreDuringComposition(r)||t=="keydown"&&this.keydown(e,r)||(this.mustFlushObserver(r)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,r)?r.preventDefault():i(e,r))}),this.registeredEvents.push(t)}this.notifiedFocused=e.hasFocus,H.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var i;let r;this.customHandlers=[];for(let s of t)if(r=(i=s.update(e).spec)===null||i===void 0?void 0:i.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:r});for(let o in r)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),e.contentDOM.addEventListener(o,l=>{!af(e,l)||this.runCustomHandlers(o,e,l)&&l.preventDefault()}))}}runCustomHandlers(e,t,i){for(let r of this.customHandlers){let s=r.handlers[e];if(s)try{if(s.call(r.plugin,i,t)||i.defaultPrevented)return!0}catch(o){dt(t.state,o)}}return!1}runScrollHandlers(e,t){for(let i of this.customHandlers){let r=i.handlers.scroll;if(r)try{r.call(i.plugin,t,e)}catch(s){dt(e.state,s)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(H.android&&H.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return H.ios&&(i=B0.find(r=>r.keyCode==t.keyCode))&&!(t.ctrlKey||t.altKey||t.metaKey)&&!t.synthetic?(this.pendingIOSKey=i,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,dr(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:H.safari&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229||e.type=="compositionend"&&!H.ios}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const B0=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],L0=[16,17,18,20,91,92,224,225];class xy{constructor(e,t,i,r){this.view=e,this.style=i,this.mustSelect=r,this.lastEvent=t;let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(le.allowMultipleSelections)&&by(e,t),this.dragMove=yy(e,t),this.dragging=wy(e,t)&&Qh(t)==1?null:!1,this.dragging===!1&&(t.preventDefault(),this.select(t))}move(e){if(e.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=e)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function by(n,e){let t=n.state.facet(y0);return t.length?t[0](e):H.mac?e.metaKey:e.ctrlKey}function yy(n,e){let t=n.state.facet(w0);return t.length?t[0](e):H.mac?!e.altKey:!e.ctrlKey}function wy(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=Gs(n.root);if(i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function af(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=ke.get(t))&&i.ignoreEvent(e))return!1;return!0}const We=Object.create(null),z0=H.ie&&H.ie_version<15||H.ios&&H.webkit_version<604;function Sy(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),_0(n,t.value)},50)}function _0(n,e){let{state:t}=n,i,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Ca!=null&&t.selection.ranges.every(a=>a.empty)&&Ca==s.toString()){let a=-1;i=t.changeByRange(h=>{let c=t.doc.lineAt(h.from);if(c.from==a)return{range:h};a=c.from;let f=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:f},range:P.cursor(h.from+f.length)}})}else o?i=t.changeByRange(a=>{let h=s.line(r++);return{changes:{from:a.from,to:a.to,insert:h.text},range:P.cursor(a.from+h.length)}}):i=t.replaceSelection(s);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}We.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():L0.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};let U0=0;We.touchstart=(n,e)=>{U0=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};We.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};We.mousedown=(n,e)=>{if(n.observer.flush(),U0>Date.now()-2e3&&Qh(e)==1)return;let t=null;for(let i of n.state.facet(S0))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=vy(n,e)),t){let i=n.root.activeElement!=n.contentDOM;i&&n.observer.ignore(()=>l0(n.contentDOM)),n.inputState.startMouseSelection(new xy(n,e,t,i))}};function hf(n,e,t,i){if(i==1)return P.cursor(e,t);if(i==2)return cy(n.state,e,t);{let r=He.find(n.docView,e),s=n.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,P.range(o,l)}}let N0=(n,e)=>n>=e.top&&n<=e.bottom,cf=(n,e,t)=>N0(e,t)&&n>=t.left&&n<=t.right;function ky(n,e,t,i){let r=He.find(n.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&cf(t,i,o))return-1;let l=r.coordsAt(s,1);return l&&cf(t,i,l)?1:o&&N0(i,o)?-1:1}function ff(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:ky(n,t,e.clientX,e.clientY)}}const $y=H.ie&&H.ie_version<=11;let uf=null,df=0,pf=0;function Qh(n){if(!$y)return n.detail;let e=uf,t=pf;return uf=n,pf=Date.now(),df=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(df+1)%3:1}function vy(n,e){let t=ff(n,e),i=Qh(e),r=n.state.selection,s=t,o=e;return{update(l){l.docChanged&&(t&&(t.pos=l.changes.mapPos(t.pos)),r=r.map(l.changes),o=null)},get(l,a,h){let c;if(o&&l.clientX==o.clientX&&l.clientY==o.clientY?c=s:(c=s=ff(n,l),o=l),!c||!t)return r;let f=hf(n,c.pos,c.bias,i);if(t.pos!=c.pos&&!a){let u=hf(n,t.pos,t.bias,i),d=Math.min(u.from,f.from),p=Math.max(u.to,f.to);f=d<f.from?P.range(d,p):P.range(p,d)}return a?r.replaceRange(r.main.extend(f.from,f.to)):h?r.addRange(f):P.create([f])}}}We.dragstart=(n,e)=>{let{selection:{main:t}}=n.state,{mouseSelection:i}=n.inputState;i&&(i.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function gf(n,e,t,i){if(!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=n.inputState,o=i&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}We.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let i=Array(t.length),r=0,s=()=>{++r==t.length&&gf(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),s()},l.readAsText(t[o])}}else gf(n,e,e.dataTransfer.getData("Text"),!0)};We.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let t=z0?null:e.clipboardData;t?(_0(n,t.getData("text/plain")),e.preventDefault()):Sy(n)};function Qy(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function Ty(n){let e=[],t=[],i=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),r=o.number}i=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:i}}let Ca=null;We.copy=We.cut=(n,e)=>{let{text:t,ranges:i,linewise:r}=Ty(n.state);if(!t&&!r)return;Ca=r?t:null;let s=z0?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",t)):Qy(n,t),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};function X0(n){setTimeout(()=>{n.hasFocus!=n.inputState.notifiedFocused&&n.update([])},10)}We.focus=X0;We.blur=n=>{n.observer.clearSelectionRange(),X0(n)};function Z0(n,e){if(n.docView.compositionDeco.size){n.inputState.rapidCompositionStart=e;try{n.update([])}finally{n.inputState.rapidCompositionStart=!1}}}We.compositionstart=We.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0,n.docView.compositionDeco.size&&(n.observer.flush(),Z0(n,!0)))};We.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionFirstChange=null,setTimeout(()=>{n.inputState.composing<0&&Z0(n,!1)},50)};We.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};We.beforeinput=(n,e)=>{var t;let i;if(H.chrome&&H.android&&(i=B0.find(r=>r.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const mf=["pre-wrap","normal","pre-line","break-spaces"];class Py{constructor(){this.doc=ae.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return mf.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,i,r,s){let o=mf.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=i,this.lineLength=r,l){this.heightSamples={};for(let a=0;a<s.length;a++){let h=s[a];h<0?a++:this.heightSamples[Math.floor(h*10)]=!0}}return l}}class Ay{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class ki{constructor(e,t,i,r,s){this.from=e,this.length=t,this.top=i,this.height=r,this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new ki(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var pe=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(pe||(pe={}));const As=.001;class rt{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>As&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return rt.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,r){let s=this;for(let o=r.length-1;o>=0;o--){let{fromA:l,toA:a,fromB:h,toB:c}=r[o],f=s.lineAt(l,pe.ByPosNoHeight,t,0,0),u=f.to>=a?f:s.lineAt(a,pe.ByPosNoHeight,t,0,0);for(c+=u.to-a,a=u.to;o>0&&f.from<=r[o-1].toA;)l=r[o-1].fromA,h=r[o-1].fromB,o--,l<f.from&&(f=s.lineAt(l,pe.ByPosNoHeight,t,0,0));h+=f.from-l,l=f.from;let d=Th.build(i,e,h,c);s=s.replace(l,a,d)}return s.updateHeight(i,0)}static empty(){return new lt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,r=0,s=0;for(;;)if(t==i)if(r>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),i+=1+l.break,r-=l.size}else if(s>r*2){let l=e[i];l.break?e.splice(i,1,l.left,null,l.right):e.splice(i,1,l.left,l.right),i+=2+l.break,s-=l.size}else break;else if(r<s){let l=e[t++];l&&(r+=l.size)}else{let l=e[--i];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new Ry(rt.of(e.slice(0,t)),o,rt.of(e.slice(i)))}}rt.prototype.size=1;class j0 extends rt{constructor(e,t,i){super(e,t),this.type=i}blockAt(e,t,i,r){return new ki(r,this.length,i,this.height,this.type)}lineAt(e,t,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,t,i,r,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class lt extends j0{constructor(e,t){super(e,t,fe.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,i){let r=i[0];return i.length==1&&(r instanceof lt||r instanceof Be&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Be?r=new lt(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):rt.of(i)}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Be extends rt{constructor(e){super(e,0)}lines(e,t){let i=e.lineAt(t).number,r=e.lineAt(t+this.length).number;return{firstLine:i,lastLine:r,lineHeight:this.height/(r-i+1)}}blockAt(e,t,i,r){let{firstLine:s,lastLine:o,lineHeight:l}=this.lines(t,r),a=Math.max(0,Math.min(o-s,Math.floor((e-i)/l))),{from:h,length:c}=t.line(s+a);return new ki(h,c,i+l*a,l,fe.Text)}lineAt(e,t,i,r,s){if(t==pe.ByHeight)return this.blockAt(e,i,r,s);if(t==pe.ByPosNoHeight){let{from:f,to:u}=i.lineAt(e);return new ki(f,u-f,0,0,fe.Text)}let{firstLine:o,lineHeight:l}=this.lines(i,s),{from:a,length:h,number:c}=i.lineAt(e);return new ki(a,h,r+l*(c-o),l,fe.Text)}forEachLine(e,t,i,r,s,o){let{firstLine:l,lineHeight:a}=this.lines(i,s);for(let h=Math.max(e,s),c=Math.min(s+this.length,t);h<=c;){let f=i.lineAt(h);h==e&&(r+=a*(f.number-l)),o(new ki(f.from,f.length,r,a,fe.Text)),r+=a,h=f.to+1}}replace(e,t,i){let r=this.length-t;if(r>0){let s=i[i.length-1];s instanceof Be?i[i.length-1]=new Be(s.length+r):i.push(null,new Be(r-1))}if(e>0){let s=i[0];s instanceof Be?i[0]=new Be(e+s.length):i.unshift(new Be(e-1),null)}return rt.of(i)}decomposeLeft(e,t){t.push(new Be(e-1),null)}decomposeRight(e,t){t.push(null,new Be(this.length-e-1))}updateHeight(e,t=0,i=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],l=Math.max(t,r.from),a=-1,h=e.heightChanged;for(r.from>t&&o.push(new Be(r.from-t-1).updateHeight(e,t));l<=s&&r.more;){let f=e.doc.lineAt(l).length;o.length&&o.push(null);let u=r.heights[r.index++];a==-1?a=u:Math.abs(u-a)>=As&&(a=-2);let d=new lt(f,u);d.outdated=!1,o.push(d),l+=f+1}l<=s&&o.push(null,new Be(s-l).updateHeight(e,l));let c=rt.of(o);return e.heightChanged=h||a<0||Math.abs(c.height-this.height)>=As||Math.abs(a-this.lines(e.doc,t).lineHeight)>=As,c}else(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Ry extends rt{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,i,r,s){let o=r+this.left.height,l=s+this.left.length+this.break,a=t==pe.ByHeight?e<o:e<l,h=a?this.left.lineAt(e,t,i,r,s):this.right.lineAt(e,t,i,o,l);if(this.break||(a?h.to<l:h.from>l))return h;let c=t==pe.ByPosNoHeight?pe.ByPosNoHeight:pe.ByPos;return a?h.join(this.right.lineAt(l,c,i,o,l)):this.left.lineAt(l,c,i,r,s).join(h)}forEachLine(e,t,i,r,s,o){let l=r+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,i,r,s,o),t>=a&&this.right.forEachLine(e,t,i,l,a,o);else{let h=this.lineAt(a,pe.ByPos,i,r,s);e<h.from&&this.left.forEachLine(e,h.from-1,i,r,s,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,i,l,a,o)}}replace(e,t,i){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of i)s.push(l);if(e>0&&Of(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),Of(s,l)}return rt.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?rt.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,r){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return r&&r.from<=t+s.length&&r.more?a=s=s.updateHeight(e,t,i,r):s.updateHeight(e,t,i),r&&r.from<=l+o.length&&r.more?a=o=o.updateHeight(e,l,i,r):o.updateHeight(e,l,i),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Of(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof Be&&(i=n[e+1])instanceof Be&&n.splice(e-1,3,new Be(t.length+1+i.length))}const Cy=5;class Th{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof lt?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new lt(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0;r<0&&(r=this.oracle.lineHeight);let s=t-e;i.block?this.addBlock(new j0(s,r,i.type)):(s||r>=Cy)&&this.addLineDeco(r,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new lt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Be(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof lt)return e;let t=new lt(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==fe.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=fe.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let i=this.ensureLine();i.length+=t,i.collapsed+=t,i.widgetHeight=Math.max(i.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof lt)&&!this.isCovered?this.nodes.push(new lt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof lt&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,t,i,r){let s=new Th(i,e);return he.spans(t,i,r,s,0),s.finish(i)}}function Iy(n,e,t){let i=new Ey;return he.compare(n,e,t,i,0),i.changes}class Ey{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,r){(e<t||i&&i.heightRelevant||r&&r.heightRelevant)&&Qa(e,t,this.changes,5)}}function Wy(n,e){let t=n.getBoundingClientRect(),i=Math.max(0,t.left),r=Math.min(innerWidth,t.right),s=Math.max(0,t.top),o=Math.min(innerHeight,t.bottom),l=n.ownerDocument.body;for(let a=n.parentNode;a&&a!=l;)if(a.nodeType==1){let h=a,c=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&c.overflow!="visible"){let f=h.getBoundingClientRect();i=Math.max(i,f.left),r=Math.min(r,f.right),s=Math.max(s,f.top),o=Math.min(o,f.bottom)}a=c.position=="absolute"||c.position=="fixed"?h.offsetParent:h.parentNode}else if(a.nodeType==11)a=a.host;else break;return{left:i-t.left,right:Math.max(i,r)-t.left,top:s-(t.top+e),bottom:Math.max(s,o)-(t.top+e)}}function Dy(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class fl{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e){return j.replace({widget:new My(this.size,e)}).range(this.from,this.to)}}class My extends At{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class xf{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new Py,this.scaler=wf,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ye.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=e.facet(Tr).filter(t=>typeof t!="function"),this.heightMap=rt.empty().applyChanges(this.stateDeco,ae.empty,this.heightOracle.setDoc(e.doc),[new ii(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=j.set(this.lineGaps.map(t=>t.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let r=i?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new ls(s,o))}}this.viewports=e.sort((i,r)=>i.from-r.from),this.scaler=this.heightMap.height<=7e6?wf:new zy(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:ar(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Tr).filter(h=>typeof h!="function");let r=e.changedRanges,s=ii.extendWithRanges(r,Iy(i,this.stateDeco,e?e.changes:Ie.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let a=!e.changes.empty||e.flags&2||l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,this.updateForViewport(),a&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?ye.RTL:ye.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=o||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight;this.contentDOMHeight=t.clientHeight,this.mustMeasureContent=!1;let a=0,h=0,c=parseInt(i.paddingTop)||0,f=parseInt(i.paddingBottom)||0;(this.paddingTop!=c||this.paddingBottom!=f)&&(this.paddingTop=c,this.paddingBottom=f,a|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,a|=8);let u=(this.printing?Dy:Wy)(t,this.paddingTop),d=u.top-this.pixelViewport.top,p=u.bottom-this.pixelViewport.bottom;this.pixelViewport=u;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(l=!0)),!this.inView)return 0;let x=t.clientWidth;if((this.contentDOMWidth!=x||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=x,this.editorHeight=e.scrollDOM.clientHeight,a|=8),l){let m=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(m)&&(o=!0),o||r.lineWrapping&&Math.abs(x-this.contentDOMWidth)>r.charWidth){let{lineHeight:b,charWidth:y}=e.docView.measureTextSize();o=r.refresh(s,b,y,x/y,m),o&&(e.docView.minWidth=0,a|=8)}d>0&&p>0?h=Math.max(d,p):d<0&&p<0&&(h=Math.min(d,p)),r.heightChanged=!1;for(let b of this.viewports){let y=b.from==this.viewport.from?m:e.docView.measureVisibleLineHeights(b);this.heightMap=this.heightMap.updateHeight(r,0,o,new Ay(b.from,y))}r.heightChanged&&(a|=2)}let Q=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Q&&(this.viewport=this.getViewport(h,this.scrollTarget)),this.updateForViewport(),(a&2||Q)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.state.doc,{visibleTop:o,visibleBottom:l}=this,a=new ls(r.lineAt(o-i*1e3,pe.ByHeight,s,0,0).from,r.lineAt(l+(1-i)*1e3,pe.ByHeight,s,0,0).to);if(t){let{head:h}=t.range;if(h<a.from||h>a.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=r.lineAt(h,pe.ByPos,s,0,0),u;t.y=="center"?u=(f.top+f.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&h<a.from?u=f.top:u=f.bottom-c,a=new ls(r.lineAt(u-1e3/2,pe.ByHeight,s,0,0).from,r.lineAt(u+c+1e3/2,pe.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let i=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new ls(this.heightMap.lineAt(i,pe.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(r,pe.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,pe.ByPos,this.state.doc,0,0),{bottom:s}=this.heightMap.lineAt(t,pe.ByPos,this.state.doc,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let r of e)t.touchesRange(r.from,r.to)||i.push(new fl(t.mapPos(r.from),t.mapPos(r.to),r.size));return i}ensureLineGaps(e){let t=[];if(this.defaultTextDirection!=ye.LTR)return t;for(let i of this.viewportLines){if(i.length<4e3)continue;let r=By(i.from,i.to,this.stateDeco);if(r.total<4e3)continue;let s,o;if(this.heightOracle.lineWrapping){let h=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;s=as(r,(this.visibleTop-i.top-h)/i.height),o=as(r,(this.visibleBottom-i.top+h)/i.height)}else{let h=r.total*this.heightOracle.charWidth,c=2e3*this.heightOracle.charWidth;s=as(r,(this.pixelViewport.left-c)/h),o=as(r,(this.pixelViewport.right+c)/h)}let l=[];s>i.from&&l.push({from:i.from,to:s}),o<i.to&&l.push({from:o,to:i.to});let a=this.state.selection.main;a.from>=i.from&&a.from<=i.to&&yf(l,a.from-10,a.from+10),!a.empty&&a.to>=i.from&&a.to<=i.to&&yf(l,a.to-10,a.to+10);for(let{from:h,to:c}of l)c-h>1e3&&t.push(Ly(e,f=>f.from>=i.from&&f.to<=i.to&&Math.abs(f.from-h)<1e3&&Math.abs(f.to-c)<1e3)||new fl(h,c,this.gapSize(i,h,c,r)))}return t}gapSize(e,t,i,r){let s=bf(r,i)-bf(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){fl.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=j.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];he.spans(e,this.viewport.from,this.viewport.to,{span(r,s){t.push({from:r,to:s})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=t[s].from||r.to!=t[s].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||ar(this.heightMap.lineAt(e,pe.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return ar(this.heightMap.lineAt(this.scaler.fromDOM(e),pe.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return ar(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class ls{constructor(e,t){this.from=e,this.to=t}}function By(n,e,t){let i=[],r=n,s=0;return he.spans(t,n,e,{span(){},point(o,l){o>r&&(i.push({from:r,to:o}),s+=o-r),r=l}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function as({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let r=0;;r++){let{from:s,to:o}=e[r],l=o-s;if(i<=l)return s+i;i-=l}}function bf(n,e){let t=0;for(let{from:i,to:r}of n.ranges){if(e<=r){t+=e-i;break}t+=r-i}return t/n.total}function yf(n,e,t){for(let i=0;i<n.length;i++){let r=n[i];if(r.from<t&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>t&&s.push({from:t,to:r.to}),n.splice(i,1,...s),i+=s.length-1}}}function Ly(n,e){for(let t of n)if(e(t))return t}const wf={toDOM(n){return n},fromDOM(n){return n},scale:1};class zy{constructor(e,t,i){let r=0,s=0,o=0;this.viewports=i.map(({from:l,to:a})=>{let h=t.lineAt(l,pe.ByPos,e,0,0).top,c=t.lineAt(a,pe.ByPos,e,0,0).bottom;return r+=c-h,{from:l,to:a,top:h,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}}function ar(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new ki(n.from,n.length,t,i-t,Array.isArray(n.type)?n.type.map(r=>ar(r,e)):n.type)}const hs=G.define({combine:n=>n.join(" ")}),Ia=G.define({combine:n=>n.indexOf(!0)>-1}),Ea=Ri.newName(),G0=Ri.newName(),q0=Ri.newName(),F0={"&light":"."+G0,"&dark":"."+q0};function Wa(n,e,t){return new Ri(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return n;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):n+" "+i}})}const _y=Wa("."+Ea,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},F0),Uy={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ul=H.ie&&H.ie_version<=11;class Ny{constructor(e,t,i){this.view=e,this.onChange=t,this.onScrollChanged=i,this.active=!1,this.selectionRange=new Zb,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let s of r)this.queue.push(s);(H.ie&&H.ie_version<=11||H.ios&&e.composing)&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),ul&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),typeof ResizeObserver=="function"&&(this.resize=new ResizeObserver(()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()}),this.resize.observe(e.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:t}=this,i=this.selectionRange;if(t.state.facet(Ur)?t.root.activeElement!=this.dom:!Oa(t.dom,i))return;let r=i.anchorNode&&t.docView.nearest(i.anchorNode);r&&r.ignoreEvent(e)||((H.ie&&H.ie_version<=11||H.android&&H.chrome)&&!t.state.selection.main.empty&&i.focusNode&&qs(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:e}=this.view,t=Gs(e),i=H.safari&&e.nodeType==11&&Ub()==this.view.contentDOM&&Xy(this.view)||t;return this.selectionRange.eq(i)?!1:(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Uy),ul&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),ul&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||requestAnimationFrame(()=>{let i=this.delayedAndroidKey;this.delayedAndroidKey=null;let r=this.view.state;this.readSelectionRange(),dr(this.view.contentDOM,i.key,i.keyCode)?this.processRecords():this.flush(),this.view.state==r&&this.view.update([])}),(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1,this.flush()},20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let e=this.queue;for(let s of this.observer.takeRecords())e.push(s);e.length&&(this.queue=[]);let t=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);!o||(o.typeOver&&(r=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:r}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;e&&this.readSelectionRange();let{from:t,to:i,typeOver:r}=this.processRecords(),s=this.selectionChanged&&Oa(this.dom,this.selectionRange);if(t<0&&!s)return;this.selectionChanged=!1;let o=this.view.state;this.onChange(t,i,r),this.view.state==o&&this.view.update([])}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let i=Sf(t,e.previousSibling||e.target.previousSibling,-1),r=Sf(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resize)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function Sf(n,e,t){for(;e;){let i=ke.get(e);if(i&&i.parent==n)return i;let r=e.parentNode;e=r!=n.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function Xy(n){let e=null;function t(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let i=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=n.docView.domAtPos(n.state.selection.main.anchor);return qs(l.node,l.offset,s,o)&&([i,r,s,o]=[s,o,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}}function Zy(n,e,t,i){let r,s,o=n.state.selection.main;if(e>-1){let l=n.docView.domBoundsAround(e,t,0);if(!l||n.state.readOnly)return;let{from:a,to:h}=l,c=n.docView.impreciseHead||n.docView.impreciseAnchor?[]:Gy(n),f=new E0(c,n.state);f.readRange(l.startDOM,l.endDOM);let u=o.from,d=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||H.android&&f.text.length<h-a)&&(u=o.to,d="end");let p=jy(n.state.doc.sliceString(a,h,Si),f.text,u-a,d);p&&(H.chrome&&n.inputState.lastKeyCode==13&&p.toB==p.from+2&&f.text.slice(p.from,p.toB)==Si+Si&&p.toB--,r={from:a+p.from,to:a+p.toA,insert:ae.of(f.text.slice(p.from,p.toB).split(Si))}),s=qy(c,a)}else if(n.hasFocus||!n.state.facet(Ur)){let l=n.observer.selectionRange,{impreciseHead:a,impreciseAnchor:h}=n.docView,c=a&&a.node==l.focusNode&&a.offset==l.focusOffset||!Rn(n.contentDOM,l.focusNode)?n.state.selection.main.head:n.docView.posFromDOM(l.focusNode,l.focusOffset),f=h&&h.node==l.anchorNode&&h.offset==l.anchorOffset||!Rn(n.contentDOM,l.anchorNode)?n.state.selection.main.anchor:n.docView.posFromDOM(l.anchorNode,l.anchorOffset);(c!=o.head||f!=o.anchor)&&(s=P.single(f,c))}if(!(!r&&!s)){if(!r&&i&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,r.from).append(r.insert).append(n.state.doc.slice(r.to,o.to))}:H.mac&&r&&r.from==r.to&&r.from==o.head-1&&r.insert.toString()=="."&&(r={from:o.from,to:o.to,insert:ae.of([" "])}),r){let l=n.state;if(H.ios&&n.inputState.flushIOSKey(n)||H.android&&(r.from==o.from&&r.to==o.to&&r.insert.length==1&&r.insert.lines==2&&dr(n.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&r.insert.length==0&&dr(n.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&r.insert.length==0&&dr(n.contentDOM,"Delete",46)))return;let a=r.insert.toString();if(n.state.facet($0).some(f=>f(n,r.from,r.to,a)))return;n.inputState.composing>=0&&n.inputState.composing++;let h;if(r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&n.inputState.composing<0){let f=o.from<r.from?l.sliceDoc(o.from,r.from):"",u=o.to>r.to?l.sliceDoc(r.to,o.to):"";h=l.replaceSelection(n.state.toText(f+r.insert.sliceString(0,void 0,n.state.lineBreak)+u))}else{let f=l.changes(r),u=s&&!l.selection.main.eq(s.main)&&s.main.to<=f.newLength?s.main:void 0;if(l.selection.ranges.length>1&&n.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let d=n.state.sliceDoc(r.from,r.to),p=W0(n)||n.state.doc.lineAt(o.head),g=o.to-r.to,x=o.to-o.from;h=l.changeByRange(Q=>{if(Q.from==o.from&&Q.to==o.to)return{changes:f,range:u||Q.map(f)};let m=Q.to-g,b=m-d.length;if(Q.to-Q.from!=x||n.state.sliceDoc(b,m)!=d||p&&Q.to>=p.from&&Q.from<=p.to)return{range:Q};let y=l.changes({from:b,to:m,insert:r.insert}),w=Q.to-o.to;return{changes:y,range:u?P.range(Math.max(0,u.anchor+w),Math.max(0,u.head+w)):Q.map(y)}})}else h={changes:f,selection:u&&l.selection.replaceRange(u)}}let c="input.type";n.composing&&(c+=".compose",n.inputState.compositionFirstChange&&(c+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(h,{scrollIntoView:!0,userEvent:c})}else if(s&&!s.main.eq(o)){let l=!1,a="select";n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(l=!0),a=n.inputState.lastSelectionOrigin),n.dispatch({selection:s,scrollIntoView:l,userEvent:a})}}}function jy(n,e,t,i){let r=Math.min(n.length,e.length),s=0;for(;s<r&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&n.length==e.length)return null;let o=n.length,l=e.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(i=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}return o<s&&n.length<e.length?(s-=t<=s&&t>=o?s-t:0,l=s+(l-o),o=s):l<s&&(s-=t<=s&&t>=l?s-t:0,o=s+(o-l),l=s),{from:s,toA:o,toB:l}}function Gy(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:r,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new Kc(t,i)),(r!=t||s!=i)&&e.push(new Kc(r,s))),e}function qy(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?P.single(t+e,i+e):null}class Y{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=e.root||jb(e.parent)||document,this.viewState=new xf(e.state||le.create()),this.plugins=this.state.facet(or).map(t=>new al(t));for(let t of this.plugins)t.update(this);this.observer=new Ny(this,(t,i,r)=>{Zy(this,t,i,r)},t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()}),this.inputState=new Oy(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new ef(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Ee?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,r,s=this.state;for(let l of e){if(l.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=l.state}if(this.destroyed){this.viewState.state=s;return}if(s.facet(le.phrases)!=this.state.facet(le.phrases))return this.setState(s);r=Ys.create(this,s,e);let o=this.viewState.scrollTarget;try{this.updateState=2;for(let l of e){if(o&&(o=o.map(l.changes)),l.scrollIntoView){let{main:a}=l.state.selection;o=new Vs(a.empty?a:P.cursor(a.head,a.head>a.anchor?-1:1))}for(let a of l.effects)a.is(Hc)&&(o=a.value)}this.viewState.update(r,o),this.bidiCache=Hs.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(lr)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(l=>l.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(hs)!=r.state.facet(hs)&&(this.viewState.mustMeasureContent=!0),(t||i||o||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!r.empty)for(let l of this.state.facet(Ta))l(r)}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new xf(e),this.plugins=e.facet(or).map(i=>new al(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new ef(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(or),i=e.state.facet(or);if(t!=i){let r=[];for(let s of i){let o=t.indexOf(s);if(o<0)r.push(new al(s));else{let l=this.plugins[o];l.mustUpdate=e,r.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.flush();let t=null;try{for(let i=0;;i++){this.updateState=1;let r=this.viewport,s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(i>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let o=[];s&4||([this.measureRequests,o]=[o,this.measureRequests]);let l=o.map(f=>{try{return f.read(this)}catch(u){return dt(this.state,u),kf}}),a=Ys.create(this,this.state,[]),h=!1,c=!1;a.flags|=s,t?t.flags|=s:t=a,this.updateState=2,a.empty||(this.updatePlugins(a),this.inputState.update(a),this.updateAttrs(),h=this.docView.update(a));for(let f=0;f<o.length;f++)if(l[f]!=kf)try{let u=o[f];u.write&&u.write(l[f],this)}catch(u){dt(this.state,u)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,c=!0),h&&this.docView.updateSelection(!0),this.viewport.from==r.from&&this.viewport.to==r.to&&!c&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let i of this.state.facet(Ta))i(t)}get themeClasses(){return Ea+" "+(this.state.facet(Ia)?q0:G0)+" "+this.state.facet(hs)}updateAttrs(){let e=$f(this,Q0,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Ur)?"true":"false",class:"cm-content",style:`${H.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),$f(this,T0,t);let i=this.observer.ignore(()=>{let r=va(this.contentDOM,this.contentAttrs,t),s=va(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let r of i.effects)if(r.is(Y.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(lr),Ri.mount(this.root,this.styleModules.concat(_y).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame(()=>this.measure())),e){if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return cl(this,e,lf(this,e,t,i))}moveByGroup(e,t){return cl(this,e,lf(this,e,t,i=>gy(this,e.head,i)))}moveToLineBoundary(e,t,i=!0){return py(this,e,t,i)}moveVertically(e,t,i){return cl(this,e,my(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),M0(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[$n.find(s,e-r.from,-1,t)];return Co(i,o.dir==ye.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(v0)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Fy)return C0(e.length);let t=this.textDirectionAt(e.from);for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t)return r.order;let i=ty(e.text,t);return this.bidiCache.push(new Hs(e.from,e.to,t,i)),i}get hasFocus(){var e;return(document.hasFocus()||H.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{l0(this.contentDOM),this.docView.updateSelection()})}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Hc.of(new Vs(typeof e=="number"?P.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return Pe.define(()=>({}),{eventHandlers:e})}static theme(e,t){let i=Ri.newName(),r=[hs.of(i),lr.of(Wa(`.${i}`,e))];return t&&t.dark&&r.push(Ia.of(!0)),r}static baseTheme(e){return Xn.lowest(lr.of(Wa("."+Ea,e,F0)))}}Y.styleModule=lr;Y.inputHandler=$0;Y.perLineTextDirection=v0;Y.exceptionSink=k0;Y.updateListener=Ta;Y.editable=Ur;Y.mouseSelectionStyle=S0;Y.dragMovesSelection=w0;Y.clickAddsSelectionRange=y0;Y.decorations=Tr;Y.atomicRanges=P0;Y.scrollMargins=A0;Y.darkTheme=Ia;Y.contentAttributes=T0;Y.editorAttributes=Q0;Y.lineWrapping=Y.contentAttributes.of({class:"cm-lineWrapping"});Y.announce=K.define();const Fy=4096,kf={};class Hs{constructor(e,t,i,r){this.from=e,this.to=t,this.dir=i,this.order=r}static update(e,t){if(t.empty)return e;let i=[],r=e.length?e[e.length-1].dir:ye.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&i.push(new Hs(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.order))}return i}}function $f(n,e,t){for(let i=n.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(n):s;o&&$a(o,t)}return t}const Vy=H.mac?"mac":H.windows?"win":H.linux?"linux":"key";function Yy(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let r,s,o,l;for(let a=0;a<t.length-1;++a){const h=t[a];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))s=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+h)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),l&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function dl(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const Hy=Y.domEventHandlers({keydown(n,e){return Y0(V0(e.state),n,e,"editor")}}),Nr=G.define({enables:Hy}),vf=new WeakMap;function V0(n){let e=n.facet(Nr),t=vf.get(e);return t||vf.set(e,t=ew(e.reduce((i,r)=>i.concat(r),[]))),t}function Jy(n,e,t){return Y0(V0(n.state),e,n,t)}let bi=null;const Ky=4e3;function ew(n,e=Vy){let t=Object.create(null),i=Object.create(null),r=(o,l)=>{let a=i[o];if(a==null)i[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,h)=>{let c=t[o]||(t[o]=Object.create(null)),f=l.split(/ (?!$)/).map(p=>Yy(p,e));for(let p=1;p<f.length;p++){let g=f.slice(0,p).join(" ");r(g,!0),c[g]||(c[g]={preventDefault:!0,commands:[x=>{let Q=bi={view:x,prefix:g,scope:o};return setTimeout(()=>{bi==Q&&(bi=null)},Ky),!0}]})}let u=f.join(" ");r(u,!1);let d=c[u]||(c[u]={preventDefault:!1,commands:[]});d.commands.push(a),h&&(d.preventDefault=!0)};for(let o of n){let l=o[e]||o.key;if(!!l)for(let a of o.scope?o.scope.split(" "):["editor"])s(a,l,o.run,o.preventDefault),o.shift&&s(a,"Shift-"+l,o.shift,o.preventDefault)}return t}function Y0(n,e,t,i){let r=_b(e),s=r.length==1&&r!=" ",o="",l=!1;bi&&bi.view==t&&bi.scope==i&&(o=bi.prefix+" ",(l=L0.indexOf(e.keyCode)<0)&&(bi=null));let a=f=>{if(f){for(let u of f.commands)if(u(t))return!0;f.preventDefault&&(l=!0)}return!1},h=n[i],c;if(h){if(a(h[o+dl(r,e,!s)]))return!0;if(s&&(e.shiftKey||e.altKey||e.metaKey)&&(c=Ci[e.keyCode])&&c!=r){if(a(h[o+dl(c,e,!0)]))return!0}else if(s&&e.shiftKey&&a(h[o+dl(r,e,!0)]))return!0}return l}const H0=!H.ios,hr=G.define({combine(n){return hi(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function tw(n={}){return[hr.of(n),iw,nw]}class J0{constructor(e,t,i,r,s){this.left=e,this.top=t,this.width=i,this.height=r,this.className=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const iw=Pe.fromClass(class{constructor(n){this.view=n,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=n.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=n.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),n.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(hr).cursorBlinkRate+"ms"}update(n){let e=n.startState.facet(hr)!=n.state.facet(hr);(e||n.selectionSet||n.geometryChanged||n.viewportChanged)&&this.view.requestMeasure(this.measureReq),n.transactions.some(t=>t.scrollIntoView)&&(this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),e&&this.setBlinkRate()}readPos(){let{state:n}=this.view,e=n.facet(hr),t=n.selection.ranges.map(r=>r.empty?[]:rw(this.view,r)).reduce((r,s)=>r.concat(s)),i=[];for(let r of n.selection.ranges){let s=r==n.selection.main;if(r.empty?!s||H0:e.drawRangeCursor){let o=sw(this.view,r,s);o&&i.push(o)}}return{rangePieces:t,cursors:i}}drawSel({rangePieces:n,cursors:e}){if(n.length!=this.rangePieces.length||n.some((t,i)=>!t.eq(this.rangePieces[i]))){this.selectionLayer.textContent="";for(let t of n)this.selectionLayer.appendChild(t.draw());this.rangePieces=n}if(e.length!=this.cursors.length||e.some((t,i)=>!t.eq(this.cursors[i]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const i of e)this.cursorLayer.appendChild(i.draw())}else e.forEach((i,r)=>i.adjust(t[r]));this.cursors=e}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),K0={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};H0&&(K0[".cm-line"].caretColor="transparent !important");const nw=Xn.highest(Y.theme(K0));function ep(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==ye.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function Qf(n,e,t){let i=P.cursor(e);return{from:Math.max(t.from,n.moveToLineBoundary(i,!1,!0).from),to:Math.min(t.to,n.moveToLineBoundary(i,!0,!0).from),type:fe.Text}}function Tf(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==fe.Text))return i}return t}function rw(n,e){if(e.to<=n.viewport.from||e.from>=n.viewport.to)return[];let t=Math.max(e.from,n.viewport.from),i=Math.min(e.to,n.viewport.to),r=n.textDirection==ye.LTR,s=n.contentDOM,o=s.getBoundingClientRect(),l=ep(n),a=window.getComputedStyle(s.firstChild),h=o.left+parseInt(a.paddingLeft)+Math.min(0,parseInt(a.textIndent)),c=o.right-parseInt(a.paddingRight),f=Tf(n,t),u=Tf(n,i),d=f.type==fe.Text?f:null,p=u.type==fe.Text?u:null;if(n.lineWrapping&&(d&&(d=Qf(n,t,d)),p&&(p=Qf(n,i,p))),d&&p&&d.from==p.from)return x(Q(e.from,e.to,d));{let b=d?Q(e.from,null,d):m(f,!1),y=p?Q(null,e.to,p):m(u,!0),w=[];return(d||f).to<(p||u).from-1?w.push(g(h,b.bottom,c,y.top)):b.bottom<y.top&&n.elementAtHeight((b.bottom+y.top)/2).type==fe.Text&&(b.bottom=y.top=(b.bottom+y.top)/2),x(b).concat(w).concat(x(y))}function g(b,y,w,v){return new J0(b-l.left,y-l.top-.01,w-b,v-y+.01,"cm-selectionBackground")}function x({top:b,bottom:y,horizontal:w}){let v=[];for(let R=0;R<w.length;R+=2)v.push(g(w[R],b,w[R+1],y));return v}function Q(b,y,w){let v=1e9,R=-1e9,N=[];function M(k,T,z,W,D){let U=n.coordsAtPos(k,k==w.to?-2:2),X=n.coordsAtPos(z,z==w.from?2:-2);v=Math.min(U.top,X.top,v),R=Math.max(U.bottom,X.bottom,R),D==ye.LTR?N.push(r&&T?h:U.left,r&&W?c:X.right):N.push(!r&&W?h:X.left,!r&&T?c:U.right)}let C=b!=null?b:w.from,O=y!=null?y:w.to;for(let k of n.visibleRanges)if(k.to>C&&k.from<O)for(let T=Math.max(k.from,C),z=Math.min(k.to,O);;){let W=n.state.doc.lineAt(T);for(let D of n.bidiSpans(W)){let U=D.from+W.from,X=D.to+W.from;if(U>=z)break;X>T&&M(Math.max(U,T),b==null&&U<=C,Math.min(X,z),y==null&&X>=O,D.dir)}if(T=W.to+1,T>=z)break}return N.length==0&&M(C,b==null,O,y==null,n.textDirection),{top:v,bottom:R,horizontal:N}}function m(b,y){let w=o.top+(y?b.top:b.bottom);return{top:w,bottom:w,horizontal:[]}}}function sw(n,e,t){let i=n.coordsAtPos(e.head,e.assoc||1);if(!i)return null;let r=ep(n);return new J0(i.left-r.left,i.top-r.top,-1,i.bottom-i.top,t?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const tp=K.define({map(n,e){return n==null?null:e.mapPos(n)}}),cr=Ce.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(tp)?i.value:t,n)}}),ow=Pe.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(cr);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(cr)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(cr),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(cr)!=n&&this.view.dispatch({effects:tp.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function lw(){return[cr,ow]}function Pf(n,e,t,i,r){e.lastIndex=0;for(let s=n.iterRange(t,i),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)r(o+l.index,o+l.index+l[0].length,l)}function aw(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:r,to:s}of t)r=Math.max(n.state.doc.lineAt(r).from,r-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class hw{constructor(e){let{regexp:t,decoration:i,boundary:r,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=t,this.getDeco=typeof i=="function"?i:()=>i,this.boundary=r,this.maxLength=s}createDeco(e){let t=new Ai;for(let{from:i,to:r}of aw(e,this.maxLength))Pf(e.state.doc,this.regexp,i,r,(s,o,l)=>t.add(s,o,this.getDeco(l,e,s)));return t.finish()}updateDeco(e,t){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>e.view.viewport.from&&l<e.view.viewport.to&&(i=Math.min(l,i),r=Math.max(a,r))}),e.viewportChanged||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),i,r):t}updateRange(e,t,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),l=Math.min(s.to,r);if(l>o){let a=e.state.doc.lineAt(o),h=a.to<l?e.state.doc.lineAt(l):a,c=Math.max(s.from,a.from),f=Math.min(s.to,h.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){c=o;break}for(;l<h.to;l++)if(this.boundary.test(h.text[l-h.from])){f=l;break}}let u=[],d;if(a==h)for(this.regexp.lastIndex=c-a.from;(d=this.regexp.exec(a.text))&&d.index<f-a.from;){let p=d.index+a.from;u.push(this.getDeco(d,e,p).range(p,p+d[0].length))}else Pf(e.state.doc,this.regexp,c,f,(p,g,x)=>u.push(this.getDeco(x,e,p).range(p,g)));t=t.update({filterFrom:c,filterTo:f,filter:(p,g)=>p<c||g>f,add:u})}}return t}}const Da=/x/.unicode!=null?"gu":"g",cw=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\uFEFF\uFFF9-\uFFFC]`,Da),fw={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let pl=null;function uw(){var n;if(pl==null&&typeof document!="undefined"&&document.body){let e=document.body.style;pl=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return pl||!1}const Rs=G.define({combine(n){let e=hi(n,{render:null,specialChars:cw,addSpecialChars:null});return(e.replaceTabs=!uw())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Da)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Da)),e}});function dw(n={}){return[Rs.of(n),pw()]}let Af=null;function pw(){return Af||(Af=Pe.fromClass(class{constructor(n){this.view=n,this.decorations=j.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(Rs)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new hw({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:r}=t.state,s=Ze(e[0],0);if(s==9){let o=r.lineAt(i),l=t.state.tabSize,a=zr(o.text,l,i-o.from);return j.replace({widget:new xw((l-a%l)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=j.replace({widget:new Ow(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(Rs);n.startState.facet(Rs)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const gw="\u2022";function mw(n){return n>=32?gw:n==10?"\u2424":String.fromCharCode(9216+n)}class Ow extends At{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=mw(this.code),i=e.state.phrase("Control character")+" "+(fw[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,t);if(r)return r;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class xw extends At{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function bw(){return ww}const yw=j.line({class:"cm-activeLine"}),ww=Pe.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){if(!i.empty)return j.none;let r=n.lineBlockAt(i.head);r.from>e&&(t.push(yw.range(r.from)),e=r.from)}return j.set(t)}},{decorations:n=>n.decorations}),Ma=2e3;function Sw(n,e,t){let i=Math.min(e.line,t.line),r=Math.max(e.line,t.line),s=[];if(e.off>Ma||t.off>Ma||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=i;a<=r;a++){let h=n.doc.line(a);h.length<=l&&s.push(P.range(h.from+o,h.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=i;a<=r;a++){let h=n.doc.line(a),c=pa(h.text,o,n.tabSize,!0);if(c>-1){let f=pa(h.text,l,n.tabSize);s.push(P.range(h.from+c,h.from+f))}}}return s}function kw(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function Rf(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),r=t-i.from,s=r>Ma?-1:r==i.length?kw(n,e.clientX):zr(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:s,off:r}}function $w(n,e){let t=Rf(n,e),i=n.state.selection;return t?{update(r){if(r.docChanged){let s=r.changes.mapPos(r.startState.doc.line(t.line).from),o=r.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(r.changes)}},get(r,s,o){let l=Rf(n,r);if(!l)return i;let a=Sw(n.state,t,l);return a.length?o?P.create(a.concat(i.ranges)):P.create(a):i}}:null}function vw(n){let e=(n==null?void 0:n.eventFilter)||(t=>t.altKey&&t.button==0);return Y.mouseSelectionStyle.of((t,i)=>e(i)?$w(t,i):null)}const Qw={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},Tw={style:"cursor: crosshair"};function Pw(n={}){let[e,t]=Qw[n.key||"Alt"],i=Pe.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventHandlers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)}}});return[i,Y.contentAttributes.of(r=>{var s;return!((s=r.plugin(i))===null||s===void 0)&&s.isDown?Tw:null})]}const gl="-10000px";class ip{constructor(e,t,i){this.facet=t,this.createTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(r=>r),this.tooltipViews=this.tooltips.map(i)}update(e){let t=e.state.facet(this.facet),i=t.filter(s=>s);if(t===this.input){for(let s of this.tooltipViews)s.update&&s.update(e);return!1}let r=[];for(let s=0;s<i.length;s++){let o=i[s],l=-1;if(!!o){for(let a=0;a<this.tooltips.length;a++){let h=this.tooltips[a];h&&h.create==o.create&&(l=a)}if(l<0)r[s]=this.createTooltipView(o);else{let a=r[s]=this.tooltipViews[l];a.update&&a.update(e)}}}for(let s of this.tooltipViews)r.indexOf(s)<0&&s.dom.remove();return this.input=t,this.tooltips=i,this.tooltipViews=r,!0}}function Aw(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const ml=G.define({combine:n=>{var e,t,i;return{position:H.ios?"absolute":((e=n.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||Aw}}}),np=Pe.fromClass(class{constructor(n){var e;this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let t=n.state.facet(ml);this.position=t.position,this.parent=t.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new ip(n,Ph,i=>this.createTooltip(i)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),(e=n.dom.ownerDocument.defaultView)===null||e===void 0||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(ml);if(i.position!=this.position){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=gl,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;(n=this.view.dom.ownerDocument.defaultView)===null||n===void 0||n.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,t)=>{let i=this.manager.tooltipViews[t];return i.getCoords?i.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(ml).tooltipSpace(this.view)}}writeMeasure(n){let{editor:e,space:t}=n,i=[];for(let r=0;r<this.manager.tooltips.length;r++){let s=this.manager.tooltips[r],o=this.manager.tooltipViews[r],{dom:l}=o,a=n.pos[r],h=n.size[r];if(!a||a.bottom<=Math.max(e.top,t.top)||a.top>=Math.min(e.bottom,t.bottom)||a.right<Math.max(e.left,t.left)-.1||a.left>Math.min(e.right,t.right)+.1){l.style.top=gl;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,f=c?7:0,u=h.right-h.left,d=h.bottom-h.top,p=o.offset||Cw,g=this.view.textDirection==ye.LTR,x=h.width>t.right-t.left?g?t.left:t.right-h.width:g?Math.min(a.left-(c?14:0)+p.x,t.right-u):Math.max(t.left,a.left-u+(c?14:0)-p.x),Q=!!s.above;!s.strictSide&&(Q?a.top-(h.bottom-h.top)-p.y<t.top:a.bottom+(h.bottom-h.top)+p.y>t.bottom)&&Q==t.bottom-a.bottom>a.top-t.top&&(Q=!Q);let m=Q?a.top-d-f-p.y:a.bottom+f+p.y,b=x+u;if(o.overlap!==!0)for(let y of i)y.left<b&&y.right>x&&y.top<m+d&&y.bottom>m&&(m=Q?y.top-d-2-f:y.bottom+f+2);this.position=="absolute"?(l.style.top=m-n.parent.top+"px",l.style.left=x-n.parent.left+"px"):(l.style.top=m+"px",l.style.left=x+"px"),c&&(c.style.left=`${a.left+(g?p.x:-p.x)-(x+14-7)}px`),o.overlap!==!0&&i.push({left:x,top:m,right:b,bottom:m+d}),l.classList.toggle("cm-tooltip-above",Q),l.classList.toggle("cm-tooltip-below",!Q),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=gl}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),Rw=Y.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Cw={x:0,y:0},Ph=G.define({enables:[np,Rw]}),Js=G.define();class Ah{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new ip(e,Js,t=>this.createHostedView(t))}static create(e){return new Ah(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}}const Iw=Ph.compute([Js],n=>{let e=n.facet(Js).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:Ah.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Ew{constructor(e,t,i,r,s){this.view=e,this.source=t,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let i=this.view.coordsAtPos(t);if(i==null||e.y<i.top||e.y>i.bottom||e.x<i.left-this.view.defaultCharacterWidth||e.x>i.right+this.view.defaultCharacterWidth)return;let r=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(l=>l.from<=t&&l.to>=t),s=r&&r.dir==ye.RTL?-1:1,o=this.source(this.view,t,e.x<i.left?-s:s);if(o!=null&&o.then){let l=this.pending={pos:t};o.then(a=>{this.pending==l&&(this.pending=null,a&&this.view.dispatch({effects:this.setHover.of(a)}))},a=>dt(this.view.state,a,"hover tooltip"))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!Ww(this.lastMove.target)||this.pending){let{pos:r}=i||this.pending,s=(t=i==null?void 0:i.end)!==null&&t!==void 0?t:r;(r==s?this.view.posAtCoords(this.lastMove)!=r:!Dw(this.view,r,s,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function Ww(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function Dw(n,e,t,i,r,s){let o=document.createRange(),l=n.domAtPos(e),a=n.domAtPos(t);o.setEnd(a.node,a.offset),o.setStart(l.node,l.offset);let h=o.getClientRects();o.detach();for(let c=0;c<h.length;c++){let f=h[c];if(Math.max(f.top-r,r-f.bottom,f.left-i,i-f.right)<=s)return!0}return!1}function Mw(n,e={}){let t=K.define(),i=Ce.define({create(){return null},update(r,s){if(r&&(e.hideOnChange&&(s.docChanged||s.selection)||e.hideOn&&e.hideOn(s,r)))return null;if(r&&s.docChanged){let o=s.changes.mapPos(r.pos,-1,_e.TrackDel);if(o==null)return null;let l=Object.assign(Object.create(null),r);l.pos=o,r.end!=null&&(l.end=s.changes.mapPos(r.end)),r=l}for(let o of s.effects)o.is(t)&&(r=o.value),o.is(Lw)&&(r=null);return r},provide:r=>Js.from(r)});return[i,Pe.define(r=>new Ew(r,n,i,t,e.hoverTime||300)),Iw]}function Bw(n,e){let t=n.plugin(np);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const Lw=K.define(),Cf=G.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Pr(n,e){let t=n.plugin(rp),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const rp=Pe.fromClass(class{constructor(n){this.input=n.state.facet(Ar),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(Cf);this.top=new cs(n,!0,e.topContainer),this.bottom=new cs(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(Cf);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new cs(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new cs(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Ar);if(t!=this.input){let i=t.filter(a=>a),r=[],s=[],o=[],l=[];for(let a of i){let h=this.specs.indexOf(a),c;h<0?(c=a(n.view),l.push(c)):(c=this.panels[h],c.update&&c.update(n)),r.push(c),(c.top?s:o).push(c)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>Y.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class cs{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=If(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=If(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function If(n){let e=n.nextSibling;return n.remove(),e}const Ar=G.define({enables:rp});class li extends Hi{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}li.prototype.elementClass="";li.prototype.toDOM=void 0;li.prototype.mapMode=_e.TrackBefore;li.prototype.startSide=li.prototype.endSide=-1;li.prototype.point=!0;const Cs=G.define(),zw={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>he.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},pr=G.define();function _w(n){return[sp(),pr.of(Object.assign(Object.assign({},zw),n))]}const Ba=G.define({combine:n=>n.some(e=>e)});function sp(n){let e=[Uw];return n&&n.fixed===!1&&e.push(Ba.of(!0)),e}const Uw=Pe.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(pr).map(e=>new Wf(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(Ba),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Ba)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=he.iter(this.view.state.facet(Cs),this.view.viewport.from),i=[],r=this.gutters.map(s=>new Nw(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks){let o;if(Array.isArray(s.type)){for(let l of s.type)if(l.type==fe.Text){o=l;break}}else o=s.type==fe.Text?s:void 0;if(!!o){i.length&&(i=[]),op(t,i,s.from);for(let l of r)l.line(this.view,o,i)}}for(let s of r)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(pr),t=n.state.facet(pr),i=n.docChanged||n.heightChanged||n.viewportChanged||!he.eq(n.startState.facet(Cs),n.state.facet(Cs),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(n)&&(i=!0);else{i=!0;let r=[];for(let s of t){let o=e.indexOf(s);o<0?r.push(new Wf(this.view,s)):(this.gutters[o].update(n),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>Y.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==ye.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function Ef(n){return Array.isArray(n)?n:[n]}function op(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class Nw{constructor(e,t,i){this.gutter=e,this.height=i,this.localMarkers=[],this.i=0,this.cursor=he.iter(e.markers,t.from)}line(e,t,i){this.localMarkers.length&&(this.localMarkers=[]),op(this.cursor,this.localMarkers,t.from);let r=i.length?this.localMarkers.concat(i):this.localMarkers,s=this.gutter.config.lineMarker(e,t,r);s&&r.unshift(s);let o=this.gutter;if(r.length==0&&!o.config.renderEmptyElements)return;let l=t.top-this.height;if(this.i==o.elements.length){let a=new lp(e,t.height,l,r);o.elements.push(a),o.dom.appendChild(a.dom)}else o.elements[this.i].update(e,t.height,l,r);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Wf{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,r=>{let s=e.lineBlockAtHeight(r.clientY-e.documentTop);t.domEventHandlers[i](e,s,r)&&r.preventDefault()});this.markers=Ef(t.markers(e)),t.initialSpacer&&(this.spacer=new lp(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Ef(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!he.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class lp{constructor(e,t,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,r)}update(e,t,i,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),Xw(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,h=!1;if(a){let c=a.elementClass;c&&(i+=" "+c);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(a)){l=f,h=!0;break}}else l=this.markers.length;for(;o<l;){let c=this.markers[o++];if(c.toDOM){c.destroy(r);let f=r.nextSibling;r.remove(),r=f}}if(!a)break;a.toDOM&&(h?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),h&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function Xw(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const Zw=G.define(),mn=G.define({combine(n){return hi(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let r in t){let s=i[r],o=t[r];i[r]=s?(l,a,h)=>s(l,a,h)||o(l,a,h):o}return i}})}});class Ol extends li{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function xl(n,e){return n.state.facet(mn).formatNumber(e,n.state)}const jw=pr.compute([mn],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Zw)},lineMarker(e,t,i){return i.some(r=>r.toDOM)?null:new Ol(xl(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(mn)!=e.state.facet(mn),initialSpacer(e){return new Ol(xl(e,Df(e.state.doc.lines)))},updateSpacer(e,t){let i=xl(t.view,Df(t.view.state.doc.lines));return i==e.number?e:new Ol(i)},domEventHandlers:n.facet(mn).domEventHandlers}));function Gw(n={}){return[mn.of(n),sp(),jw]}function Df(n){let e=9;for(;e<n;)e=e*10+9;return e}const qw=new class extends li{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Fw=Cs.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges)if(i.empty){let r=n.doc.lineAt(i.head).from;r>t&&(t=r,e.push(qw.range(r)))}return he.of(e)});function Vw(){return Fw}const ap=1024;let Yw=0;class bl{constructor(e,t){this.from=e,this.to=t}}class ne{constructor(e={}){this.id=Yw++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=st.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}ne.closedBy=new ne({deserialize:n=>n.split(" ")});ne.openedBy=new ne({deserialize:n=>n.split(" ")});ne.group=new ne({deserialize:n=>n.split(" ")});ne.contextHash=new ne({perNode:!0});ne.lookAhead=new ne({perNode:!0});ne.mounted=new ne({perNode:!0});const Hw=Object.create(null);class st{constructor(e,t,i,r=0){this.name=e,this.props=t,this.id=i,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Hw,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new st(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(ne.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let r of i.split(" "))t[r]=e[i];return i=>{for(let r=i.prop(ne.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?i.name:r[s]];if(o)return o}}}}st.none=new st("",Object.create(null),0,8);class Rh{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}t.push(r?new st(i.name,r,i.id,i.flags):i)}return new Rh(t)}}const fs=new WeakMap,Mf=new WeakMap;var ze;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(ze||(ze={}));class Ae{constructor(e,t,i,r,s){if(this.type=e,this.children=t,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=this.prop(ne.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let r=i.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new to(this.topNode,e)}cursorAt(e,t=0,i=0){let r=fs.get(this)||this.topNode,s=new to(r);return s.moveTo(e,t),fs.set(this,s._tree),s}get topNode(){return new ni(this,0,0,null)}resolve(e,t=0){let i=In(fs.get(this)||this.topNode,e,t,!1);return fs.set(this,i),i}resolveInner(e,t=0){let i=In(Mf.get(this)||this.topNode,e,t,!0);return Mf.set(this,i),i}iterate(e){let{enter:t,leave:i,from:r=0,to:s=this.length}=e;for(let o=this.cursor((e.mode||0)|ze.IncludeAnonymous);;){let l=!1;if(o.from<=s&&o.to>=r&&(o.type.isAnonymous||t(o)!==!1)){if(o.firstChild())continue;l=!0}for(;l&&i&&!o.type.isAnonymous&&i(o),!o.nextSibling();){if(!o.parent())return;l=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Eh(st.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,r)=>new Ae(this.type,t,i,r,this.propValues),e.makeTree||((t,i,r)=>new Ae(st.none,t,i,r)))}static build(e){return Kw(e)}}Ae.empty=new Ae(st.none,[],[],0);class Ch{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ch(this.buffer,this.index)}}class sn{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return st.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(hp(s,r,o[a+1],o[a+2])&&(l=a,i>0));a=o[a+3]);return l}slice(e,t,i,r){let s=this.buffer,o=new Uint16Array(t-e);for(let l=e,a=0;l<t;)o[a++]=s[l++],o[a++]=s[l++]-i,o[a++]=s[l++]-i,o[a++]=s[l++]-e;return new sn(o,r-i,this.set)}}function hp(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function cp(n,e){let t=n.childBefore(e);for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}function In(n,e,t,i){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!i&&n instanceof ni&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=i?0:ze.IgnoreOverlays;if(i)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof ni&&o.index<0&&((r=l.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(n=l);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class ni{constructor(e,t,i,r){this._tree=e,this.from=t,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,h=t>0?l.length:-1;e!=h;e+=t){let c=l[e],f=a[e]+o.from;if(!!hp(r,i,f,f+c.length)){if(c instanceof sn){if(s&ze.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,i-f,r);if(u>-1)return new $i(new Jw(o,c,e,f),null,u)}else if(s&ze.IncludeAnonymous||!c.type.isAnonymous||Ih(c)){let u;if(!(s&ze.IgnoreMounts)&&c.props&&(u=c.prop(ne.mounted))&&!u.overlay)return new ni(u.tree,f,e,o);let d=new ni(c,f,e,o);return s&ze.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,i,r)}}}if(s&ze.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let r;if(!(i&ze.IgnoreOverlays)&&(r=this._tree.prop(ne.mounted))&&r.overlay){let s=e-this.from;for(let{from:o,to:l}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new ni(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new to(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return In(this,e,t,!1)}resolveInner(e,t=0){return In(this,e,t,!0)}enterUnfinishedNodesBefore(e){return cp(this,e)}getChild(e,t=null,i=null){let r=Ks(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return Ks(this,e,t,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return eo(this,e)}}function Ks(n,e,t,i){let r=n.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(;!r.type.is(t);)if(!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function eo(n,e,t=e.length-1){for(let i=n.parent;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class Jw{constructor(e,t,i,r){this.parent=e,this.buffer=t,this.index=i,this.start=r}}class $i{constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new $i(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&ze.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new $i(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new $i(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new $i(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new to(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1],l=i.buffer[this.index+2];e.push(i.slice(r,s,o,l)),t.push(0)}return new Ae(this.type,e,t,this.to-this.from)}resolve(e,t=0){return In(this,e,t,!1)}resolveInner(e,t=0){return In(this,e,t,!0)}enterUnfinishedNodesBefore(e){return cp(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let r=Ks(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return Ks(this,e,t,i)}get node(){return this}matchContext(e){return eo(this,e)}}class to{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ni)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof ni?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&ze.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ze.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ze.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=r)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let l=i._tree.children[s];if(this.mode&ze.IncludeAnonymous||l instanceof sn||!l.type.isAnonymous||Ih(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer){e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,i=s+1;break e}r=this.stack[--s]}}for(let r=i;r<this.stack.length;r++)t=new $i(this.buffer,t,this.stack[r]);return this.bufferNode=new $i(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return eo(this.node,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return eo(this.node,e,r);let o=i[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function Ih(n){return n.children.some(e=>e instanceof sn||!e.type.isAnonymous||Ih(e))}function Kw(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:r=ap,reused:s=[],minRepeatType:o=i.types.length}=n,l=Array.isArray(t)?new Ch(t,t.length):t,a=i.types,h=0,c=0;function f(y,w,v,R,N){let{id:M,start:C,end:O,size:k}=l,T=c;for(;k<0;)if(l.next(),k==-1){let X=s[M];v.push(X),R.push(C-y);return}else if(k==-3){h=M;return}else if(k==-4){c=M;return}else throw new RangeError(`Unrecognized record size: ${k}`);let z=a[M],W,D,U=C-y;if(O-C<=r&&(D=g(l.pos-w,N))){let X=new Uint16Array(D.size-D.skip),_=l.pos-D.size,q=X.length;for(;l.pos>_;)q=x(D.start,X,q);W=new sn(X,O-D.start,i),U=D.start-y}else{let X=l.pos-k;l.next();let _=[],q=[],I=M>=o?M:-1,V=0,oe=O;for(;l.pos>X;)I>=0&&l.id==I&&l.size>=0?(l.end<=oe-r&&(d(_,q,C,V,l.end,oe,I,T),V=_.length,oe=l.end),l.next()):f(C,X,_,q,I);if(I>=0&&V>0&&V<_.length&&d(_,q,C,V,C,oe,I,T),_.reverse(),q.reverse(),I>-1&&V>0){let ue=u(z);W=Eh(z,_,q,0,_.length,0,O-C,ue,ue)}else W=p(z,_,q,O-C,T-O)}v.push(W),R.push(U)}function u(y){return(w,v,R)=>{let N=0,M=w.length-1,C,O;if(M>=0&&(C=w[M])instanceof Ae){if(!M&&C.type==y&&C.length==R)return C;(O=C.prop(ne.lookAhead))&&(N=v[M]+C.length+O)}return p(y,w,v,R,N)}}function d(y,w,v,R,N,M,C,O){let k=[],T=[];for(;y.length>R;)k.push(y.pop()),T.push(w.pop()+v-N);y.push(p(i.types[C],k,T,M-N,O-M)),w.push(N-v)}function p(y,w,v,R,N=0,M){if(h){let C=[ne.contextHash,h];M=M?[C].concat(M):[C]}if(N>25){let C=[ne.lookAhead,N];M=M?[C].concat(M):[C]}return new Ae(y,w,v,R,M)}function g(y,w){let v=l.fork(),R=0,N=0,M=0,C=v.end-r,O={size:0,start:0,skip:0};e:for(let k=v.pos-y;v.pos>k;){let T=v.size;if(v.id==w&&T>=0){O.size=R,O.start=N,O.skip=M,M+=4,R+=4,v.next();continue}let z=v.pos-T;if(T<0||z<k||v.start<C)break;let W=v.id>=o?4:0,D=v.start;for(v.next();v.pos>z;){if(v.size<0)if(v.size==-3)W+=4;else break e;else v.id>=o&&(W+=4);v.next()}N=D,R+=T,M+=W}return(w<0||R==y)&&(O.size=R,O.start=N,O.skip=M),O.size>4?O:void 0}function x(y,w,v){let{id:R,start:N,end:M,size:C}=l;if(l.next(),C>=0&&R<o){let O=v;if(C>4){let k=l.pos-(C-4);for(;l.pos>k;)v=x(y,w,v)}w[--v]=O,w[--v]=M-y,w[--v]=N-y,w[--v]=R}else C==-3?h=R:C==-4&&(c=R);return v}let Q=[],m=[];for(;l.pos>0;)f(n.start||0,n.bufferStart||0,Q,m,-1);let b=(e=n.length)!==null&&e!==void 0?e:Q.length?m[0]+Q[0].length:0;return new Ae(a[n.topID],Q.reverse(),m.reverse(),b)}const Bf=new WeakMap;function Is(n,e){if(!n.isAnonymous||e instanceof sn||e.type!=n)return 1;let t=Bf.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof Ae)){t=1;break}t+=Is(n,i)}Bf.set(e,t)}return t}function Eh(n,e,t,i,r,s,o,l,a){let h=0;for(let p=i;p<r;p++)h+=Is(n,e[p]);let c=Math.ceil(h*1.5/8),f=[],u=[];function d(p,g,x,Q,m){for(let b=x;b<Q;){let y=b,w=g[b],v=Is(n,p[b]);for(b++;b<Q;b++){let R=Is(n,p[b]);if(v+R>=c)break;v+=R}if(b==y+1){if(v>c){let R=p[y];d(R.children,R.positions,0,R.children.length,g[y]+m);continue}f.push(p[y])}else{let R=g[b-1]+p[b-1].length-w;f.push(Eh(n,p,g,y,b,w,R,null,a))}u.push(w+m-s)}}return d(e,t,i,r,0),(l||a)(f,u,o)}class Yi{constructor(e,t,i,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let r=[new Yi(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,i=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,h=0;;l++){let c=l<t.length?t[l]:null,f=c?c.fromA:1e9;if(f-a>=i)for(;o&&o.from<f;){let u=o;if(a>=u.from||f<=u.to||h){let d=Math.max(u.from,a)-h,p=Math.min(u.to,f)-h;u=d>=p?null:new Yi(d,p,u.tree,u.offset+h,l>0,!!c)}if(u&&r.push(u),o.to>f)break;o=s<e.length?e[s++]:null}if(!c)break;a=c.toA,h=c.toA-c.toB}return r}}class fp{startParse(e,t,i){return typeof e=="string"&&(e=new e2(e)),i=i?i.length?i.map(r=>new bl(r.from,r.to)):[new bl(0,0)]:[new bl(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let r=this.startParse(e,t,i);for(;;){let s=r.advance();if(s)return s}}}class e2{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new ne({perNode:!0});let t2=0;class Bt{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=t2++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new Bt([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new io;return t=>t.modified.indexOf(e)>-1?t:io.get(t.base||t,t.modified.concat(e).sort((i,r)=>i.id-r.id))}}let i2=0;class io{constructor(){this.instances=[],this.id=i2++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(l=>l.base==e&&n2(t,l.modified));if(i)return i;let r=[],s=new Bt(r,e,t);for(let l of t)l.instances.push(s);let o=up(t);for(let l of e.set)for(let a of o)r.push(io.get(l,a));return s}}function n2(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function up(n){let e=[n];for(let t=0;t<n.length;t++)for(let i of up(n.slice(0,t).concat(n.slice(t+1))))e.push(i);return e}function dp(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let f=0;;){if(l=="..."&&f>0&&f+3==r.length){o=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!u)throw new RangeError("Invalid path: "+r);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),f+=u[0].length,f==r.length)break;let d=r[f++];if(f==r.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+r);l=r.slice(f)}let a=s.length-1,h=s[a];if(!h)throw new RangeError("Invalid path: "+r);let c=new r2(i,o,a>0?s.slice(0,a):null);e[h]=c.sort(e[h])}}return pp.add(e)}const pp=new ne;class r2{constructor(e,t,i,r){this.tags=e,this.mode=t,this.context=i,this.next=r}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function gp(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let l of s)for(let a of l.set){let h=t[a.id];if(h){o=o?o+" "+h:h;break}}return o},scope:i}}function s2(n,e){let t=null;for(let i of n){let r=i.style(e);r&&(t=t?t+" "+r:r)}return t}function o2(n,e,t,i=0,r=n.length){let s=new l2(i,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),i,r,"",s.highlighters),s.flush(r)}class l2{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,r,s){let{type:o,from:l,to:a}=e;if(l>=i||a<=t)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let h=r,c=o.prop(pp),f=!1;for(;c;){if(!c.context||e.matchContext(c.context)){let d=s2(s,c.tags);d&&(h&&(h+=" "),h+=d,c.mode==1?r+=(r?" ":"")+d:c.mode==0&&(f=!0));break}c=c.next}if(this.startSpan(e.from,h),f)return;let u=e.tree&&e.tree.prop(ne.mounted);if(u&&u.overlay){let d=e.node.enter(u.overlay[0].from+l,1),p=this.highlighters.filter(x=>!x.scope||x.scope(u.tree.type)),g=e.firstChild();for(let x=0,Q=l;;x++){let m=x<u.overlay.length?u.overlay[x]:null,b=m?m.from+l:a,y=Math.max(t,Q),w=Math.min(i,b);if(y<w&&g)for(;e.from<w&&(this.highlightRange(e,y,w,r,s),this.startSpan(Math.min(i,e.to),h),!(e.to>=b||!e.nextSibling())););if(!m||b>i)break;Q=m.to+l,Q>t&&(this.highlightRange(d.cursor(),Math.max(t,m.from+l),Math.min(i,Q),r,p),this.startSpan(Q,h))}g&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,r,s),this.startSpan(Math.min(i,e.to),h)}while(e.nextSibling());e.parent()}}}const B=Bt.define,us=B(),gi=B(),Lf=B(gi),zf=B(gi),mi=B(),ds=B(mi),yl=B(mi),Dt=B(),zi=B(Dt),Ct=B(),It=B(),La=B(),tr=B(La),ps=B(),S={comment:us,lineComment:B(us),blockComment:B(us),docComment:B(us),name:gi,variableName:B(gi),typeName:Lf,tagName:B(Lf),propertyName:zf,attributeName:B(zf),className:B(gi),labelName:B(gi),namespace:B(gi),macroName:B(gi),literal:mi,string:ds,docString:B(ds),character:B(ds),attributeValue:B(ds),number:yl,integer:B(yl),float:B(yl),bool:B(mi),regexp:B(mi),escape:B(mi),color:B(mi),url:B(mi),keyword:Ct,self:B(Ct),null:B(Ct),atom:B(Ct),unit:B(Ct),modifier:B(Ct),operatorKeyword:B(Ct),controlKeyword:B(Ct),definitionKeyword:B(Ct),moduleKeyword:B(Ct),operator:It,derefOperator:B(It),arithmeticOperator:B(It),logicOperator:B(It),bitwiseOperator:B(It),compareOperator:B(It),updateOperator:B(It),definitionOperator:B(It),typeOperator:B(It),controlOperator:B(It),punctuation:La,separator:B(La),bracket:tr,angleBracket:B(tr),squareBracket:B(tr),paren:B(tr),brace:B(tr),content:Dt,heading:zi,heading1:B(zi),heading2:B(zi),heading3:B(zi),heading4:B(zi),heading5:B(zi),heading6:B(zi),contentSeparator:B(Dt),list:B(Dt),quote:B(Dt),emphasis:B(Dt),strong:B(Dt),link:B(Dt),monospace:B(Dt),strikethrough:B(Dt),inserted:B(),deleted:B(),changed:B(),invalid:B(),meta:ps,documentMeta:B(ps),annotation:B(ps),processingInstruction:B(ps),definition:Bt.defineModifier(),constant:Bt.defineModifier(),function:Bt.defineModifier(),standard:Bt.defineModifier(),local:Bt.defineModifier(),special:Bt.defineModifier()};gp([{tag:S.link,class:"tok-link"},{tag:S.heading,class:"tok-heading"},{tag:S.emphasis,class:"tok-emphasis"},{tag:S.strong,class:"tok-strong"},{tag:S.keyword,class:"tok-keyword"},{tag:S.atom,class:"tok-atom"},{tag:S.bool,class:"tok-bool"},{tag:S.url,class:"tok-url"},{tag:S.labelName,class:"tok-labelName"},{tag:S.inserted,class:"tok-inserted"},{tag:S.deleted,class:"tok-deleted"},{tag:S.literal,class:"tok-literal"},{tag:S.string,class:"tok-string"},{tag:S.number,class:"tok-number"},{tag:[S.regexp,S.escape,S.special(S.string)],class:"tok-string2"},{tag:S.variableName,class:"tok-variableName"},{tag:S.local(S.variableName),class:"tok-variableName tok-local"},{tag:S.definition(S.variableName),class:"tok-variableName tok-definition"},{tag:S.special(S.variableName),class:"tok-variableName2"},{tag:S.definition(S.propertyName),class:"tok-propertyName tok-definition"},{tag:S.typeName,class:"tok-typeName"},{tag:S.namespace,class:"tok-namespace"},{tag:S.className,class:"tok-className"},{tag:S.macroName,class:"tok-macroName"},{tag:S.propertyName,class:"tok-propertyName"},{tag:S.operator,class:"tok-operator"},{tag:S.comment,class:"tok-comment"},{tag:S.meta,class:"tok-meta"},{tag:S.invalid,class:"tok-invalid"},{tag:S.punctuation,class:"tok-punctuation"}]);var wl;const Rr=new ne;function a2(n){return G.define({combine:n?e=>e.concat(n):void 0})}class $t{constructor(e,t,i=[]){this.data=e,le.prototype.hasOwnProperty("tree")||Object.defineProperty(le.prototype,"tree",{get(){return Re(this)}}),this.parser=t,this.extension=[Ei.of(this),le.languageData.of((r,s,o)=>r.facet(_f(r,s,o)))].concat(i)}isActiveAt(e,t,i=-1){return _f(e,t,i)==this.data}findRegions(e){let t=e.facet(Ei);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(Rr)==this.data){i.push({from:o,to:o+s.length});return}let l=s.prop(ne.mounted);if(l){if(l.tree.prop(Rr)==this.data){if(l.overlay)for(let a of l.overlay)i.push({from:a.from+o,to:a.to+o});else i.push({from:o,to:o+s.length});return}else if(l.overlay){let a=i.length;if(r(l.tree,l.overlay[0].from+o),i.length>a)return}}for(let a=0;a<s.children.length;a++){let h=s.children[a];h instanceof Ae&&r(h,s.positions[a]+o)}};return r(Re(e),0),i}get allowsNesting(){return!0}}$t.setState=K.define();function _f(n,e,t){let i=n.facet(Ei);if(!i)return null;let r=i.data;if(i.allowsNesting)for(let s=Re(n).topNode;s;s=s.enter(e,t,ze.ExcludeBuffers))r=s.type.prop(Rr)||r;return r}class no extends $t{constructor(e,t){super(e,t),this.parser=t}static define(e){let t=a2(e.languageData);return new no(t,e.parser.configure({props:[Rr.add(i=>i.isTop?t:void 0)]}))}configure(e){return new no(this.data,this.parser.configure(e))}get allowsNesting(){return this.parser.hasWrappers()}}function Re(n){let e=n.field($t.state,!1);return e?e.tree:Ae.empty}class h2{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let ir=null;class ro{constructor(e,t,i=[],r,s,o,l,a){this.parser=e,this.state=t,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new ro(e,t,[],Ae.empty,0,i,[],null)}startParse(){return this.parser.startParse(new h2(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ae.empty&&this.isDone(t!=null?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Yi.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t!=null?t:this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Yi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=ir;ir=this;try{return e()}finally{ir=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Uf(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((h,c,f,u)=>a.push({fromA:h,toA:c,fromB:f,toB:u})),i=Yi.applyChanges(i,a),r=Ae.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let h of this.skipped){let c=e.mapPos(h.from,1),f=e.mapPos(h.to,-1);c<f&&l.push({from:c,to:f})}}}return new ro(this.parser,t,i,r,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=Uf(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends fp{createParse(t,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let a=ir;if(a){for(let h of r)a.tempSkipped.push(h);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new Ae(st.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return ir}}function Uf(n,e,t){return Yi.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class En{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new En(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=ro.create(e.facet(Ei).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new En(i)}}$t.state=Ce.define({create:En.init,update(n,e){for(let t of e.effects)if(t.is($t.setState))return t.value;return e.startState.facet(Ei)!=e.state.facet(Ei)?En.init(e.state):n.apply(e)}});let mp=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback!="undefined"&&(mp=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:500-100})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Sl=typeof navigator!="undefined"&&((wl=navigator.scheduling)===null||wl===void 0?void 0:wl.isInputPending)?()=>navigator.scheduling.isInputPending():null,c2=Pe.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field($t.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field($t.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=mp(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field($t.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Sl?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<r&&i.doc.length>r+1e3,a=s.context.work(()=>Sl&&Sl()||Date.now()>o,r+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:$t.setState.of(new En(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>dt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ei=G.define({combine(n){return n.length?n[0]:null},enables:[$t.state,c2]});class f2{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const u2=G.define(),Xr=G.define({combine:n=>{if(!n.length)return"  ";if(!/^(?: +|\t+)$/.test(n[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return n[0]}});function so(n){let e=n.facet(Xr);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function Cr(n,e){let t="",i=n.tabSize;if(n.facet(Xr).charCodeAt(0)==9)for(;e>=i;)t+="	",e-=i;for(let r=0;r<e;r++)t+=" ";return t}function Wh(n,e){n instanceof le&&(n=new Wo(n));for(let i of n.state.facet(u2)){let r=i(n,e);if(r!=null)return r}let t=Re(n.state);return t?d2(n,t,e):null}class Wo{constructor(e,t={}){this.state=e,this.options=t,this.unit=so(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,t);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return zr(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Op=new ne;function d2(n,e,t){return xp(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,n)}function p2(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function g2(n){let e=n.type.prop(Op);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(ne.closedBy))){let r=n.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>bp(o,!0,1,void 0,s&&!p2(o)?r.from:void 0)}return n.parent==null?m2:null}function xp(n,e,t){for(;n;n=n.parent){let i=g2(n);if(i)return i(Dh.create(t,e,n))}return null}function m2(){return 0}class Dh extends Wo{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.node=i}static create(e,t,i){return new Dh(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(O2(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?xp(e,this.pos,this.base):0}}function O2(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function x2(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let r=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==i)return null;if(!a.type.isSkipped)return a.from<o?t:null;l=a.to}}function b2({closing:n,align:e=!0,units:t=1}){return i=>bp(i,e,t,n)}function bp(n,e,t,i,r){let s=n.textAfter,o=s.match(/^\s*/)[0].length,l=i&&s.slice(o,o+i.length)==i||r==n.pos+o,a=e?x2(n):null;return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}const y2=n=>n.baseIndent;function kl({except:n,units:e=1}={}){return t=>{let i=n&&n.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const w2=200;function S2(){return le.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,r=t.lineAt(i);if(i>r.from+w2)return n;let s=t.sliceString(r.from,i);if(!e.some(h=>h.test(s)))return n;let{state:o}=n,l=-1,a=[];for(let{head:h}of o.selection.ranges){let c=o.doc.lineAt(h);if(c.from==l)continue;l=c.from;let f=Wh(o,c.from);if(f==null)continue;let u=/^\s*/.exec(c.text)[0],d=Cr(o,f);u!=d&&a.push({from:c.from,to:c.from+u.length,insert:d})}return a.length?[n,{changes:a,sequential:!0}]:n})}const yp=G.define(),wp=new ne;function k2(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function $2(n,e,t){let i=Re(n);if(i.length<t)return null;let r=i.resolveInner(t),s=null;for(let o=r;o;o=o.parent){if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let l=o.type.prop(wp);if(l&&(o.to<i.length-50||i.length==n.doc.length||!v2(o))){let a=l(o,n);a&&a.from<=t&&a.from>=e&&a.to>t&&(s=a)}}return s}function v2(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function oo(n,e,t){for(let i of n.facet(yp)){let r=i(n,e,t);if(r)return r}return $2(n,e,t)}function Sp(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const Do=K.define({map:Sp}),Zr=K.define({map:Sp});function kp(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const Ki=Ce.define({create(){return j.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)t.is(Do)&&!Q2(n,t.value.from,t.value.to)?n=n.update({add:[E2.range(t.value.from,t.value.to)]}):t.is(Zr)&&(n=n.update({filter:(i,r)=>t.value.from!=i||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:i}=e.selection.main;n.between(i,i,(r,s)=>{r<i&&s>i&&(t=!0)}),t&&(n=n.update({filterFrom:i,filterTo:i,filter:(r,s)=>s<=i||r>=i}))}return n},provide:n=>Y.decorations.from(n)});function lo(n,e,t){var i;let r=null;return(i=n.field(Ki,!1))===null||i===void 0||i.between(e,t,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function Q2(n,e,t){let i=!1;return n.between(e,e,(r,s)=>{r==e&&s==t&&(i=!0)}),i}function $p(n,e){return n.field(Ki,!1)?e:e.concat(K.appendConfig.of(Tp()))}const T2=n=>{for(let e of kp(n)){let t=oo(n.state,e.from,e.to);if(t)return n.dispatch({effects:$p(n.state,[Do.of(t),vp(n,t)])}),!0}return!1},P2=n=>{if(!n.state.field(Ki,!1))return!1;let e=[];for(let t of kp(n)){let i=lo(n.state,t.from,t.to);i&&e.push(Zr.of(i),vp(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function vp(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,r=n.state.doc.lineAt(e.to).number;return Y.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${r}.`)}const A2=n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let r=n.lineBlockAt(i),s=oo(e,r.from,r.to);s&&t.push(Do.of(s)),i=(s?n.lineBlockAt(s.to):r).to+1}return t.length&&n.dispatch({effects:$p(n.state,t)}),!!t.length},R2=n=>{let e=n.state.field(Ki,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,r)=>{t.push(Zr.of({from:i,to:r}))}),n.dispatch({effects:t}),!0},C2=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:T2},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:P2},{key:"Ctrl-Alt-[",run:A2},{key:"Ctrl-Alt-]",run:R2}],I2={placeholderDOM:null,placeholderText:"\u2026"},Qp=G.define({combine(n){return hi(n,I2)}});function Tp(n){let e=[Ki,M2];return n&&e.push(Qp.of(n)),e}const E2=j.replace({widget:new class extends At{toDOM(n){let{state:e}=n,t=e.facet(Qp),i=s=>{let o=n.lineBlockAt(n.posAtDOM(s.target)),l=lo(n.state,o.from,o.to);l&&n.dispatch({effects:Zr.of(l)}),s.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(n,i);let r=document.createElement("span");return r.textContent=t.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=i,r}}}),W2={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{}};class $l extends li{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function D2(n={}){let e=Object.assign(Object.assign({},W2),n),t=new $l(e,!0),i=new $l(e,!1),r=Pe.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Ei)!=o.state.facet(Ei)||o.startState.field(Ki,!1)!=o.state.field(Ki,!1)||Re(o.startState)!=Re(o.state))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new Ai;for(let a of o.viewportLineBlocks){let h=lo(o.state,a.from,a.to)?i:oo(o.state,a.from,a.to)?t:null;h&&l.add(a.from,a.from,h)}return l.finish()}}),{domEventHandlers:s}=e;return[r,_w({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(r))===null||l===void 0?void 0:l.markers)||he.empty},initialSpacer(){return new $l(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let h=lo(o.state,l.from,l.to);if(h)return o.dispatch({effects:Zr.of(h)}),!0;let c=oo(o.state,l.from,l.to);return c?(o.dispatch({effects:Do.of(c)}),!0):!1}})}),Tp()]}const M2=Y.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Mo{constructor(e,t){let i;function r(l){let a=Ri.newName();return(i||(i=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof $t?l=>l.prop(Rr)==o.data:o?l=>l==o:void 0,this.style=gp(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=i?new Ri(i):null,this.themeType=t.themeType}static define(e,t){return new Mo(e,t||{})}}const za=G.define(),Pp=G.define({combine(n){return n.length?[n[0]]:null}});function vl(n){let e=n.facet(za);return e.length?e:n.facet(Pp)}function B2(n,e){let t=[z2],i;return n instanceof Mo&&(n.module&&t.push(Y.styleModule.of(n.module)),i=n.themeType),e!=null&&e.fallback?t.push(Pp.of(n)):i?t.push(za.computeN([Y.darkTheme],r=>r.facet(Y.darkTheme)==(i=="dark")?[n]:[])):t.push(za.of(n)),t}class L2{constructor(e){this.markCache=Object.create(null),this.tree=Re(e.state),this.decorations=this.buildDeco(e,vl(e.state))}update(e){let t=Re(e.state),i=vl(e.state),r=i!=vl(e.startState);t.length<e.view.viewport.to&&!r&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i))}buildDeco(e,t){if(!t||!this.tree.length)return j.none;let i=new Ai;for(let{from:r,to:s}of e.visibleRanges)o2(this.tree,t,(o,l,a)=>{i.add(o,l,this.markCache[a]||(this.markCache[a]=j.mark({class:a})))},r,s);return i.finish()}}const z2=Xn.high(Pe.fromClass(L2,{decorations:n=>n.decorations})),_2=Mo.define([{tag:S.meta,color:"#7a757a"},{tag:S.link,textDecoration:"underline"},{tag:S.heading,textDecoration:"underline",fontWeight:"bold"},{tag:S.emphasis,fontStyle:"italic"},{tag:S.strong,fontWeight:"bold"},{tag:S.strikethrough,textDecoration:"line-through"},{tag:S.keyword,color:"#708"},{tag:[S.atom,S.bool,S.url,S.contentSeparator,S.labelName],color:"#219"},{tag:[S.literal,S.inserted],color:"#164"},{tag:[S.string,S.deleted],color:"#a11"},{tag:[S.regexp,S.escape,S.special(S.string)],color:"#e40"},{tag:S.definition(S.variableName),color:"#00f"},{tag:S.local(S.variableName),color:"#30a"},{tag:[S.typeName,S.namespace],color:"#085"},{tag:S.className,color:"#167"},{tag:[S.special(S.variableName),S.macroName],color:"#256"},{tag:S.definition(S.propertyName),color:"#00c"},{tag:S.comment,color:"#940"},{tag:S.invalid,color:"#f00"}]),U2=Y.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Ap=1e4,Rp="()[]{}",Cp=G.define({combine(n){return hi(n,{afterCursor:!0,brackets:Rp,maxScanDistance:Ap,renderMatch:Z2})}}),N2=j.mark({class:"cm-matchingBracket"}),X2=j.mark({class:"cm-nonmatchingBracket"});function Z2(n){let e=[],t=n.matched?N2:X2;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const j2=Ce.define({create(){return j.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet(Cp);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=Nt(e.state,r.head,-1,i)||r.head>0&&Nt(e.state,r.head-1,1,i)||i.afterCursor&&(Nt(e.state,r.head,1,i)||r.head<e.state.doc.length&&Nt(e.state,r.head+1,-1,i));s&&(t=t.concat(i.renderMatch(s,e.state)))}return j.set(t,!0)},provide:n=>Y.decorations.from(n)}),G2=[j2,U2];function q2(n={}){return[Cp.of(n),G2]}function _a(n,e,t){let i=n.prop(e<0?ne.openedBy:ne.closedBy);if(i)return i;if(n.name.length==1){let r=t.indexOf(n.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function Nt(n,e,t,i={}){let r=i.maxScanDistance||Ap,s=i.brackets||Rp,o=Re(n),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let h=_a(a.type,t,s);if(h&&a.from<a.to)return F2(n,e,t,a,h,s)}return V2(n,e,t,o,l.type,r,s)}function F2(n,e,t,i,r,s){let o=i.parent,l={from:i.from,to:i.to},a=0,h=o==null?void 0:o.cursor();if(h&&(t<0?h.childBefore(i.from):h.childAfter(i.to)))do if(t<0?h.to<=i.from:h.from>=i.to){if(a==0&&r.indexOf(h.type.name)>-1&&h.from<h.to)return{start:l,end:{from:h.from,to:h.to},matched:!0};if(_a(h.type,t,s))a++;else if(_a(h.type,-t,s)&&(a--,a==0))return{start:l,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}while(t<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function V2(n,e,t,i,r,s,o){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let h={from:t<0?e-1:e,to:t>0?e+1:e},c=n.doc.iterRange(e,t>0?n.doc.length:0),f=0;for(let u=0;!c.next().done&&u<=s;){let d=c.value;t<0&&(u+=d.length);let p=e+u*t;for(let g=t>0?0:d.length-1,x=t>0?d.length:-1;g!=x;g+=t){let Q=o.indexOf(d[g]);if(!(Q<0||i.resolve(p+g,1).type!=r))if(Q%2==0==t>0)f++;else{if(f==1)return{start:h,end:{from:p+g,to:p+g+1},matched:Q>>1==a>>1};f--}}t>0&&(u+=d.length)}return c.done?{start:h,matched:!1}:null}const Y2=Object.create(null),Nf=[st.none],Xf=[],H2=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])H2[n]=J2(Y2,e);function Ql(n,e){Xf.indexOf(n)>-1||(Xf.push(n),console.warn(e))}function J2(n,e){let t=null;for(let s of e.split(".")){let o=n[s]||S[s];o?typeof o=="function"?t?t=o(t):Ql(s,`Modifier ${s} used at start of tag`):t?Ql(s,`Tag ${s} used as modifier`):t=o:Ql(s,`Unknown highlighting tag ${s}`)}if(!t)return 0;let i=e.replace(/ /g,"_"),r=st.define({id:Nf.length,name:i,props:[dp({[i]:t})]});return Nf.push(r),r.id}const K2=n=>{let e=Bh(n.state);return e.line?eS(n):e.block?iS(n):!1};function Mh(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let r=n(e,t);return r?(i(t.update(r)),!0):!1}}const eS=Mh(sS,0),tS=Mh(Ip,0),iS=Mh((n,e)=>Ip(n,e,rS(e)),0);function Bh(n,e=n.selection.main.head){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const nr=50;function nS(n,{open:e,close:t},i,r){let s=n.sliceDoc(i-nr,i),o=n.sliceDoc(r,r+nr),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,h=s.length-l;if(s.slice(h-e.length,h)==e&&o.slice(a,a+t.length)==t)return{open:{pos:i-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let c,f;r-i<=2*nr?c=f=n.sliceDoc(i,r):(c=n.sliceDoc(i,i+nr),f=n.sliceDoc(r-nr,r));let u=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(f)[0].length,p=f.length-d-t.length;return c.slice(u,u+e.length)==e&&f.slice(p,p+t.length)==t?{open:{pos:i+u+e.length,margin:/\s/.test(c.charAt(u+e.length))?1:0},close:{pos:r-d-t.length,margin:/\s/.test(f.charAt(p-1))?1:0}}:null}function rS(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),r=t.to<=i.to?i:n.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from,to:r.to})}return e}function Ip(n,e,t=e.selection.ranges){let i=t.map(s=>Bh(e,s.from).block);if(!i.every(s=>s))return null;let r=t.map((s,o)=>nS(e,i[o],s.from,s.to));if(n!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(n!=1&&r.some(s=>s)){let s=[];for(let o=0,l;o<r.length;o++)if(l=r[o]){let a=i[o],{open:h,close:c}=l;s.push({from:h.pos-a.open.length,to:h.pos+h.margin},{from:c.pos-c.margin,to:c.pos+a.close.length})}return{changes:s}}return null}function sS(n,e,t=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of t){let l=i.length,a=1e9;for(let h=s;h<=o;){let c=e.doc.lineAt(h);if(c.from>r&&(s==o||o>c.from)){r=c.from;let f=Bh(e,h).line;if(!f)continue;let u=/^\s*/.exec(c.text)[0].length,d=u==c.length,p=c.text.slice(u,u+f.length)==f?u:-1;u<c.text.length&&u<a&&(a=u),i.push({line:c,comment:p,token:f,indent:u,empty:d,single:!1})}h=c.to+1}if(a<1e9)for(let h=l;h<i.length;h++)i[h].indent<i[h].line.text.length&&(i[h].indent=a);i.length==l+1&&(i[l].single=!0)}if(n!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:h,empty:c,single:f}of i)(f||!c)&&s.push({from:l.from+h,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of i)if(l>=0){let h=o.from+l,c=h+a.length;o.text[c-o.from]==" "&&c++,s.push({from:h,to:c})}return{changes:s}}return null}const Ua=Mi.define(),oS=Mi.define(),lS=G.define(),Ep=G.define({combine(n){return hi(n,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function aS(n){let e=0;return n.iterChangedRanges((t,i)=>e=i),e}const Wp=Ce.define({create(){return Xt.empty},update(n,e){let t=e.state.facet(Ep),i=e.annotation(Ua);if(i){let a=e.docChanged?P.single(aS(e.changes)):void 0,h=nt.fromTransaction(e,a),c=i.side,f=c==0?n.undone:n.done;return h?f=ao(f,f.length,t.minDepth,h):f=Lp(f,e.startState.selection),new Xt(c==0?i.rest:f,c==0?f:i.rest)}let r=e.annotation(oS);if((r=="full"||r=="before")&&(n=n.isolate()),e.annotation(Ee.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=nt.fromTransaction(e),o=e.annotation(Ee.time),l=e.annotation(Ee.userEvent);return s?n=n.addChanges(s,o,l,t.newGroupDelay,t.minDepth):e.selection&&(n=n.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(r=="full"||r=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Xt(n.done.map(nt.fromJSON),n.undone.map(nt.fromJSON))}});function hS(n={}){return[Wp,Ep.of(n),Y.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?Dp:e.inputType=="historyRedo"?Mp:null;return i?(e.preventDefault(),i(t)):!1}})]}function Bo(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let r=t.field(Wp,!1);if(!r)return!1;let s=r.pop(n,t,e);return s?(i(s),!0):!1}}const Dp=Bo(0,!1),Mp=Bo(1,!1),cS=Bo(0,!0),fS=Bo(1,!0);class nt{constructor(e,t,i,r,s){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new nt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new nt(e.changes&&Ie.fromJSON(e.changes),[],e.mapped&&ti.fromJSON(e.mapped),e.startSelection&&P.fromJSON(e.startSelection),e.selectionsAfter.map(P.fromJSON))}static fromTransaction(e,t){let i=bt;for(let r of e.startState.facet(lS)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new nt(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,bt)}static selection(e){return new nt(void 0,bt,void 0,void 0,e)}}function ao(n,e,t,i){let r=e+1>t+20?e-t-1:0,s=n.slice(r,e);return s.push(i),s}function uS(n,e){let t=[],i=!1;return n.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,l)=>{for(let a=0;a<t.length;){let h=t[a++],c=t[a++];l>=h&&o<=c&&(i=!0)}}),i}function dS(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function Bp(n,e){return n.length?e.length?n.concat(e):n:e}const bt=[],pS=200;function Lp(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-pS));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),ao(n,n.length-1,1e9,t.setSelAfter(i)))}else return[nt.selection([e])]}function gS(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Tl(n,e){if(!n.length)return n;let t=n.length,i=bt;for(;t;){let r=mS(n[t-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=n.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,i=r.selectionsAfter}return i.length?[nt.selection(i)]:bt}function mS(n,e,t){let i=Bp(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):bt,t);if(!n.changes)return nt.selection(i);let r=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new nt(r,K.mapEffects(n.effects,e),o,n.startSelection.map(s),i)}const OS=/^(input\.type|delete)($|\.)/;class Xt{constructor(e,t,i=0,r=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new Xt(this.done,this.undone):this}addChanges(e,t,i,r,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!i||OS.test(i))&&(!l.selectionsAfter.length&&t-this.prevTime<r&&uS(l.changes,e.changes)||i=="input.type.compose")?o=ao(o,o.length-1,s,new nt(e.changes.compose(l.changes),Bp(e.effects,l.effects),l.mapped,l.startSelection,bt)):o=ao(o,o.length,s,e),new Xt(o,bt,t,i)}addSelection(e,t,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:bt;return s.length>0&&t-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&dS(s[s.length-1],e)?this:new Xt(Lp(this.done,e),this.undone,t,i)}addMapping(e){return new Xt(Tl(this.done,e),Tl(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1];if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Ua.of({side:e,rest:gS(r)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=r.length==1?bt:r.slice(0,r.length-1);return s.mapped&&(o=Tl(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Ua.of({side:e,rest:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Xt.empty=new Xt(bt,bt);const xS=[{key:"Mod-z",run:Dp,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Mp,preventDefault:!0},{key:"Mod-u",run:cS,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:fS,preventDefault:!0}];function Zn(n,e){return P.create(n.ranges.map(e),n.mainIndex)}function Gt(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ci({state:n,dispatch:e},t){let i=Zn(n.selection,t);return i.eq(n.selection)?!1:(e(Gt(n,i)),!0)}function Lo(n,e){return P.cursor(e?n.to:n.from)}function zp(n,e){return ci(n,t=>t.empty?n.moveByChar(t,e):Lo(t,e))}function yt(n){return n.textDirectionAt(n.state.selection.main.head)==ye.LTR}const _p=n=>zp(n,!yt(n)),Up=n=>zp(n,yt(n));function Np(n,e){return ci(n,t=>t.empty?n.moveByGroup(t,e):Lo(t,e))}const bS=n=>Np(n,!yt(n)),yS=n=>Np(n,yt(n));function wS(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function zo(n,e,t){let i=Re(n).resolveInner(e.head),r=t?ne.closedBy:ne.openedBy;for(let a=e.head;;){let h=t?i.childAfter(a):i.childBefore(a);if(!h)break;wS(n,h,r)?i=h:a=t?h.to:h.from}let s=i.type.prop(r),o,l;return s&&(o=t?Nt(n,i.from,1):Nt(n,i.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?i.to:i.from,P.cursor(l,t?-1:1)}const SS=n=>ci(n,e=>zo(n.state,e,!yt(n))),kS=n=>ci(n,e=>zo(n.state,e,yt(n)));function Xp(n,e){return ci(n,t=>{if(!t.empty)return Lo(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const Zp=n=>Xp(n,!1),jp=n=>Xp(n,!0);function Gp(n,e){let{state:t}=n,i=Zn(t.selection,l=>l.empty?n.moveVertically(l,e,Math.min(n.dom.clientHeight,innerHeight)):Lo(l,e));if(i.eq(t.selection))return!1;let r=n.coordsAtPos(t.selection.main.head),s=n.scrollDOM.getBoundingClientRect(),o;return r&&r.top>s.top&&r.bottom<s.bottom&&r.top-s.top<=n.scrollDOM.scrollHeight-n.scrollDOM.scrollTop-n.scrollDOM.clientHeight&&(o=Y.scrollIntoView(i.main.head,{y:"start",yMargin:r.top-s.top})),n.dispatch(Gt(t,i),{effects:o}),!0}const Zf=n=>Gp(n,!1),Na=n=>Gp(n,!0);function _o(n,e,t){let i=n.lineBlockAt(e.head),r=n.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?i.to:i.from)&&(r=n.moveToLineBoundary(e,t,!1)),!t&&r.head==i.from&&i.length){let s=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=P.cursor(i.from+s))}return r}const jf=n=>ci(n,e=>_o(n,e,!0)),Gf=n=>ci(n,e=>_o(n,e,!1)),$S=n=>ci(n,e=>P.cursor(n.lineBlockAt(e.head).from,1)),vS=n=>ci(n,e=>P.cursor(n.lineBlockAt(e.head).to,-1));function QS(n,e,t){let i=!1,r=Zn(n.selection,s=>{let o=Nt(n,s.head,-1)||Nt(n,s.head,1)||s.head>0&&Nt(n,s.head-1,1)||s.head<n.doc.length&&Nt(n,s.head+1,-1);if(!o||!o.end)return s;i=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return t?P.range(s.anchor,l):P.cursor(l)});return i?(e(Gt(n,r)),!0):!1}const TS=({state:n,dispatch:e})=>QS(n,e,!1);function qt(n,e){let t=Zn(n.state.selection,i=>{let r=e(i);return P.range(i.anchor,r.head,r.goalColumn)});return t.eq(n.state.selection)?!1:(n.dispatch(Gt(n.state,t)),!0)}function qp(n,e){return qt(n,t=>n.moveByChar(t,e))}const Fp=n=>qp(n,!yt(n)),Vp=n=>qp(n,yt(n));function Yp(n,e){return qt(n,t=>n.moveByGroup(t,e))}const PS=n=>Yp(n,!yt(n)),AS=n=>Yp(n,yt(n)),RS=n=>qt(n,e=>zo(n.state,e,!yt(n))),CS=n=>qt(n,e=>zo(n.state,e,yt(n)));function Hp(n,e){return qt(n,t=>n.moveVertically(t,e))}const Jp=n=>Hp(n,!1),Kp=n=>Hp(n,!0);function eg(n,e){return qt(n,t=>n.moveVertically(t,e,Math.min(n.dom.clientHeight,innerHeight)))}const qf=n=>eg(n,!1),Ff=n=>eg(n,!0),Vf=n=>qt(n,e=>_o(n,e,!0)),Yf=n=>qt(n,e=>_o(n,e,!1)),IS=n=>qt(n,e=>P.cursor(n.lineBlockAt(e.head).from)),ES=n=>qt(n,e=>P.cursor(n.lineBlockAt(e.head).to)),Hf=({state:n,dispatch:e})=>(e(Gt(n,{anchor:0})),!0),Jf=({state:n,dispatch:e})=>(e(Gt(n,{anchor:n.doc.length})),!0),Kf=({state:n,dispatch:e})=>(e(Gt(n,{anchor:n.selection.main.anchor,head:0})),!0),eu=({state:n,dispatch:e})=>(e(Gt(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),WS=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),DS=({state:n,dispatch:e})=>{let t=Xo(n).map(({from:i,to:r})=>P.range(i,Math.min(r+1,n.doc.length)));return e(n.update({selection:P.create(t),userEvent:"select"})),!0},MS=({state:n,dispatch:e})=>{let t=Zn(n.selection,i=>{var r;let s=Re(n).resolveInner(i.head,1);for(;!(s.from<i.from&&s.to>=i.to||s.to>i.to&&s.from<=i.from||!(!((r=s.parent)===null||r===void 0)&&r.parent));)s=s.parent;return P.range(s.to,s.from)});return e(Gt(n,t)),!0},BS=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=P.create([t.main]):t.main.empty||(i=P.create([P.cursor(t.main.head)])),i?(e(Gt(n,i)),!0):!1};function Uo({state:n,dispatch:e},t){if(n.readOnly)return!1;let i="delete.selection",r=n.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=t(o);a<o?i="delete.backward":a>o&&(i="delete.forward"),o=Math.min(o,a),l=Math.max(l,a)}return o==l?{range:s}:{changes:{from:o,to:l},range:P.cursor(o)}});return r.changes.empty?!1:(e(n.update(r,{scrollIntoView:!0,userEvent:i})),!0)}function No(n,e,t){if(n instanceof Y)for(let i of n.state.facet(Y.atomicRanges).map(r=>r(n)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}const tg=(n,e)=>Uo(n,t=>{let{state:i}=n,r=i.doc.lineAt(t),s,o;if(!e&&t>r.from&&t<r.from+200&&!/[^ \t]/.test(s=r.text.slice(0,t-r.from))){if(s[s.length-1]=="	")return t-1;let l=zr(s,i.tabSize),a=l%so(i)||so(i);for(let h=0;h<a&&s[s.length-1-h]==" ";h++)t--;o=t}else o=ft(r.text,t-r.from,e,e)+r.from,o==t&&r.number!=(e?i.doc.lines:1)&&(o+=e?1:-1);return No(n,o,e)}),Xa=n=>tg(n,!1),ig=n=>tg(n,!0),ng=(n,e)=>Uo(n,t=>{let i=t,{state:r}=n,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let l=null;;){if(i==(e?s.to:s.from)){i==t&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let a=ft(s.text,i-s.from,e)+s.from,h=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),c=o(h);if(l!=null&&c!=l)break;(h!=" "||i!=t)&&(l=c),i=a}return No(n,i,e)}),rg=n=>ng(n,!1),LS=n=>ng(n,!0),sg=n=>Uo(n,e=>{let t=n.lineBlockAt(e).to;return No(n,e<t?t:Math.min(n.state.doc.length,e+1),!0)}),zS=n=>Uo(n,e=>{let t=n.lineBlockAt(e).from;return No(n,e>t?t:Math.max(0,e-1),!1)}),_S=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:ae.of(["",""])},range:P.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},US=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let r=i.from,s=n.doc.lineAt(r),o=r==s.from?r-1:ft(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:ft(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:n.doc.slice(r,l).append(n.doc.slice(o,r))},range:P.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Xo(n){let e=[],t=-1;for(let i of n.selection.ranges){let r=n.doc.lineAt(i.from),s=n.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=n.doc.lineAt(i.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});t=s.number+1}return e}function og(n,e,t){if(n.readOnly)return!1;let i=[],r=[];for(let s of Xo(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let a of s.ranges)r.push(P.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let a of s.ranges)r.push(P.range(a.anchor-l,a.head-l))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:P.create(r,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const NS=({state:n,dispatch:e})=>og(n,e,!1),XS=({state:n,dispatch:e})=>og(n,e,!0);function lg(n,e,t){if(n.readOnly)return!1;let i=[];for(let r of Xo(n))t?i.push({from:r.from,insert:n.doc.slice(r.from,r.to)+n.lineBreak}):i.push({from:r.to,insert:n.lineBreak+n.doc.slice(r.from,r.to)});return e(n.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const ZS=({state:n,dispatch:e})=>lg(n,e,!1),jS=({state:n,dispatch:e})=>lg(n,e,!0),GS=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Xo(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=Zn(e.selection,r=>n.moveVertically(r,!0)).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function qS(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Re(n).resolveInner(e),i=t.childBefore(e),r=t.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(ne.closedBy))&&s.indexOf(r.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(r.from).from?{from:i.to,to:r.from}:null}const FS=ag(!1),VS=ag(!0);function ag(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,l=e.doc.lineAt(s),a=!n&&s==o&&qS(e,s);n&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let h=new Wo(e,{simulateBreak:s,simulateDoubleBreak:!!a}),c=Wh(h,s);for(c==null&&(c=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let f=["",Cr(e,c)];return a&&f.push(Cr(e,h.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:ae.of(f)},range:P.cursor(s+1+f[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Lh(n,e){let t=-1;return n.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let l=n.doc.lineAt(o);l.number>t&&(i.empty||i.to>l.from)&&(e(l,r,i),t=l.number),o=l.to+1}let s=n.changes(r);return{changes:r,range:P.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const YS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new Wo(n,{overrideIndentation:s=>{let o=t[s];return o==null?-1:o}}),r=Lh(n,(s,o,l)=>{let a=Wh(i,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let h=/^\s*/.exec(s.text)[0],c=Cr(n,a);(h!=c||l.from<s.from+h.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+h.length,insert:c}))});return r.changes.empty||e(n.update(r,{userEvent:"indent"})),!0},HS=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Lh(n,(t,i)=>{i.push({from:t.from,insert:n.facet(Xr)})}),{userEvent:"input.indent"})),!0),JS=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Lh(n,(t,i)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=zr(r,n.tabSize),o=0,l=Cr(n,Math.max(0,s-so(n)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),KS=[{key:"Ctrl-b",run:_p,shift:Fp,preventDefault:!0},{key:"Ctrl-f",run:Up,shift:Vp},{key:"Ctrl-p",run:Zp,shift:Jp},{key:"Ctrl-n",run:jp,shift:Kp},{key:"Ctrl-a",run:$S,shift:IS},{key:"Ctrl-e",run:vS,shift:ES},{key:"Ctrl-d",run:ig},{key:"Ctrl-h",run:Xa},{key:"Ctrl-k",run:sg},{key:"Ctrl-Alt-h",run:rg},{key:"Ctrl-o",run:_S},{key:"Ctrl-t",run:US},{key:"Ctrl-v",run:Na}],ek=[{key:"ArrowLeft",run:_p,shift:Fp,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:bS,shift:PS},{mac:"Cmd-ArrowLeft",run:Gf,shift:Yf},{key:"ArrowRight",run:Up,shift:Vp,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:yS,shift:AS},{mac:"Cmd-ArrowRight",run:jf,shift:Vf},{key:"ArrowUp",run:Zp,shift:Jp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Hf,shift:Kf},{mac:"Ctrl-ArrowUp",run:Zf,shift:qf},{key:"ArrowDown",run:jp,shift:Kp,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Jf,shift:eu},{mac:"Ctrl-ArrowDown",run:Na,shift:Ff},{key:"PageUp",run:Zf,shift:qf},{key:"PageDown",run:Na,shift:Ff},{key:"Home",run:Gf,shift:Yf,preventDefault:!0},{key:"Mod-Home",run:Hf,shift:Kf},{key:"End",run:jf,shift:Vf,preventDefault:!0},{key:"Mod-End",run:Jf,shift:eu},{key:"Enter",run:FS},{key:"Mod-a",run:WS},{key:"Backspace",run:Xa,shift:Xa},{key:"Delete",run:ig},{key:"Mod-Backspace",mac:"Alt-Backspace",run:rg},{key:"Mod-Delete",mac:"Alt-Delete",run:LS},{mac:"Mod-Backspace",run:zS},{mac:"Mod-Delete",run:sg}].concat(KS.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),tk=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:SS,shift:RS},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:kS,shift:CS},{key:"Alt-ArrowUp",run:NS},{key:"Shift-Alt-ArrowUp",run:ZS},{key:"Alt-ArrowDown",run:XS},{key:"Shift-Alt-ArrowDown",run:jS},{key:"Escape",run:BS},{key:"Mod-Enter",run:VS},{key:"Alt-l",mac:"Ctrl-l",run:DS},{key:"Mod-i",run:MS,preventDefault:!0},{key:"Mod-[",run:JS},{key:"Mod-]",run:HS},{key:"Mod-Alt-\\",run:YS},{key:"Shift-Mod-k",run:GS},{key:"Shift-Mod-\\",run:TS},{key:"Mod-/",run:K2},{key:"Alt-A",run:tS}].concat(ek);function Oe(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=t[i];typeof r=="string"?n.setAttribute(i,r):r!=null&&(n[i]=r)}e++}for(;e<arguments.length;e++)hg(n,arguments[e]);return n}function hg(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)hg(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}const tu=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Wn{constructor(e,t,i=0,r=e.length,s){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?o=>s(tu(o)):tu,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ze(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=bh(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Ot(e);let r=this.normalize(t);for(let s=0,o=i;;s++){let l=r.charCodeAt(s),a=this.match(l,o);if(a)return this.value=a,this;if(s==r.length-1)break;o==i&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t){let i=null;for(let r=0;r<this.matches.length;r+=2){let s=this.matches[r],o=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?i={from:this.matches[r+1],to:t+1}:(this.matches[r]++,o=!0)),o||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:t+1}:this.matches.push(1,t)),i}}typeof Symbol!="undefined"&&(Wn.prototype[Symbol.iterator]=function(){return this});const cg={from:-1,to:-1,match:/.*/.exec("")},zh="gm"+(/x/.unicode==null?"":"u");class fg{constructor(e,t,i,r=0,s=e.length){if(this.to=s,this.curLine="",this.done=!1,this.value=cg,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new ug(e,t,i,r,s);this.re=new RegExp(t,zh+(i!=null&&i.ignoreCase?"i":"")),this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=r,this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,r=i+t[0].length;if(this.matchPos=r+(i==r?1:0),i==this.curLine.length&&this.nextLine(),i<r||i>this.value.to)return this.value={from:i,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Pl=new WeakMap;class vn{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let r=Pl.get(e);if(!r||r.from>=i||r.to<=t){let l=new vn(t,e.sliceString(t,i));return Pl.set(e,l),l}if(r.from==t&&r.to==i)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<i&&(s+=e.sliceString(r.to,i)),Pl.set(e,new vn(o,s)),new vn(t,s.slice(t-o,i-o))}}class ug{constructor(e,t,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=cg,this.matchPos=r,this.re=new RegExp(t,zh+(i!=null&&i.ignoreCase?"i":"")),this.flat=vn.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t&&this.flat.to<this.to&&t.index+t[0].length>this.flat.text.length-10&&(t=null),t){let i=this.flat.from+t.index,r=i+t[0].length;return this.value={from:i,to:r,match:t},this.matchPos=r+(i==r?1:0),this}else{if(this.flat.to==this.to)return this.done=!0,this;this.flat=vn.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}}typeof Symbol!="undefined"&&(fg.prototype[Symbol.iterator]=ug.prototype[Symbol.iterator]=function(){return this});function ik(n){try{return new RegExp(n,zh),!0}catch{return!1}}function Za(n){let e=Oe("input",{class:"cm-textfield",name:"line"}),t=Oe("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),n.dispatch({effects:ho.of(!1)}),n.focus()):r.keyCode==13&&(r.preventDefault(),i())},onsubmit:r=>{r.preventDefault(),i()}},Oe("label",n.state.phrase("Go to line"),": ",e)," ",Oe("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function i(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:s}=n,o=s.doc.lineAt(s.selection.main.head),[,l,a,h,c]=r,f=h?+h.slice(1):0,u=a?+a:o.number;if(a&&c){let p=u/100;l&&(p=p*(l=="-"?-1:1)+o.number/s.doc.lines),u=Math.round(s.doc.lines*p)}else a&&l&&(u=u*(l=="-"?-1:1)+o.number);let d=s.doc.line(Math.max(1,Math.min(s.doc.lines,u)));n.dispatch({effects:ho.of(!1),selection:P.cursor(d.from+Math.max(0,Math.min(f,d.length))),scrollIntoView:!0}),n.focus()}return{dom:t}}const ho=K.define(),iu=Ce.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(ho)&&(n=t.value);return n},provide:n=>Ar.from(n,e=>e?Za:null)}),nk=n=>{let e=Pr(n,Za);if(!e){let t=[ho.of(!0)];n.state.field(iu,!1)==null&&t.push(K.appendConfig.of([iu,rk])),n.dispatch({effects:t}),e=Pr(n,Za)}return e&&e.dom.querySelector("input").focus(),!0},rk=Y.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),sk={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},dg=G.define({combine(n){return hi(n,sk,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function ok(n){let e=[fk,ck];return n&&e.push(dg.of(n)),e}const lk=j.mark({class:"cm-selectionMatch"}),ak=j.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function nu(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=Ye.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=Ye.Word)}function hk(n,e,t,i){return n(e.sliceDoc(t,t+1))==Ye.Word&&n(e.sliceDoc(i-1,i))==Ye.Word}const ck=Pe.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(dg),{state:t}=n,i=t.selection;if(i.ranges.length>1)return j.none;let r=i.main,s,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return j.none;let a=t.wordAt(r.head);if(!a)return j.none;o=t.charCategorizer(r.head),s=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return j.none;if(e.wholeWords){if(s=t.sliceDoc(r.from,r.to),o=t.charCategorizer(r.head),!(nu(o,t,r.from,r.to)&&hk(o,t,r.from,r.to)))return j.none}else if(s=t.sliceDoc(r.from,r.to).trim(),!s)return j.none}let l=[];for(let a of n.visibleRanges){let h=new Wn(t.doc,s,a.from,a.to);for(;!h.next().done;){let{from:c,to:f}=h.value;if((!o||nu(o,t,c,f))&&(r.empty&&c<=r.from&&f>=r.to?l.push(ak.range(c,f)):(c>=r.to||f<=r.from)&&l.push(lk.range(c,f)),l.length>e.maxMatches))return j.none}}return j.set(l)}},{decorations:n=>n.decorations}),fk=Y.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),uk=({state:n,dispatch:e})=>{let{selection:t}=n,i=P.create(t.ranges.map(r=>n.wordAt(r.head)||P.cursor(r.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function dk(n,e){let{main:t,ranges:i}=n.selection,r=n.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,l=new Wn(n.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new Wn(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(a=>a.from==l.value.from))continue;if(s){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const pk=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return uk({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=i))return!1;let r=dk(n,i);return r?(e(n.update({selection:n.selection.addRange(P.range(r.from,r.to),!1),effects:Y.scrollIntoView(r.to)})),!0):!1},_h=G.define({combine(n){var e;return{top:n.reduce((t,i)=>t!=null?t:i.top,void 0)||!1,caseSensitive:n.reduce((t,i)=>t!=null?t:i.caseSensitive,void 0)||!1,createPanel:((e=n.find(t=>t.createPanel))===null||e===void 0?void 0:e.createPanel)||(t=>new $k(t))}}});class pg{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||ik(this.search)),this.unquoted=e.literal?this.search:this.search.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp}create(){return this.regexp?new mk(this):new gk(this)}getCursor(e,t=0,i=e.length){return this.regexp?pn(this,e,t,i):dn(this,e,t,i)}}class gg{constructor(e){this.spec=e}}function dn(n,e,t,i){return new Wn(e,n.unquoted,t,i,n.caseSensitive?void 0:r=>r.toLowerCase())}class gk extends gg{constructor(e){super(e)}nextMatch(e,t,i){let r=dn(this.spec,e,i,e.length).nextOverlapping();return r.done&&(r=dn(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=i;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=dn(this.spec,e,s,r),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;r-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let i=dn(this.spec,e,0,e.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=dn(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function pn(n,e,t,i){return new fg(e,n.search,n.caseSensitive?void 0:{ignoreCase:!0},t,i)}class mk extends gg{nextMatch(e,t,i){let r=pn(this.spec,e,i,e.length).next();return r.done&&(r=pn(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=1;;r++){let s=Math.max(t,i-r*1e4),o=pn(this.spec,e,s,i),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,(t,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:t)}matchAll(e,t){let i=pn(this.spec,e,0,e.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=pn(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const Ir=K.define(),Uh=K.define(),Ti=Ce.define({create(n){return new Al(ja(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Ir)?n=new Al(t.value.create(),n.panel):t.is(Uh)&&(n=new Al(n.query,t.value?Nh:null));return n},provide:n=>Ar.from(n,e=>e.panel)});class Al{constructor(e,t){this.query=e,this.panel=t}}const Ok=j.mark({class:"cm-searchMatch"}),xk=j.mark({class:"cm-searchMatch cm-searchMatch-selected"}),bk=Pe.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(Ti))}update(n){let e=n.state.field(Ti);(e!=n.startState.field(Ti)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return j.none;let{view:t}=this,i=new Ai;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:l,to:a}=s[r];for(;r<o-1&&a>s[r+1].from-2*250;)a=s[++r].to;n.highlight(t.state.doc,l,a,(h,c)=>{let f=t.state.selection.ranges.some(u=>u.from==h&&u.to==c);i.add(h,c,f?xk:Ok)})}return i.finish()}},{decorations:n=>n.decorations});function jr(n){return e=>{let t=e.state.field(Ti,!1);return t&&t.query.spec.valid?n(e,t):mg(e)}}const co=jr((n,{query:e})=>{let{from:t,to:i}=n.state.selection.main,r=e.nextMatch(n.state.doc,t,i);return!r||r.from==t&&r.to==i?!1:(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:Xh(n,r),userEvent:"select.search"}),!0)}),fo=jr((n,{query:e})=>{let{state:t}=n,{from:i,to:r}=t.selection.main,s=e.prevMatch(t.doc,i,r);return s?(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:Xh(n,s),userEvent:"select.search"}),!0):!1}),yk=jr((n,{query:e})=>{let t=e.matchAll(n.state.doc,1e3);return!t||!t.length?!1:(n.dispatch({selection:P.create(t.map(i=>P.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),wk=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:r}=t.main,s=[],o=0;for(let l=new Wn(n.doc,n.sliceDoc(i,r));!l.next().done;){if(s.length>1e3)return!1;l.value.from==i&&(o=s.length),s.push(P.range(l.value.from,l.value.to))}return e(n.update({selection:P.create(s,o),userEvent:"select.search.matches"})),!0},ru=jr((n,{query:e})=>{let{state:t}=n,{from:i,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t.doc,i,i);if(!s)return!1;let o=[],l,a;if(s.from==i&&s.to==r&&(a=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:a}),s=e.nextMatch(t.doc,s.from,s.to)),s){let h=o.length==0||o[0].from>=s.to?0:s.to-s.from-a.length;l={anchor:s.from-h,head:s.to-h}}return n.dispatch({changes:o,selection:l,scrollIntoView:!!l,effects:s?Xh(n,s):void 0,userEvent:"input.replace"}),!0}),Sk=jr((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state.doc,1e9).map(i=>{let{from:r,to:s}=i;return{from:r,to:s,insert:e.getReplacement(i)}});return t.length?(n.dispatch({changes:t,userEvent:"input.replace.all"}),!0):!1});function Nh(n){return n.state.facet(_h).createPanel(n)}function ja(n,e){var t;let i=n.selection.main,r=i.empty||i.to>i.from+100?"":n.sliceDoc(i.from,i.to),s=(t=e==null?void 0:e.caseSensitive)!==null&&t!==void 0?t:n.facet(_h).caseSensitive;return e&&!r?e:new pg({search:r.replace(/\n/g,"\\n"),caseSensitive:s})}const mg=n=>{let e=n.state.field(Ti,!1);if(e&&e.panel){let t=Pr(n,Nh);if(!t)return!1;let i=t.dom.querySelector("[name=search]");if(i!=n.root.activeElement){let r=ja(n.state,e.query.spec);r.valid&&n.dispatch({effects:Ir.of(r)}),i.focus(),i.select()}}else n.dispatch({effects:[Uh.of(!0),e?Ir.of(ja(n.state,e.query.spec)):K.appendConfig.of(Qk)]});return!0},Og=n=>{let e=n.state.field(Ti,!1);if(!e||!e.panel)return!1;let t=Pr(n,Nh);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:Uh.of(!1)}),!0},kk=[{key:"Mod-f",run:mg,scope:"editor search-panel"},{key:"F3",run:co,shift:fo,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:co,shift:fo,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Og,scope:"editor search-panel"},{key:"Mod-Shift-l",run:wk},{key:"Alt-g",run:nk},{key:"Mod-d",run:pk,preventDefault:!0}];class $k{constructor(e){this.view=e;let t=this.query=e.state.field(Ti).query.spec;this.commit=this.commit.bind(this),this.searchField=Oe("input",{value:t.search,placeholder:gt(e,"Find"),"aria-label":gt(e,"Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Oe("input",{value:t.replace,placeholder:gt(e,"Replace"),"aria-label":gt(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=Oe("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit}),this.reField=Oe("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit});function i(r,s,o){return Oe("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=Oe("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>co(e),[gt(e,"next")]),i("prev",()=>fo(e),[gt(e,"previous")]),i("select",()=>yk(e),[gt(e,"all")]),Oe("label",null,[this.caseField,gt(e,"match case")]),Oe("label",null,[this.reField,gt(e,"regexp")]),...e.state.readOnly?[]:[Oe("br"),this.replaceField,i("replace",()=>ru(e),[gt(e,"replace")]),i("replaceAll",()=>Sk(e),[gt(e,"replace all")]),Oe("button",{name:"close",onclick:()=>Og(e),"aria-label":gt(e,"close"),type:"button"},["\xD7"])]])}commit(){let e=new pg({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ir.of(e)}))}keydown(e){Jy(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?fo:co)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),ru(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Ir)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(_h).top}}function gt(n,e){return n.state.phrase(e)}const gs=30,ms=/[\s\.,:;?!]/;function Xh(n,{from:e,to:t}){let i=n.state.doc.lineAt(e).from,r=n.state.doc.lineAt(t).to,s=Math.max(i,e-gs),o=Math.min(r,t+gs),l=n.state.sliceDoc(s,o);if(s!=i){for(let a=0;a<gs;a++)if(!ms.test(l[a+1])&&ms.test(l[a])){l=l.slice(a);break}}if(o!=r){for(let a=l.length-1;a>l.length-gs;a--)if(!ms.test(l[a-1])&&ms.test(l[a])){l=l.slice(0,a);break}}return Y.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${n.state.doc.lineAt(e).number}`)}const vk=Y.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Qk=[Ti,Xn.lowest(bk),vk];class xg{constructor(e,t,i){this.state=e,this.pos=t,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let t=Re(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),r=t.text.slice(i-t.from,this.pos-t.from),s=r.search(yg(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function su(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Tk(n){let e=Object.create(null),t=Object.create(null);for(let{label:r}of n){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let i=su(e)+su(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function bg(n){let e=n.map(r=>typeof r=="string"?{label:r}:r),[t,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Tk(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:t}:null}}function Pk(n,e){return t=>{for(let i=Re(t.state).resolveInner(t.pos,-1);i;i=i.parent)if(n.indexOf(i.name)>-1)return null;return e(t)}}class ou{constructor(e,t,i){this.completion=e,this.source=t,this.match=i}}function Pi(n){return n.selection.main.head}function yg(n,e){var t;let{source:i}=n,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?n:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const Ak=Mi.define();function wg(n,e){const t=e.completion.apply||e.completion.label;let i=e.source;typeof t=="string"?n.dispatch(n.state.changeByRange(r=>{if(r==n.state.selection.main)return{changes:{from:i.from,to:i.to,insert:t},range:P.cursor(i.from+t.length)};let s=i.to-i.from;return!r.empty||s&&n.state.sliceDoc(r.from-s,r.from)!=n.state.sliceDoc(i.from,i.to)?{range:r}:{changes:{from:r.from-s,to:r.from,insert:t},range:P.cursor(r.from-s+t.length)}}),{userEvent:"input.complete",annotations:Ak.of(e.completion)}):t(n,e.completion,i.from,i.to)}const lu=new WeakMap;function Rk(n){if(!Array.isArray(n))return n;let e=lu.get(n);return e||lu.set(n,e=bg(n)),e}class Ck{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let i=Ze(e,t),r=Ot(i);this.chars.push(i);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(Ze(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:r,precise:s,byWord:o}=this;if(t.length==1){let m=Ze(e,0);return m==t[0]?[0,0,Ot(m)]:m==i[0]?[-200,0,Ot(m)]:null}let l=e.indexOf(this.pattern);if(l==0)return[0,0,this.pattern.length];let a=t.length,h=0;if(l<0){for(let m=0,b=Math.min(e.length,200);m<b&&h<a;){let y=Ze(e,m);(y==t[h]||y==i[h])&&(r[h++]=m),m+=Ot(y)}if(h<a)return null}let c=0,f=0,u=!1,d=0,p=-1,g=-1,x=/[a-z]/.test(e),Q=!0;for(let m=0,b=Math.min(e.length,200),y=0;m<b&&f<a;){let w=Ze(e,m);l<0&&(c<a&&w==t[c]&&(s[c++]=m),d<a&&(w==t[d]||w==i[d]?(d==0&&(p=m),g=m+1,d++):d=0));let v,R=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(v=bh(w))!=v.toLowerCase()?1:v!=v.toUpperCase()?2:0;(!m||R==1&&x||y==0&&R!=0)&&(t[f]==w||i[f]==w&&(u=!0)?o[f++]=m:o.length&&(Q=!1)),y=R,m+=Ot(w)}return f==a&&o[0]==0&&Q?this.result(-100+(u?-200:0),o,e):d==a&&p==0?[-200-e.length,0,g]:l>-1?[-700-e.length,l,l+this.pattern.length]:d==a?[-200+-700-e.length,p,g]:f==a?this.result(-100+(u?-200:0)+-700+(Q?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,i){let r=[e-i.length],s=1;for(let o of t){let l=o+(this.astral?Ot(Ze(i,o)):1);s>1&&r[s-1]==o?r[s-1]=l:(r[s++]=o,r[s++]=l)}return r}}const Wi=G.define({combine(n){return hi(n,{activateOnTyping:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>i=>Ik(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})}});function Ik(n,e){return n?e?n+" "+e:n:e}function Ek(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,r){let s=document.createElement("span");s.className="cm-completionLabel";let{label:o}=t,l=0;for(let a=1;a<r.length;){let h=r[a++],c=r[a++];h>l&&s.appendChild(document.createTextNode(o.slice(l,h)));let f=s.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(o.slice(h,c))),f.className="cm-completionMatchedText",l=c}return l<o.length&&s.appendChild(document.createTextNode(o.slice(l))),s},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function au(n,e,t){if(n<=t)return{from:0,to:n};if(e<=n>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class Wk{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:l=>this.positionInfo(l),key:this};let i=e.state.field(t),{options:r,selected:s}=i.open,o=e.state.facet(Wi);this.optionContent=Ek(o),this.optionClass=o.optionClass,this.range=au(r.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",l=>{for(let a=l.target,h;a&&a!=this.dom;a=a.parentNode)if(a.nodeName=="LI"&&(h=/-(\d+)$/.exec(a.id))&&+h[1]<r.length){wg(e,r[+h[1]]),l.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(r,i.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=au(t.options.length,t.selected,this.view.state.facet(Wi).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=t.options[t.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o)}).catch(o=>dt(this.view.state,o,"completion info")):this.addInfoPane(s)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&Mk(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect();if(r.top>Math.min(innerHeight,t.bottom)-10||r.bottom<Math.max(0,t.top)+10)return null;let s=Math.max(0,Math.min(r.top,innerHeight-i.height))-t.top,o=this.view.textDirection==ye.RTL,l=t.left,a=innerWidth-t.right;return o&&l<Math.min(i.width,a)?o=!1:!o&&a<Math.min(i.width,l)&&(o=!0),{top:s,left:o}}positionInfo(e){this.info&&(this.info.style.top=(e?e.top:-1e6)+"px",e&&(this.info.classList.toggle("cm-completionInfo-left",e.left),this.info.classList.toggle("cm-completionInfo-right",!e.left)))}createListBox(e,t,i){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true");for(let s=i.from;s<i.to;s++){let{completion:o,match:l}=e[s];const a=r.appendChild(document.createElement("li"));a.id=t+"-"+s,a.setAttribute("role","option");let h=this.optionClass(o);h&&(a.className=h);for(let c of this.optionContent){let f=c(o,this.view.state,l);f&&a.appendChild(f)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}}function Dk(n){return e=>new Wk(e,n)}function Mk(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect();i.top<t.top?n.scrollTop-=t.top-i.top:i.bottom>t.bottom&&(n.scrollTop+=i.bottom-t.bottom)}function hu(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function Bk(n,e){let t=[],i=0;for(let o of n)if(o.hasResult())if(o.result.filter===!1){let l=o.result.getMatch;for(let a of o.result.options){let h=[1e9-i++];if(l)for(let c of l(a))h.push(c);t.push(new ou(a,o,h))}}else{let l=new Ck(e.sliceDoc(o.from,o.to)),a;for(let h of o.result.options)(a=l.match(h.label))&&(h.boost!=null&&(a[0]+=h.boost),t.push(new ou(h,o,a)))}let r=[],s=null;for(let o of t.sort(Uk))!s||s.label!=o.completion.label||s.detail!=o.completion.detail||s.type!=null&&o.completion.type!=null&&s.type!=o.completion.type||s.apply!=o.completion.apply?r.push(o):hu(o.completion)>hu(s)&&(r[r.length-1]=o),s=o.completion;return r}class gr{constructor(e,t,i,r,s){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=r,this.selected=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new gr(this.options,cu(t,e),this.tooltip,this.timestamp,e)}static build(e,t,i,r,s){let o=Bk(e,t);if(!o.length)return null;let l=0;if(r&&r.selected){let a=r.options[r.selected].completion;for(let h=0;h<o.length;h++)if(o[h].completion==a){l=h;break}}return new gr(o,cu(i,l),{pos:e.reduce((a,h)=>h.hasResult()?Math.min(a,h.from):a,1e8),create:Dk(xt),above:s.aboveCursor},r?r.timestamp:Date.now(),l)}map(e){return new gr(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class uo{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new uo(_k,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Wi),s=(i.override||t.languageDataAt("autocomplete",Pi(t)).map(Rk)).map(l=>(this.active.find(h=>h.source==l)||new tt(l,this.active.some(h=>h.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((l,a)=>l==this.active[a])&&(s=this.active);let o=e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Lk(s,this.active)?gr.build(s,t,this.id,this.open,i):this.open&&e.docChanged?this.open.map(e.changes):this.open;!o&&s.every(l=>l.state!=1)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new tt(l.source,0):l));for(let l of e.effects)l.is(kg)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new uo(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:zk}}function Lk(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult;)t++;for(;i<e.length&&!e[i].hasResult;)i++;let r=t==n.length,s=i==e.length;if(r||s)return r==s;if(n[t++].result!=e[i++].result)return!1}}const zk={"aria-autocomplete":"list"};function cu(n,e){return{"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":n+"-"+e,"aria-controls":n}}const _k=[];function Uk(n,e){let t=e.match[0]-n.match[0];return t||n.completion.label.localeCompare(e.completion.label)}function Ga(n){return n.isUserEvent("input.type")?"input":n.isUserEvent("delete.backward")?"delete":null}class tt{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=Ga(e),r=this;i?r=r.handleUserEvent(e,i,t):e.docChanged?r=r.handleChange(e):e.selection&&r.state!=0&&(r=new tt(r.source,0));for(let s of e.effects)if(s.is(Zh))r=new tt(r.source,1,s.value?Pi(e.state):-1);else if(s.is(po))r=new tt(r.source,0);else if(s.is(Sg))for(let o of s.value)o.source==r.source&&(r=o);return r}handleUserEvent(e,t,i){return t=="delete"||!i.activateOnTyping?this.map(e.changes):new tt(this.source,1)}handleChange(e){return e.changes.touchesRange(Pi(e.startState))?new tt(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new tt(this.source,this.state,e.mapPos(this.explicitPos))}}class mr extends tt{constructor(e,t,i,r,s){super(e,2,t),this.result=i,this.from=r,this.to=s}hasResult(){return!0}handleUserEvent(e,t,i){var r;let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=Pi(e.state);if((this.explicitPos<0?l<=s:l<this.from)||l>o||t=="delete"&&Pi(e.startState)==this.from)return new tt(this.source,t=="input"&&i.activateOnTyping?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),h;return Nk(this.result.validFor,e.state,s,o)?new mr(this.source,a,this.result,s,o):this.result.update&&(h=this.result.update(this.result,s,o,new xg(e.state,l,a>=0)))?new mr(this.source,a,h,h.from,(r=h.to)!==null&&r!==void 0?r:Pi(e.state)):new tt(this.source,1,a)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new tt(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new mr(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function Nk(n,e,t,i){if(!n)return!1;let r=e.sliceDoc(t,i);return typeof n=="function"?n(r,t,i,e):yg(n,!0).test(r)}const Zh=K.define(),po=K.define(),Sg=K.define({map(n,e){return n.map(t=>t.map(e))}}),kg=K.define(),xt=Ce.define({create(){return uo.start()},update(n,e){return n.update(e)},provide:n=>[Ph.from(n,e=>e.tooltip),Y.contentAttributes.from(n,e=>e.attrs)]}),$g=75;function Os(n,e="option"){return t=>{let i=t.state.field(xt,!1);if(!i||!i.open||Date.now()-i.open.timestamp<$g)return!1;let r=1,s;e=="page"&&(s=Bw(t,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let o=i.open.selected+r*(n?1:-1),{length:l}=i.open.options;return o<0?o=e=="page"?0:l-1:o>=l&&(o=e=="page"?l-1:0),t.dispatch({effects:kg.of(o)}),!0}}const Xk=n=>{let e=n.state.field(xt,!1);return n.state.readOnly||!e||!e.open||Date.now()-e.open.timestamp<$g?!1:(wg(n,e.open.options[e.open.selected]),!0)},Zk=n=>n.state.field(xt,!1)?(n.dispatch({effects:Zh.of(!0)}),!0):!1,jk=n=>{let e=n.state.field(xt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:po.of(null)}),!0)};class Gk{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const fu=50,qk=50,Fk=1e3,Vk=Pe.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of n.state.field(xt).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(xt);if(!n.selectionSet&&!n.docChanged&&n.startState.field(xt)==e)return;let t=n.transactions.some(i=>(i.selection||i.docChanged)&&!Ga(i));for(let i=0;i<this.running.length;i++){let r=this.running[i];if(t||r.updates.length+n.transactions.length>qk&&Date.now()-r.time>Fk){for(let s of r.context.abortListeners)try{s()}catch(o){dt(this.view.state,o)}r.context.abortListeners=null,this.running.splice(i--,1)}else r.updates.push(...n.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(r=>r.active.source==i.source))?setTimeout(()=>this.startUpdate(),fu):-1,this.composing!=0)for(let i of n.transactions)Ga(i)=="input"?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:n}=this.view,e=n.field(xt);for(let t of e.active)t.state==1&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t)}startQuery(n){let{state:e}=this.view,t=Pi(e),i=new xg(e,t,n.explicitPos==t),r=new Gk(n,i);this.running.push(r),Promise.resolve(n.source(i)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:po.of(null)}),dt(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),fu))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Wi);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(r.done===void 0)continue;if(this.running.splice(i--,1),r.done){let o=new mr(r.active.source,r.active.explicitPos,r.done,r.done.from,(n=r.done.to)!==null&&n!==void 0?n:Pi(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)o=o.update(l,t);if(o.hasResult()){e.push(o);continue}}let s=this.view.state.field(xt).active.find(o=>o.source==r.active.source);if(s&&s.state==1)if(r.done==null){let o=new tt(r.active.source,0);for(let l of r.updates)o=o.update(l,t);o.state!=1&&e.push(o)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:Sg.of(e)})}},{eventHandlers:{blur(){let n=this.view.state.field(xt,!1);n&&n.tooltip&&this.view.state.facet(Wi).closeOnBlur&&this.view.dispatch({effects:po.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Zh.of(!1)}),20),this.composing=0}}}),vg=Y.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Yk{constructor(e,t,i,r){this.field=e,this.line=t,this.from=i,this.to=r}}class jh{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,_e.TrackDel),i=e.mapPos(this.to,1,_e.TrackDel);return t==null||i==null?null:new jh(this.field,t,i)}}class Gh{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],r=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let a of this.lines){if(i.length){let h=o,c=/^\t*/.exec(a)[0].length;for(let f=0;f<c;f++)h+=e.facet(Xr);r.push(t+h.length-c),a=h+a.slice(c)}i.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new jh(a.field,r[a.line]+a.from,r[a.line]+a.to));return{text:i,ranges:l}}static parse(e){let t=[],i=[],r=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){let l=s[1]?+s[1]:null,a=s[2]||s[3]||"",h=-1;for(let c=0;c<t.length;c++)(l!=null?t[c].seq==l:a?t[c].name==a:!1)&&(h=c);if(h<0){let c=0;for(;c<t.length&&(l==null||t[c].seq!=null&&t[c].seq<l);)c++;t.splice(c,0,{seq:l,name:a}),h=c;for(let f of r)f.field>=h&&f.field++}r.push(new Yk(h,i.length,s.index,s.index+a.length)),o=o.slice(0,s.index)+a+o.slice(s.index+s[0].length)}i.push(o)}return new Gh(i,r)}}let Hk=j.widget({widget:new class extends At{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),Jk=j.mark({class:"cm-snippetField"});class jn{constructor(e,t){this.ranges=e,this.active=t,this.deco=j.set(e.map(i=>(i.from==i.to?Hk:Jk).range(i.from,i.to)))}map(e){let t=[];for(let i of this.ranges){let r=i.map(e);if(!r)return null;t.push(r)}return new jn(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const Gr=K.define({map(n,e){return n&&n.map(e)}}),Kk=K.define(),Er=Ce.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Gr))return t.value;if(t.is(Kk)&&n)return new jn(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>Y.decorations.from(n,e=>e?e.deco:j.none)});function qh(n,e){return P.create(n.filter(t=>t.field==e).map(t=>P.range(t.from,t.to)))}function e$(n){let e=Gh.parse(n);return(t,i,r,s)=>{let{text:o,ranges:l}=e.instantiate(t.state,r),a={changes:{from:r,to:s,insert:ae.of(o)}};if(l.length&&(a.selection=qh(l,0)),l.length>1){let h=new jn(l,0),c=a.effects=[Gr.of(h)];t.state.field(Er,!1)===void 0&&c.push(K.appendConfig.of([Er,s$,o$,vg]))}t.dispatch(t.state.update(a))}}function Qg(n){return({state:e,dispatch:t})=>{let i=e.field(Er,!1);if(!i||n<0&&i.active==0)return!1;let r=i.active+n,s=n>0&&!i.ranges.some(o=>o.field==r+n);return t(e.update({selection:qh(i.ranges,r),effects:Gr.of(s?null:new jn(i.ranges,r))})),!0}}const t$=({state:n,dispatch:e})=>n.field(Er,!1)?(e(n.update({effects:Gr.of(null)})),!0):!1,i$=Qg(1),n$=Qg(-1),r$=[{key:"Tab",run:i$,shift:n$},{key:"Escape",run:t$}],uu=G.define({combine(n){return n.length?n[0]:r$}}),s$=Xn.highest(Nr.compute([uu],n=>n.facet(uu)));function _i(n,e){return Object.assign(Object.assign({},e),{apply:e$(n)})}const o$=Y.domEventHandlers({mousedown(n,e){let t=e.state.field(Er,!1),i;if(!t||(i=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let r=t.ranges.find(s=>s.from<=i&&s.to>=i);return!r||r.field==t.active?!1:(e.dispatch({selection:qh(t.ranges,r.field),effects:Gr.of(t.ranges.some(s=>s.field>r.field)?new jn(t.ranges,r.field):null)}),!0)}}),go={brackets:["(","[","{","'",'"'],before:")]}:;>"},ji=K.define({map(n,e){let t=e.mapPos(n,-1,_e.TrackAfter);return t==null?void 0:t}}),Fh=K.define({map(n,e){return e.mapPos(n)}}),Vh=new class extends Hi{};Vh.startSide=1;Vh.endSide=-1;const Tg=Ce.define({create(){return he.empty},update(n,e){if(e.selection){let t=e.state.doc.lineAt(e.selection.main.head).from,i=e.startState.doc.lineAt(e.startState.selection.main.head).from;t!=e.changes.mapPos(i,-1)&&(n=he.empty)}n=n.map(e.changes);for(let t of e.effects)t.is(ji)?n=n.update({add:[Vh.range(t.value,t.value+1)]}):t.is(Fh)&&(n=n.update({filter:i=>i!=t.value}));return n}});function l$(){return[h$,Tg]}const Rl="()[]{}<>";function Pg(n){for(let e=0;e<Rl.length;e+=2)if(Rl.charCodeAt(e)==n)return Rl.charAt(e+1);return bh(n<128?n:n+1)}function Ag(n,e){return n.languageDataAt("closeBrackets",e)[0]||go}const a$=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),h$=Y.inputHandler.of((n,e,t,i)=>{if((a$?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let r=n.state.selection.main;if(i.length>2||i.length==2&&Ot(Ze(i,0))==1||e!=r.from||t!=r.to)return!1;let s=u$(n.state,i);return s?(n.dispatch(s),!0):!1}),c$=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=Ag(n,n.selection.main.head).brackets||go.brackets,r=null,s=n.changeByRange(o=>{if(o.empty){let l=d$(n.doc,o.head);for(let a of i)if(a==l&&Zo(n.doc,o.head)==Pg(Ze(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:P.cursor(o.head-a.length),userEvent:"delete.backward"}}return{range:r=o}});return r||e(n.update(s,{scrollIntoView:!0})),!r},f$=[{key:"Backspace",run:c$}];function u$(n,e){let t=Ag(n,n.selection.main.head),i=t.brackets||go.brackets;for(let r of i){let s=Pg(Ze(r,0));if(e==r)return s==r?m$(n,r,i.indexOf(r+r+r)>-1):p$(n,r,s,t.before||go.before);if(e==s&&Rg(n,n.selection.main.from))return g$(n,r,s)}return null}function Rg(n,e){let t=!1;return n.field(Tg).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function Zo(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Ot(Ze(t,0)))}function d$(n,e){let t=n.sliceString(e-2,e);return Ot(Ze(t,0))==t.length?t:t.slice(1)}function p$(n,e,t,i){let r=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:ji.of(o.to+e.length),range:P.range(o.anchor+e.length,o.head+e.length)};let l=Zo(n.doc,o.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:ji.of(o.head+e.length),range:P.cursor(o.head+e.length)}:{range:r=o}});return r?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function g$(n,e,t){let i=null,r=n.selection.ranges.map(s=>s.empty&&Zo(n.doc,s.head)==t?P.cursor(s.head+t.length):i=s);return i?null:n.update({selection:P.create(r,n.selection.mainIndex),scrollIntoView:!0,effects:n.selection.ranges.map(({from:s})=>Fh.of(s))})}function m$(n,e,t){let i=null,r=n.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:e,from:s.to}],effects:ji.of(s.to+e.length),range:P.range(s.anchor+e.length,s.head+e.length)};let o=s.head,l=Zo(n.doc,o);if(l==e){if(du(n,o))return{changes:{insert:e+e,from:o},effects:ji.of(o+e.length),range:P.cursor(o+e.length)};if(Rg(n,o)){let a=t&&n.sliceDoc(o,o+e.length*3)==e+e+e;return{range:P.cursor(o+e.length*(a?3:1)),effects:Fh.of(o)}}}else{if(t&&n.sliceDoc(o-2*e.length,o)==e+e&&du(n,o-2*e.length))return{changes:{insert:e+e+e+e,from:o},effects:ji.of(o+e.length),range:P.cursor(o+e.length)};if(n.charCategorizer(o)(l)!=Ye.Word){let a=n.sliceDoc(o-1,o);if(a!=e&&n.charCategorizer(o)(a)!=Ye.Word&&!O$(n,o,e))return{changes:{insert:e+e,from:o},effects:ji.of(o+e.length),range:P.cursor(o+e.length)}}}return{range:i=s}});return i?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function du(n,e){let t=Re(n).resolveInner(e+1);return t.parent&&t.from==e}function O$(n,e,t){let i=Re(n).resolveInner(e,-1);for(let r=0;r<5;r++){if(n.sliceDoc(i.from,i.from+t.length)==t)return!0;let s=i.to==e&&i.parent;if(!s)break;i=s}return!1}function x$(n={}){return[xt,Wi.of(n),Vk,b$,vg]}const Cg=[{key:"Ctrl-Space",run:Zk},{key:"Escape",run:jk},{key:"ArrowDown",run:Os(!0)},{key:"ArrowUp",run:Os(!1)},{key:"PageDown",run:Os(!0,"page")},{key:"PageUp",run:Os(!1,"page")},{key:"Enter",run:Xk}],b$=Xn.highest(Nr.computeN([Wi],n=>n.facet(Wi).defaultKeymap?[Cg]:[]));class y${constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class Ni{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let r=e,s=i.facet(On).markerFilter;s&&(r=s(r));let o=j.set(r.map(l=>l.from==l.to||l.from==l.to-1&&i.doc.lineAt(l.from).to==l.from?j.widget({widget:new R$(l),diagnostic:l}).range(l.from):j.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity},diagnostic:l}).range(l.from,l.to)),!0);return new Ni(o,t,Dn(o))}}function Dn(n,e=null,t=0){let i=null;return n.between(t,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new y$(r,s,o.diagnostic),!1}),i}function w$(n,e){return!!(n.effects.some(t=>t.is(Yh))||n.changes.touchesRange(e.pos))}function Ig(n,e){return n.field(ut,!1)?e:e.concat(K.appendConfig.of([ut,Y.decorations.compute([ut],t=>{let{selected:i,panel:r}=t.field(ut);return!i||!r||i.from==i.to?j.none:j.set([k$.range(i.from,i.to)])}),Mw($$,{hideOn:w$}),I$]))}function S$(n,e){return{effects:Ig(n,[Yh.of(e)])}}const Yh=K.define(),Hh=K.define(),Eg=K.define(),ut=Ce.define({create(){return new Ni(j.none,null,null)},update(n,e){if(e.docChanged){let t=n.diagnostics.map(e.changes),i=null;if(n.selected){let r=e.changes.mapPos(n.selected.from,1);i=Dn(t,n.selected.diagnostic,r)||Dn(t,null,r)}n=new Ni(t,n.panel,i)}for(let t of e.effects)t.is(Yh)?n=Ni.init(t.value,n.panel,e.state):t.is(Hh)?n=new Ni(n.diagnostics,t.value?jo.open:null,n.selected):t.is(Eg)&&(n=new Ni(n.diagnostics,n.panel,t.value));return n},provide:n=>[Ar.from(n,e=>e.panel),Y.decorations.from(n,e=>e.diagnostics)]}),k$=j.mark({class:"cm-lintRange cm-lintRange-active"});function $$(n,e,t){let{diagnostics:i}=n.state.field(ut),r=[],s=2e8,o=0;i.between(e-(t<0?1:0),e+(t>0?1:0),(a,h,{spec:c})=>{e>=a&&e<=h&&(a==h||(e>a||t>0)&&(e<h||t<0))&&(r.push(c.diagnostic),s=Math.min(a,s),o=Math.max(h,o))});let l=n.state.facet(On).tooltipFilter;return l&&(r=l(r)),r.length?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:v$(n,r)}}}:null}function v$(n,e){return Oe("ul",{class:"cm-tooltip-lint"},e.map(t=>Dg(n,t,!1)))}const Q$=n=>{let e=n.state.field(ut,!1);(!e||!e.panel)&&n.dispatch({effects:Ig(n.state,[Hh.of(!0)])});let t=Pr(n,jo.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},pu=n=>{let e=n.state.field(ut,!1);return!e||!e.panel?!1:(n.dispatch({effects:Hh.of(!1)}),!0)},T$=n=>{let e=n.state.field(ut,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},P$=[{key:"Mod-Shift-m",run:Q$},{key:"F8",run:T$}],A$=Pe.fromClass(class{constructor(n){this.view=n,this.timeout=-1,this.set=!0;let{delay:e}=n.state.facet(On);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let n=Date.now();if(n<this.lintTime-10)setTimeout(this.run,this.lintTime-n);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(On);Promise.all(t.map(i=>Promise.resolve(i(this.view)))).then(i=>{let r=i.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(S$(this.view.state,r))},i=>{dt(this.view.state,i)})}}update(n){let e=n.state.facet(On);(n.docChanged||e!=n.startState.facet(On))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),On=G.define({combine(n){return Object.assign({sources:n.map(e=>e.source)},hi(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null}))},enables:A$});function Wg(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let r=t[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function Dg(n,e,t){var i;let r=t?Wg(e.actions):[];return Oe("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Oe("span",{class:"cm-diagnosticText"},e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let l=f=>{f.preventDefault();let u=Dn(n.state.field(ut).diagnostics,e);u&&s.apply(n,u.from,u.to)},{name:a}=s,h=r[o]?a.indexOf(r[o]):-1,c=h<0?a:[a.slice(0,h),Oe("u",a.slice(h,h+1)),a.slice(h+1)];return Oe("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${a}${h<0?"":` (access key "${r[o]})"`}.`},c)}),e.source&&Oe("div",{class:"cm-diagnosticSource"},e.source))}class R$ extends At{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Oe("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class gu{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Dg(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class jo{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)pu(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=Wg(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=Dn(this.view.state.field(ut).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=Oe("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=Oe("div",{class:"cm-panel-lint"},this.list,Oe("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>pu(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(ut).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(ut),i=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,l,{spec:a})=>{let h=-1,c;for(let f=i;f<this.items.length;f++)if(this.items[f].diagnostic==a.diagnostic){h=f;break}h<0?(c=new gu(this.view,a.diagnostic),this.items.splice(i,0,c),r=!0):(c=this.items[h],h>i&&(this.items.splice(i,h-i),r=!0)),t&&c.diagnostic==t.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new gu(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{o.top<l.top?this.list.scrollTop-=l.top-o.top:o.bottom>l.bottom&&(this.list.scrollTop+=o.bottom-l.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(ut),i=Dn(t.diagnostics,this.items[e].diagnostic);!i||this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Eg.of(i)})}static open(e){return new jo(e)}}function C$(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function Cl(n){return C$(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const I$=Y.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Cl("#d11")},".cm-lintRange-warning":{backgroundImage:Cl("orange")},".cm-lintRange-info":{backgroundImage:Cl("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),E$=[Gw(),Vw(),dw(),hS(),D2(),tw(),lw(),le.allowMultipleSelections.of(!0),S2(),B2(_2,{fallback:!0}),q2(),l$(),x$(),vw(),Pw(),bw(),ok(),Nr.of([...f$,...tk,...kk,...xS,...C2,...Cg,...P$])];class Se{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(t,this.length,r,1),_t.from(r,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];return this.decompose(e,t,i,0),_t.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new Or(this),s=new Or(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=i)return!0}}iter(e=1){return new Or(this,e)}iterRange(e,t=this.length){return new Mg(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Bg(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Se.empty:e.length<=32?new Te(e):_t.from(Te.split(e,[]))}}class Te extends Se{constructor(e,t=W$(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?i:l)>=e)return new D$(r,l,i,o);r=l+1,i++}}decompose(e,t,i,r){let s=e<=0&&t>=this.length?this:new Te(mu(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),l=Es(s.text,o.text.slice(),0,s.length);if(l.length<=32)i.push(new Te(l,o.length+s.length));else{let a=l.length>>1;i.push(new Te(l.slice(0,a)),new Te(l.slice(a)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Te))return super.replace(e,t,i);let r=Es(this.text,Es(i.text,mu(this.text,0,e)),t),s=this.length+i.length-(t-e);return r.length<=32?new Te(r,s):_t.from(Te.split(r,[]),s)}sliceString(e,t=this.length,i=`
`){let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=i),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(t.push(new Te(i,r)),i=[],r=-1);return r>-1&&t.push(new Te(i,r)),t}}class _t extends Se{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=i+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,i,r);r=l+1,i=a+1}}decompose(e,t,i,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let h=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!h?i.push(l):l.decompose(e-o,t-o,i,h)}o=a+1}}replace(e,t,i){if(i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,i),h=this.lines-o.lines+a.lines;if(a.lines<h>>5-1&&a.lines>h>>5+1){let c=this.children.slice();return c[r]=a,new _t(c,this.length-(t-e)+i.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=i),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,i)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof _t))return 0;let i=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return i;let a=this.children[r],h=e.children[s];if(a!=h)return i+a.scanIdentical(h,t);i+=a.length+1}}static from(e,t=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let d of e)i+=d.lines;if(i<32){let d=[];for(let p of e)p.flatten(d);return new Te(d,t)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,l=[],a=0,h=-1,c=[];function f(d){let p;if(d.lines>s&&d instanceof _t)for(let g of d.children)f(g);else d.lines>o&&(a>o||!a)?(u(),l.push(d)):d instanceof Te&&a&&(p=c[c.length-1])instanceof Te&&d.lines+p.lines<=32?(a+=d.lines,h+=d.length+1,c[c.length-1]=new Te(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>r&&u(),a+=d.lines,h+=d.length+1,c.push(d))}function u(){a!=0&&(l.push(c.length==1?c[0]:_t.from(c,h)),h=-1,a=c.length=0)}for(let d of e)f(d);return u(),l.length==1?l[0]:new _t(l,t)}}Se.empty=new Te([""],0);function W$(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Es(n,e,t=0,i=1e9){for(let r=0,s=0,o=!0;s<n.length&&r<=i;s++){let l=n[s],a=r+l.length;a>=t&&(a>i&&(l=l.slice(0,i-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function mu(n,e,t){return Es(n,[""],e,t)}class Or{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Te?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,l=r instanceof Te?r.text.length:r.children.length;if(o==(t>0?l:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Te){let a=r.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof Te?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Mg{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Or(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=i?r:t<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Bg{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:r}=this.inner.next(e);return t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(Se.prototype[Symbol.iterator]=function(){return this.iter()},Or.prototype[Symbol.iterator]=Mg.prototype[Symbol.iterator]=Bg.prototype[Symbol.iterator]=function(){return this});class D${constructor(e,t,i,r){this.from=e,this.to=t,this.number=i,this.text=r}get length(){return this.to-this.from}}let Qn="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<Qn.length;n++)Qn[n]+=Qn[n-1];function M$(n){for(let e=1;e<Qn.length;e+=2)if(Qn[e]>n)return Qn[e-1]<=n;return!1}function Ou(n){return n>=127462&&n<=127487}const xu=8205;function Gi(n,e,t=!0,i=!0){return(t?Lg:B$)(n,e,i)}function Lg(n,e,t){if(e==n.length)return e;e&&zg(n.charCodeAt(e))&&_g(n.charCodeAt(e-1))&&e--;let i=Il(n,e);for(e+=bu(i);e<n.length;){let r=Il(n,e);if(i==xu||r==xu||t&&M$(r))e+=bu(r),i=r;else if(Ou(r)){let s=0,o=e-2;for(;o>=0&&Ou(Il(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function B$(n,e,t){for(;e>0;){let i=Lg(n,e-2,t);if(i<e)return i;e--}return 0}function zg(n){return n>=56320&&n<57344}function _g(n){return n>=55296&&n<56320}function Il(n,e){let t=n.charCodeAt(e);if(!_g(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return zg(i)?(t-55296<<10)+(i-56320)+65536:t}function bu(n){return n<65536?1:2}const qa=/\r\n?|\n/;var ht=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(ht||(ht={}));class ri{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,t=!1){Fa(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];r<0?e.push(i,r):e.push(r,i)}return new ri(e)}composeDesc(e){return this.empty?e:e.empty?this:Ug(this,e)}mapDesc(e,t=!1){return e.empty?this:Va(this,e,t)}mapPos(e,t=-1,i=ht.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],h=r+l;if(a<0){if(h>e)return s+(e-r);s+=l}else{if(i!=ht.Simple&&h>=e&&(i==ht.TrackDel&&r<e&&h>e||i==ht.TrackBefore&&r<e||i==ht.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=h}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let i=0,r=0;i<this.sections.length&&r<=t;){let s=this.sections[i++],o=this.sections[i++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ri(e)}static create(e){return new ri(e)}}class Xe extends ri{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Fa(this,(t,i,r,s,o)=>e=e.replace(r,r+(i-t),o),!1),e}mapDesc(e,t=!1){return Va(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;i.length<a;)i.push(Se.empty);i.push(o?e.slice(s,s+o):Se.empty)}s+=o}return new Xe(t,i)}compose(e){return this.empty?e:e.empty?this:Ug(this,e,!0)}map(e,t=!1){return e.empty?this:Va(this,e,t,!0)}iterChanges(e,t=!1){Fa(this,e,t)}get desc(){return ri.create(this.sections)}filter(e){let t=[],i=[],r=[],s=new Wr(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,a-l);Fe(r,c,-1);let f=s.ins==-1?-1:s.off==0?s.ins:0;Fe(t,c,f),f>0&&qi(i,t,s.text),s.forward(c),l+=c}let h=e[o++];for(;l<h;){if(s.done)break e;let c=Math.min(s.len,h-l);Fe(t,c,-1),Fe(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),l+=c}}return{changes:new Xe(t,i),filtered:ri.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],r=this.sections[t+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let r=[],s=[],o=0,l=null;function a(c=!1){if(!c&&!r.length)return;o<t&&Fe(r,t-o,-1);let f=new Xe(r,s);l=l?l.compose(f.map(l)):f,r=[],s=[],o=0}function h(c){if(Array.isArray(c))for(let f of c)h(f);else if(c instanceof Xe){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);a(),l=l?l.compose(c.map(l)):c}else{let{from:f,to:u=f,insert:d}=c;if(f>u||f<0||u>t)throw new RangeError(`Invalid change range ${f} to ${u} (in doc of length ${t})`);let p=d?typeof d=="string"?Se.of(d.split(i||qa)):d:Se.empty,g=p.length;if(f==u&&g==0)return;f<o&&a(),f>o&&Fe(r,f-o,-1),Fe(r,u-f,g),qi(s,r,p),o=u}}return h(e),a(!l),l}static empty(e){return new Xe(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<r;)i.push(Se.empty);i[r]=Se.of(s.slice(1)),t.push(s[0],i[r].length)}}}return new Xe(t,i)}static createSet(e,t){return new Xe(e,t)}}function Fe(n,e,t,i=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:e==0&&n[r]==0?n[r+1]+=t:i?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function qi(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(Se.empty);n.push(t)}}function Fa(n,e,t){let i=n.inserted;for(let r=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,f=Se.empty;for(;h+=l,c+=a,a&&i&&(f=f.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(r,h,s,c,f),r=h,s=c}}}function Va(n,e,t,i=!1){let r=[],s=i?[]:null,o=new Wr(n),l=new Wr(e);for(let a=0,h=0;;)if(o.ins==-1)a+=o.len,o.next();else if(l.ins==-1&&h<a){let c=Math.min(l.len,a-h);l.forward(c),Fe(r,c,-1),h+=c}else if(l.ins>=0&&(o.done||h<a||h==a&&(l.len<o.len||l.len==o.len&&!t))){for(Fe(r,l.ins,-1);a>h&&!o.done&&a+o.len<h+l.len;)a+=o.len,o.next();h+=l.len,l.next()}else if(o.ins>=0){let c=0,f=a+o.len;for(;;)if(l.ins>=0&&h>a&&h+l.len<f)c+=l.ins,h+=l.len,l.next();else if(l.ins==-1&&h<f){let u=Math.min(l.len,f-h);c+=u,l.forward(u),h+=u}else break;Fe(r,c,o.ins),s&&qi(s,r,o.text),a=f,o.next()}else{if(o.done&&l.done)return s?Xe.createSet(r,s):ri.create(r);throw new Error("Mismatched change set lengths")}}function Ug(n,e,t=!1){let i=[],r=t?[]:null,s=new Wr(n),o=new Wr(e);for(let l=!1;;){if(s.done&&o.done)return r?Xe.createSet(i,r):ri.create(i);if(s.ins==0)Fe(i,s.len,0,l),s.next();else if(o.len==0&&!o.done)Fe(i,0,o.ins,l),r&&qi(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),h=i.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Fe(i,a,c,l),r&&c&&qi(r,i,o.text)}else o.ins==-1?(Fe(i,s.off?0:s.len,a,l),r&&qi(r,i,s.textBit(a))):(Fe(i,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&qi(r,i,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||i.length>h),s.forward2(a),o.forward(a)}}}}class Wr{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Se.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?Se.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Fi{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Fi(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return se.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return se.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return se.range(e.anchor,e.head)}static create(e,t,i){return new Fi(e,t,i)}}class se{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:se.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new se([this.main],0)}addRange(e,t=!0){return se.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,se.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new se(e.ranges.map(t=>Fi.fromJSON(t)),e.main)}static single(e,t=e){return new se([se.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return se.normalized(e.slice(),t);i=s.to}return new se(e,t)}static cursor(e,t=0,i,r){return Fi.create(e,e,(t==0?0:t<0?4:8)|(i==null?3:Math.min(2,i))|(r!=null?r:33554431)<<5)}static range(e,t,i){let r=(i!=null?i:33554431)<<5;return t<e?Fi.create(t,e,16|r|8):Fi.create(e,t,r|(t>e?4:0))}static normalized(e,t=0){let i=e[t];e.sort((r,s)=>r.from-s.from),t=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);r<=t&&t--,e.splice(--r,2,s.anchor>s.head?se.range(a,l):se.range(l,a))}}return new se(e,t)}}function Ng(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Jh=0;class Ne{constructor(e,t,i,r,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=r,this.extensions=s,this.id=Jh++,this.default=e([])}static define(e={}){return new Ne(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:Kh),!!e.static,e.enables)}of(e){return new Ws([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ws(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ws(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function Kh(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class Ws{constructor(e,t,i,r){this.dependencies=e,this.facet=t,this.type=i,this.value=r,this.id=Jh++}dynamicSlot(e){var t;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,h=!1,c=[];for(let f of this.dependencies)f=="doc"?a=!0:f=="selection"?h=!0:(((t=e[f.id])!==null&&t!==void 0?t:1)&1)==0&&c.push(e[f.id]);return{create(f){return f.values[o]=i(f),1},update(f,u){if(a&&u.docChanged||h&&(u.docChanged||u.selection)||Ya(f,c)){let d=i(f);if(l?!yu(d,f.values[o],r):!r(d,f.values[o]))return f.values[o]=d,1}return 0},reconfigure:(f,u)=>{let d=i(f),p=u.config.address[s];if(p!=null){let g=Oo(u,p);if(this.dependencies.every(x=>x instanceof Ne?u.facet(x)===f.facet(x):x instanceof Gn?u.field(x,!1)==f.field(x,!1):!0)||(l?yu(d,g,r):r(d,g)))return f.values[o]=g,0}return f.values[o]=d,1}}}}function yu(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function Ya(n,e){let t=!1;for(let i of e)xr(n,i)&1&&(t=!0);return t}function L$(n,e,t){let i=t.map(a=>n[a.id]),r=t.map(a=>a.type),s=i.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let h=[];for(let c=0;c<i.length;c++){let f=Oo(a,i[c]);if(r[c]==2)for(let u of f)h.push(u);else h.push(f)}return e.combine(h)}return{create(a){for(let h of i)xr(a,h);return a.values[o]=l(a),1},update(a,h){if(!Ya(a,s))return 0;let c=l(a);return e.compare(c,a.values[o])?0:(a.values[o]=c,1)},reconfigure(a,h){let c=Ya(a,i),f=h.config.facets[e.id],u=h.facet(e);if(f&&!c&&Kh(t,f))return a.values[o]=u,0;let d=l(a);return e.compare(d,u)?(a.values[o]=u,0):(a.values[o]=d,1)}}}const wu=Ne.define({static:!0});class Gn{constructor(e,t,i,r,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new Gn(Jh++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(wu).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,r)=>{let s=i.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,r)=>r.config.address[this.id]!=null?(i.values[t]=r.field(this),0):(i.values[t]=this.create(i),1)}}init(e){return[this,wu.of({field:this,create:e})]}get extension(){return this}}const z$={lowest:4,low:3,default:2,high:1,highest:0};class _${constructor(e,t){this.inner=e,this.prec=t}}class Go{of(e){return new Ha(this,e)}reconfigure(e){return Go.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Ha{constructor(e,t){this.compartment=e,this.inner=t}}class mo{constructor(e,t,i,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let r=[],s=Object.create(null),o=new Map;for(let u of U$(e,t,o))u instanceof Gn?r.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let l=Object.create(null),a=[],h=[];for(let u of r)l[u.id]=h.length<<1,h.push(d=>u.slot(d));let c=i==null?void 0:i.config.facets;for(let u in s){let d=s[u],p=d[0].facet,g=c&&c[u]||[];if(d.every(x=>x.type==0))if(l[p.id]=a.length<<1|1,Kh(g,d))a.push(i.facet(p));else{let x=p.combine(d.map(Q=>Q.value));a.push(i&&p.compare(x,i.facet(p))?i.facet(p):x)}else{for(let x of d)x.type==0?(l[x.id]=a.length<<1|1,a.push(x.value)):(l[x.id]=h.length<<1,h.push(Q=>x.dynamicSlot(Q)));l[p.id]=h.length<<1,h.push(x=>L$(x,p,d))}}let f=h.map(u=>u(l));return new mo(e,o,f,l,a,s)}}function U$(n,e,t){let i=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a<=l)return;let h=i[a].indexOf(o);h>-1&&i[a].splice(h,1),o instanceof Ha&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let h of o)s(h,l);else if(o instanceof Ha){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),s(h,l)}else if(o instanceof _$)s(o.inner,o.prec);else if(o instanceof Gn)i[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof Ws)i[l].push(o),o.facet.extensions&&s(o.facet.extensions,l);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(h,l)}}return s(n,z$.default),i.reduce((o,l)=>o.concat(l))}function xr(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function Oo(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const Xg=Ne.define(),Zg=Ne.define({combine:n=>n.some(e=>e),static:!0}),jg=Ne.define({combine:n=>n.length?n[0]:void 0,static:!0}),Gg=Ne.define(),qg=Ne.define(),Fg=Ne.define(),Vg=Ne.define({combine:n=>n.length?n[0]:!1});class qr{constructor(e,t){this.type=e,this.value=t}static define(){return new N$}}class N${of(e){return new qr(this,e)}}class X${constructor(e){this.map=e}of(e){return new Je(this,e)}}class Je{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Je(this.type,t)}is(e){return this.type==e}static define(e={}){return new X$(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(t);s&&i.push(s)}return i}}Je.reconfigure=Je.define();Je.appendConfig=Je.define();class Ke{constructor(e,t,i,r,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Ng(i,t.newLength),s.some(l=>l.type==Ke.time)||(this.annotations=s.concat(Ke.time.of(Date.now())))}static create(e,t,i,r,s,o){return new Ke(e,t,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Ke.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Ke.time=qr.define();Ke.userEvent=qr.define();Ke.addToHistory=qr.define();Ke.remote=qr.define();function Z$(n,e){let t=[];for(let i=0,r=0;;){let s,o;if(i<n.length&&(r==e.length||e[r]>=n[i]))s=n[i++],o=n[i++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Yg(n,e,t){var i;let r,s,o;return t?(r=e.changes,s=Xe.empty(e.changes.length),o=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=n.selection)===null||i===void 0?void 0:i.map(r),effects:Je.mapEffects(n.effects,r).concat(Je.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Ja(n,e,t){let i=e.selection,r=Tn(e.annotations);return e.userEvent&&(r=r.concat(Ke.userEvent.of(e.userEvent))),{changes:e.changes instanceof Xe?e.changes:Xe.of(e.changes||[],t,n.facet(jg)),selection:i&&(i instanceof se?i:se.single(i.anchor,i.head)),effects:Tn(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Hg(n,e,t){let i=Ja(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=Yg(i,Ja(n,e[s],o?i.changes.newLength:n.doc.length),o)}let r=Ke.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return G$(t?j$(r):r)}function j$(n){let e=n.startState,t=!0;for(let r of e.facet(Gg)){let s=r(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:Z$(t,s))}if(t!==!0){let r,s;if(t===!1)s=n.changes.invertedDesc,r=Xe.empty(e.doc.length);else{let o=n.changes.filter(t);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Ke.create(e,r,n.selection&&n.selection.map(s),Je.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let i=e.facet(qg);for(let r=i.length-1;r>=0;r--){let s=i[r](n);s instanceof Ke?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Ke?n=s[0]:n=Hg(e,Tn(s),!1)}return n}function G$(n){let e=n.startState,t=e.facet(Fg),i=n;for(let r=t.length-1;r>=0;r--){let s=t[r](n);s&&Object.keys(s).length&&(i=Yg(n,Ja(e,s,n.changes.newLength),!0))}return i==n?n:Ke.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const q$=[];function Tn(n){return n==null?q$:Array.isArray(n)?n:[n]}var vi=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(vi||(vi={}));const F$=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Ka;try{Ka=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function V$(n){if(Ka)return Ka.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||F$.test(t)))return!0}return!1}function Y$(n){return e=>{if(!/\S/.test(e))return vi.Space;if(V$(e))return vi.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return vi.Word;return vi.Other}}class ve{constructor(e,t,i,r,s,o){this.config=e,this.doc=t,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)xr(this,l<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return xr(this,i),Oo(this,i)}update(...e){return Hg(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:r}=t;for(let o of e.effects)o.is(Go.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,a)=>r.set(a,l)),t=null),r.set(o.value.compartment,o.value.extension)):o.is(Je.reconfigure)?(t=null,i=o.value):o.is(Je.appendConfig)&&(t=null,i=Tn(i).concat(o.value));let s;t?s=e.startState.values.slice():(t=mo.resolve(i,r,this),s=new ve(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,a)=>a.reconfigure(l,this),null).values),new ve(t,e.newDoc,e.newSelection,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:se.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),r=this.changes(i.changes),s=[i.range],o=Tn(i.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),h=this.changes(a.changes),c=h.map(r);for(let u=0;u<l;u++)s[u]=s[u].map(c);let f=r.mapDesc(h,!0);s.push(a.range.map(f)),r=r.compose(c),o=Je.mapEffects(o,c).concat(Je.mapEffects(Tn(a.effects),f))}return{changes:r,selection:se.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Xe?e:Xe.of(e,this.doc.length,this.facet(ve.lineSeparator))}toText(e){return Se.of(e.split(this.facet(ve.lineSeparator)||qa))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(xr(this,t),Oo(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof Gn&&(t[i]=r.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i)for(let s in i){let o=i[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}return ve.create({doc:e.doc,selection:se.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=mo.resolve(e.extensions||[],new Map),i=e.doc instanceof Se?e.doc:Se.of((e.doc||"").split(t.staticFacet(ve.lineSeparator)||qa)),r=e.selection?e.selection instanceof se?e.selection:se.single(e.selection.anchor,e.selection.head):se.single(0);return Ng(r,i.length),t.staticFacet(Zg)||(r=r.asSingle()),new ve(t,i,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(ve.tabSize)}get lineBreak(){return this.facet(ve.lineSeparator)||`
`}get readOnly(){return this.facet(Vg)}phrase(e,...t){for(let i of this.facet(ve.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>t.length?i:t[s-1]})),e}languageDataAt(e,t,i=-1){let r=[];for(let s of this.facet(Xg))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return Y$(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,l=e-i;for(;o>0;){let a=Gi(t,o,!1);if(s(t.slice(a,o))!=vi.Word)break;o=a}for(;l<r;){let a=Gi(t,l);if(s(t.slice(l,a))!=vi.Word)break;l=a}return o==l?null:se.range(o+i,l+i)}}ve.allowMultipleSelections=Zg;ve.tabSize=Ne.define({combine:n=>n.length?n[0]:4});ve.lineSeparator=jg;ve.readOnly=Vg;ve.phrases=Ne.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(r=>n[r]==e[r])}});ve.languageData=Xg;ve.changeFilter=Gg;ve.transactionFilter=qg;ve.transactionExtender=Fg;Go.reconfigure=Je.define();class Mn{eq(e){return this==e}range(e,t=e){return Dr.create(e,t,this)}}Mn.prototype.startSide=Mn.prototype.endSide=0;Mn.prototype.point=!1;Mn.prototype.mapMode=ht.TrackDel;class Dr{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new Dr(e,t,i)}}function eh(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class ec{constructor(e,t,i,r){this.from=e,this.to=t,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,r=0){let s=i?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,h=s[a]-e||(i?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return h>=0?o:l;h>=0?l=a:o=a+1}}between(e,t,i,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let h=this.value[a],c=this.from[a]+e,f=this.to[a]+e,u,d;if(c==f){let p=t.mapPos(c,h.startSide,h.mapMode);if(p==null||(u=d=p,h.startSide!=h.endSide&&(d=t.mapPos(c,h.endSide),d<u)))continue}else if(u=t.mapPos(c,h.startSide),d=t.mapPos(f,h.endSide),u>d||u==d&&h.startSide>0&&h.endSide<=0)continue;(d-u||h.endSide-h.startSide)<0||(o<0&&(o=u),h.point&&(l=Math.max(l,d-u)),i.push(h),r.push(u-o),s.push(d-o))}return{mapped:i.length?new ec(r,s,i,l):null,pos:o}}}class it{constructor(e,t,i,r){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=r}static create(e,t,i,r){return new it(e,t,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(eh)),this.isEmpty)return t.length?it.of(t):this;let l=new Jg(this,null,-1).goto(0),a=0,h=[],c=new xo;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let f=t[a++];c.addInner(f.from,f.to,f.value)||h.push(f)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||h.push(Dr.create(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?it.empty:this.nextLayer.update({add:h,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],h=e.touchesRange(l,l+a.length);if(h===!1)r=Math.max(r,a.maxPoint),t.push(a),i.push(e.mapPos(l));else if(h===!0){let{mapped:c,pos:f}=a.map(l,e);c&&(r=Math.max(r,c.maxPoint),t.push(c),i.push(f))}}let s=this.nextLayer.map(e);return t.length==0?s:new it(i,t,s||it.empty,r)}between(e,t,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return Mr.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Mr.from(e).goto(t)}static compare(e,t,i,r,s=-1){let o=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),l=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),a=Su(o,l,i),h=new rr(o,a,s),c=new rr(l,a,s);i.iterGaps((f,u,d)=>ku(h,f,c,u,d,r)),i.empty&&i.length==0&&ku(h,0,c,0,0,r)}static eq(e,t,i=0,r){r==null&&(r=1e9);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Su(s,o),a=new rr(s,l,0).goto(i),h=new rr(o,l,0).goto(i);for(;;){if(a.to!=h.to||!th(a.active,h.active)||a.point&&(!h.point||!a.point.eq(h.point)))return!1;if(a.to>r)return!0;a.next(),h.next()}}static spans(e,t,i,r,s=-1){let o=new rr(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let h=Math.min(o.to,i);if(o.point?(r.point(l,h,o.point,o.activeForPoint(o.to),a,o.pointRank),a=o.openEnd(h)+(o.to>h?1:0)):h>l&&(r.span(l,h,o.active,a),a=o.openEnd(h)),o.to>i)break;l=o.to,o.next()}return a}static of(e,t=!1){let i=new xo;for(let r of e instanceof Dr?[e]:t?H$(e):e)i.add(r.from,r.to,r.value);return i.finish()}}it.empty=new it([],[],null,-1);function H$(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(eh(e,i)>0)return n.slice().sort(eh);e=i}return n}it.empty.nextLayer=it.empty;class xo{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new ec(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new xo)).add(e,t,i)}addInner(e,t,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(it.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=it.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Su(n,e,t){let i=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=i.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class Jg{constructor(e,t,i,r=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Mr{constructor(e){this.heap=e}static from(e,t=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new Jg(o,t,i,s));return r.length==1?r[0]:new Mr(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)El(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)El(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),El(this.heap,0)}}}function El(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let r=n[i];if(i+1<n.length&&r.compare(n[i+1])>=0&&(r=n[i+1],i++),t.compare(r)<0)break;n[i]=t,n[e]=r,e=i}}class rr{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Mr.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){xs(this.active,e),xs(this.activeTo,e),xs(this.activeRank,e),this.minActive=$u(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=s;)t++;bs(this.active,t,i),bs(this.activeTo,t,r),bs(this.activeRank,t,s),e&&bs(e,t,this.cursor.from),this.minActive=$u(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,r=0;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&xs(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.from<e&&(r=1),this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){let s=0;for(;s<i.length&&i[s]<e;)s++;this.openStart=s+r}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function ku(n,e,t,i,r,s){n.goto(e),t.goto(i);let o=i+r,l=i,a=i-e;for(;;){let h=n.to+a-t.to||n.endSide-t.endSide,c=h<0?n.to+a:t.to,f=Math.min(c,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&th(n.activeForPoint(n.to+a),t.activeForPoint(t.to))||s.comparePoint(l,f,n.point,t.point):f>l&&!th(n.active,t.active)&&s.compareRange(l,f,n.active,t.active),c>o)break;l=c,h<=0&&n.next(),h>=0&&t.next()}}function th(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function xs(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function bs(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function $u(n,e){let t=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||n[r].endSide-n[t].endSide)<0&&(t=r,i=e[r]);return t}function J$(n,e,t=n.length){let i=0;for(let r=0;r<t;)n.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=Gi(n,r));return i}function K$(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Kg(n){return n.nodeType==3?tm(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function vu(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function ev(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const em={left:0,right:0,top:0,bottom:0};function tc(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}let cn=null;function tv(n){if(n.setActive)return n.setActive();if(cn)return n.focus(cn);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(cn==null?{get preventScroll(){return cn={preventScroll:!0},!0}}:void 0),!cn){cn=!1;for(let t=0;t<e.length;){let i=e[t++],r=e[t++],s=e[t++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let Qu;function tm(n,e,t=e){let i=Qu||(Qu=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function im(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}class ai{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new ai(e.parentNode,vu(e),t)}static after(e,t){return new ai(e.parentNode,vu(e)+1,t)}}const nm=[];class vt{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(this.dirty&2){let t=this.dom,i=null,r;for(let s of this.children){if(s.dirty){if(!s.dom&&(r=i?i.nextSibling:t.firstChild)){let o=vt.get(r);(!o||!o.parent&&o.constructor==s.constructor)&&s.reuseDOM(r)}s.sync(e),s.dirty=0}if(r=i?i.nextSibling:t.firstChild,e&&!e.written&&e.node==t&&r!=s.dom&&(e.written=!0),s.dom.parentNode==t)for(;r&&r!=s.dom;)r=Tu(r);else t.insertBefore(s.dom,r);i=s.dom}for(r=i?i.nextSibling:t.firstChild,r&&e&&e.node==t&&(e.written=!0);r;)r=Tu(r)}else if(this.dirty&1)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let r=ev(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!vt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,h=i,c=i;a<this.children.length;a++){let f=this.children[a],u=h+f.length;if(h<e&&u>t)return f.domBoundsAround(e,t,h);if(u>=e&&r==-1&&(r=a,s=h),h>t&&f.dom.parentNode==this.dom){o=a,l=c;break}c=u,h=u+f.breakAfter}return{from:s,to:l<0?i+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=nm){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&s.destroy()}this.children.splice(e,t-e,...i);for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new iv(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,i,r,s,o){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}}vt.prototype.breakAfter=0;function Tu(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class iv{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function nv(n,e,t,i,r,s,o,l,a){let{children:h}=n,c=h.length?h[e]:null,f=s.length?s[s.length-1]:null,u=f?f.breakAfter:o;if(!(e==i&&c&&!o&&!u&&s.length<2&&c.merge(t,r,s.length?f:null,t==0,l,a))){if(i<h.length){let d=h[i];d&&r<d.length?(e==i&&(d=d.split(r),r=0),!u&&f&&d.merge(0,r,f,!0,0,a)?s[s.length-1]=d:(r&&d.merge(0,r,null,!1,0,a),s.push(d))):d!=null&&d.breakAfter&&(f?f.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,l,0),e++));e<i&&s.length;)if(h[i-1].become(s[s.length-1]))i--,s.pop(),a=s.length?0:l;else if(h[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&i<h.length&&!h[e-1].breakAfter&&h[i].merge(0,0,h[e-1],!1,l,a)&&e--,(e<i||s.length)&&n.replaceChildren(e,i,s)}}function rm(n,e,t,i,r,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:h,off:c}=o.findPos(e,-1),f=e-t;for(let u of i)f+=u.length;n.length+=f,nv(n,h,c,l,a,i,0,r,s)}let ct=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},ih=typeof document!="undefined"?document:{documentElement:{style:{}}};const nh=/Edge\/(\d+)/.exec(ct.userAgent),sm=/MSIE \d/.test(ct.userAgent),rh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ct.userAgent),qo=!!(sm||rh||nh),Pu=!qo&&/gecko\/(\d+)/i.test(ct.userAgent),Wl=!qo&&/Chrome\/(\d+)/.exec(ct.userAgent),Au="webkitFontSmoothing"in ih.documentElement.style,om=!qo&&/Apple Computer/.test(ct.vendor),Ru=om&&(/Mobile\/\w+/.test(ct.userAgent)||ct.maxTouchPoints>2);var et={mac:Ru||/Mac/.test(ct.platform),windows:/Win/.test(ct.platform),linux:/Linux|X11/.test(ct.platform),ie:qo,ie_version:sm?ih.documentMode||6:rh?+rh[1]:nh?+nh[1]:0,gecko:Pu,gecko_version:Pu?+(/Firefox\/(\d+)/.exec(ct.userAgent)||[0,0])[1]:0,chrome:!!Wl,chrome_version:Wl?+Wl[1]:0,ios:Ru,android:/Android\b/.test(ct.userAgent),webkit:Au,safari:om,webkit_version:Au?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:ih.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const rv=256;class en extends vt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return i&&(!(i instanceof en)||this.length-(t-e)+i.length>rv)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new en(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new ai(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return sv(this.dom,e,t)}}class tn extends vt{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let r of t)r.setParent(this)}setAttrs(e){if(im(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,i,r,s,o){return i&&(!(i instanceof tn&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(rm(this,e,t,i?i.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,r=-1,s=0;for(let l of this.children){let a=i+l.length;a>e&&t.push(i<e?l.split(e-i):l),r<0&&i>=e&&(r=s),i=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new tn(this.mark,t,o)}domAtPos(e){return lm(this.dom,this.children,e)}coordsAt(e,t){return hm(this,e,t)}}function sv(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?et.chrome||et.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):t<0?r--:s<i&&s++;let l=tm(n,r,s).getClientRects();if(!l.length)return em;let a=l[(o?o<0:t>=0)?0:l.length-1];return et.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,h=>h.width)||a),o?tc(a,o<0):a||null}class xn extends vt{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}static create(e,t,i){return new(e.customView||xn)(e,t,i)}split(e){let t=xn.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,r,s,o){return i&&(!(i instanceof xn)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof xn&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Se.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,i=t&&t.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):Se.empty}domAtPos(e){return e==0?ai.before(this.dom):ai.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),r=null;if(!i.length)return em;for(let s=e>0?i.length-1:0;r=i[s],!(e>0?s==0:s==i.length-1||r.top<r.bottom);s+=e>0?-1:1);return e==0&&t>0||e==this.length&&t<=0?r:tc(r,e==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class bo extends vt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof bo&&e.side==this.side}split(){return new bo(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return ai.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),i=ov(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return Se.empty}}en.prototype.children=xn.prototype.children=bo.prototype.children=nm;function ov(n,e){let t=n.parent,i=t?t.children.indexOf(n):-1;for(;t&&i>=0;)if(e<0?i>0:i<t.children.length){let r=t.children[i+e];if(r instanceof en){let s=r.coordsAt(e<0?r.length:0,e);if(s)return s}i+=e}else if(t instanceof tn&&t.parent)i=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let r=t.dom.lastChild;if(r&&r.nodeName=="BR")return r.getClientRects()[0];break}}function lm(n,e,t){let i=0;for(let r=0;i<e.length;i++){let s=e[i],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(t>r&&t<o&&s.dom.parentNode==n)return s.domAtPos(t-r);if(t<=r)break;r=o}}for(;i>0;i--){let r=e[i-1].dom;if(r.parentNode==n)return ai.after(r)}return new ai(n,0)}function am(n,e,t){let i,{children:r}=n;t>0&&e instanceof tn&&r.length&&(i=r[r.length-1])instanceof tn&&i.mark.eq(e.mark)?am(i,e.children[0],t-1):(r.push(e),e.setParent(n)),n.length+=e.length}function hm(n,e,t){for(let s=0,o=0;o<n.children.length;o++){let l=n.children[o],a=s+l.length,h;if((t<=0||a==n.length||l.getSide()>0?a>=e:a>e)&&(e<a||o+1==n.children.length||(h=n.children[o+1]).length||h.getSide()>0)){let c=0;if(a==s){if(l.getSide()<=0)continue;c=t=-l.getSide()}let f=l.coordsAt(Math.max(0,e-s),t);return c&&f?tc(f,t<0):f}s=a}let i=n.dom.lastChild;if(!i)return n.dom.getBoundingClientRect();let r=Kg(i);return r[r.length-1]||null}function Cu(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}function ic(n,e){if(n==e)return!0;if(!n||!e)return!1;let t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r of t)if(i.indexOf(r)==-1||n[r]!==e[r])return!1;return!0}function lv(n,e,t){let i=null;if(e)for(let r in e)t&&r in t||n.removeAttribute(i=r);if(t)for(let r in t)e&&e[r]==t[r]||n.setAttribute(i=r,t[r]);return!!i}var Pn=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(Pn||(Pn={}));class Fo extends Mn{constructor(e,t,i,r){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Vo(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new Br(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=cm(e,t);i=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new Br(e,i,r,t,e.widget||null,!0)}static line(e){return new Fr(e)}static set(e,t=!1){return it.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Fo.none=it.empty;class Vo extends Fo{constructor(e){let{start:t,end:i}=cm(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof Vo&&this.tagName==e.tagName&&this.class==e.class&&ic(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Vo.prototype.point=!1;class Fr extends Fo{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Fr&&ic(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Fr.prototype.mapMode=ht.TrackBefore;Fr.prototype.point=!0;class Br extends Fo{constructor(e,t,i,r,s,o){super(t,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?ht.TrackBefore:ht.TrackAfter:ht.TrackDel}get type(){return this.startSide<this.endSide?Pn.WidgetRange:this.startSide<=0?Pn.WidgetBefore:Pn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Br&&av(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Br.prototype.point=!0;function cm(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t!=null?t:e,end:i!=null?i:e}}function av(n,e){return n==e||!!(n&&e&&n.compare(e))}class An extends vt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,r,s,o){if(i){if(!(i instanceof An))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),rm(this,e,t,i?i.children:[],s,o),!0}split(e){let t=new An;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:r}=this.childPos(e);r&&(t.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){ic(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){am(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=Cu(t,this.attrs||{})),i&&(this.attrs=Cu({class:i},this.attrs||{}))}domAtPos(e){return lm(this.dom,this.children,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?this.dirty&4&&(im(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(lv(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let i=this.dom.lastChild;for(;i&&vt.get(i)instanceof tn;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((t=vt.get(i))===null||t===void 0?void 0:t.isEditable)==!1&&(!et.ios||!this.children.some(r=>r instanceof en))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof en))return null;let i=Kg(t.dom);if(i.length!=1)return null;e+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return hm(this,e,t)}become(e){return!1}get type(){return Pn.Text}static find(e,t){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=t){if(s instanceof An)return s;if(o>t)break}r=o+s.breakAfter}return null}}const hv=Ne.define(),cv=Ne.define(),fv=Ne.define();var yo=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(yo||(yo={}));yo.LTR;yo.RTL;const Iu=Object.create(null);for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Iu[e]=t,Iu[t]=-e}function uv(n,e,t=1){let i=n.charCategorizer(e),r=n.doc.lineAt(e),s=e-r.from;if(r.length==0)return se.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=Gi(r.text,s,!1):l=Gi(r.text,s);let a=i(r.text.slice(o,l));for(;o>0;){let h=Gi(r.text,o,!1);if(i(r.text.slice(h,o))!=a)break;o=h}for(;l<r.length;){let h=Gi(r.text,l);if(i(r.text.slice(l,h))!=a)break;l=h}return se.range(o+r.from,l+r.from)}const dv=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],pv=[16,17,18,20,91,92,224,225];class gv{constructor(e,t,i,r){this.view=e,this.style=i,this.mustSelect=r,this.lastEvent=t;let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ve.allowMultipleSelections)&&mv(e,t),this.dragMove=Ov(e,t),this.dragging=xv(e,t)&&nc(t)==1?null:!1,this.dragging===!1&&(t.preventDefault(),this.select(t))}move(e){if(e.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=e)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function mv(n,e){let t=n.state.facet(hv);return t.length?t[0](e):et.mac?e.metaKey:e.ctrlKey}function Ov(n,e){let t=n.state.facet(cv);return t.length?t[0](e):et.mac?!e.altKey:!e.ctrlKey}function xv(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=K$(n.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}const Ge=Object.create(null),fm=et.ie&&et.ie_version<15||et.ios&&et.webkit_version<604;function bv(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),um(n,t.value)},50)}function um(n,e){let{state:t}=n,i,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(sh!=null&&t.selection.ranges.every(a=>a.empty)&&sh==s.toString()){let a=-1;i=t.changeByRange(h=>{let c=t.doc.lineAt(h.from);if(c.from==a)return{range:h};a=c.from;let f=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:f},range:se.cursor(h.from+f.length)}})}else o?i=t.changeByRange(a=>{let h=s.line(r++);return{changes:{from:a.from,to:a.to,insert:h.text},range:se.cursor(a.from+h.length)}}):i=t.replaceSelection(s);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Ge.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():pv.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};let dm=0;Ge.touchstart=(n,e)=>{dm=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};Ge.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Ge.mousedown=(n,e)=>{if(n.observer.flush(),dm>Date.now()-2e3&&nc(e)==1)return;let t=null;for(let i of n.state.facet(fv))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=Sv(n,e)),t){let i=n.root.activeElement!=n.contentDOM;i&&n.observer.ignore(()=>tv(n.contentDOM)),n.inputState.startMouseSelection(new gv(n,e,t,i))}};function Eu(n,e,t,i){if(i==1)return se.cursor(e,t);if(i==2)return uv(n.state,e,t);{let r=An.find(n.docView,e),s=n.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,se.range(o,l)}}let pm=(n,e)=>n>=e.top&&n<=e.bottom,Wu=(n,e,t)=>pm(e,t)&&n>=t.left&&n<=t.right;function yv(n,e,t,i){let r=An.find(n.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&Wu(t,i,o))return-1;let l=r.coordsAt(s,1);return l&&Wu(t,i,l)?1:o&&pm(i,o)?-1:1}function Du(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:yv(n,t,e.clientX,e.clientY)}}const wv=et.ie&&et.ie_version<=11;let Mu=null,Bu=0,Lu=0;function nc(n){if(!wv)return n.detail;let e=Mu,t=Lu;return Mu=n,Lu=Date.now(),Bu=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(Bu+1)%3:1}function Sv(n,e){let t=Du(n,e),i=nc(e),r=n.state.selection,s=t,o=e;return{update(l){l.docChanged&&(t&&(t.pos=l.changes.mapPos(t.pos)),r=r.map(l.changes),o=null)},get(l,a,h){let c;if(o&&l.clientX==o.clientX&&l.clientY==o.clientY?c=s:(c=s=Du(n,l),o=l),!c||!t)return r;let f=Eu(n,c.pos,c.bias,i);if(t.pos!=c.pos&&!a){let u=Eu(n,t.pos,t.bias,i),d=Math.min(u.from,f.from),p=Math.max(u.to,f.to);f=d<f.from?se.range(d,p):se.range(p,d)}return a?r.replaceRange(r.main.extend(f.from,f.to)):h?r.addRange(f):se.create([f])}}}Ge.dragstart=(n,e)=>{let{selection:{main:t}}=n.state,{mouseSelection:i}=n.inputState;i&&(i.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function zu(n,e,t,i){if(!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=n.inputState,o=i&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}Ge.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let i=Array(t.length),r=0,s=()=>{++r==t.length&&zu(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),s()},l.readAsText(t[o])}}else zu(n,e,e.dataTransfer.getData("Text"),!0)};Ge.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let t=fm?null:e.clipboardData;t?(um(n,t.getData("text/plain")),e.preventDefault()):bv(n)};function kv(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function $v(n){let e=[],t=[],i=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),r=o.number}i=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:i}}let sh=null;Ge.copy=Ge.cut=(n,e)=>{let{text:t,ranges:i,linewise:r}=$v(n.state);if(!t&&!r)return;sh=r?t:null;let s=fm?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",t)):kv(n,t),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};function gm(n){setTimeout(()=>{n.hasFocus!=n.inputState.notifiedFocused&&n.update([])},10)}Ge.focus=gm;Ge.blur=n=>{n.observer.clearSelectionRange(),gm(n)};function mm(n,e){if(n.docView.compositionDeco.size){n.inputState.rapidCompositionStart=e;try{n.update([])}finally{n.inputState.rapidCompositionStart=!1}}}Ge.compositionstart=Ge.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0,n.docView.compositionDeco.size&&(n.observer.flush(),mm(n,!0)))};Ge.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionFirstChange=null,setTimeout(()=>{n.inputState.composing<0&&mm(n,!1)},50)};Ge.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ge.beforeinput=(n,e)=>{var t;let i;if(et.chrome&&et.android&&(i=dv.find(r=>r.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const vv=!et.ios,Qv={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};vv&&(Qv[".cm-line"].caretColor="transparent !important");class Bn extends Mn{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Bn.prototype.elementClass="";Bn.prototype.toDOM=void 0;Bn.prototype.mapMode=ht.TrackBefore;Bn.prototype.startSide=Bn.prototype.endSide=-1;Bn.prototype.point=!0;const Tv=1024;let Pv=0;class $e{constructor(e={}){this.id=Pv++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Qt.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}$e.closedBy=new $e({deserialize:n=>n.split(" ")});$e.openedBy=new $e({deserialize:n=>n.split(" ")});$e.group=new $e({deserialize:n=>n.split(" ")});$e.contextHash=new $e({perNode:!0});$e.lookAhead=new $e({perNode:!0});$e.mounted=new $e({perNode:!0});const Av=Object.create(null);class Qt{constructor(e,t,i,r=0){this.name=e,this.props=t,this.id=i,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Av,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Qt(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop($e.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let r of i.split(" "))t[r]=e[i];return i=>{for(let r=i.prop($e.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?i.name:r[s]];if(o)return o}}}}Qt.none=new Qt("",Object.create(null),0,8);const ys=new WeakMap,_u=new WeakMap;var Ve;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Ve||(Ve={}));class Zt{constructor(e,t,i,r,s){if(this.type=e,this.children=t,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=this.prop($e.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let r=i.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new ko(this.topNode,e)}cursorAt(e,t=0,i=0){let r=ys.get(this)||this.topNode,s=new ko(r);return s.moveTo(e,t),ys.set(this,s._tree),s}get topNode(){return new si(this,0,0,null)}resolve(e,t=0){let i=Ln(ys.get(this)||this.topNode,e,t,!1);return ys.set(this,i),i}resolveInner(e,t=0){let i=Ln(_u.get(this)||this.topNode,e,t,!0);return _u.set(this,i),i}iterate(e){let{enter:t,leave:i,from:r=0,to:s=this.length}=e;for(let o=this.cursor((e.mode||0)|Ve.IncludeAnonymous);;){let l=!1;if(o.from<=s&&o.to>=r&&(o.type.isAnonymous||t(o)!==!1)){if(o.firstChild())continue;l=!0}for(;l&&i&&!o.type.isAnonymous&&i(o),!o.nextSibling();){if(!o.parent())return;l=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:oc(Qt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,r)=>new Zt(this.type,t,i,r,this.propValues),e.makeTree||((t,i,r)=>new Zt(Qt.none,t,i,r)))}static build(e){return Cv(e)}}Zt.empty=new Zt(Qt.none,[],[],0);class rc{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new rc(this.buffer,this.index)}}class on{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Qt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(Om(s,r,o[a+1],o[a+2])&&(l=a,i>0));a=o[a+3]);return l}slice(e,t,i,r){let s=this.buffer,o=new Uint16Array(t-e);for(let l=e,a=0;l<t;)o[a++]=s[l++],o[a++]=s[l++]-i,o[a++]=s[l++]-i,o[a++]=s[l++]-e;return new on(o,r-i,this.set)}}function Om(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function xm(n,e){let t=n.childBefore(e);for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}function Ln(n,e,t,i){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!i&&n instanceof si&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=i?0:Ve.IgnoreOverlays;if(i)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof si&&o.index<0&&((r=l.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(n=l);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class si{constructor(e,t,i,r){this._tree=e,this.from=t,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,h=t>0?l.length:-1;e!=h;e+=t){let c=l[e],f=a[e]+o.from;if(!!Om(r,i,f,f+c.length)){if(c instanceof on){if(s&Ve.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,i-f,r);if(u>-1)return new Qi(new Rv(o,c,e,f),null,u)}else if(s&Ve.IncludeAnonymous||!c.type.isAnonymous||sc(c)){let u;if(!(s&Ve.IgnoreMounts)&&c.props&&(u=c.prop($e.mounted))&&!u.overlay)return new si(u.tree,f,e,o);let d=new si(c,f,e,o);return s&Ve.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,i,r)}}}if(s&Ve.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let r;if(!(i&Ve.IgnoreOverlays)&&(r=this._tree.prop($e.mounted))&&r.overlay){let s=e-this.from;for(let{from:o,to:l}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new si(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new ko(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return Ln(this,e,t,!1)}resolveInner(e,t=0){return Ln(this,e,t,!0)}enterUnfinishedNodesBefore(e){return xm(this,e)}getChild(e,t=null,i=null){let r=wo(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return wo(this,e,t,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return So(this,e)}}function wo(n,e,t,i){let r=n.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(;!r.type.is(t);)if(!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function So(n,e,t=e.length-1){for(let i=n.parent;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class Rv{constructor(e,t,i,r){this.parent=e,this.buffer=t,this.index=i,this.start=r}}class Qi{constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new Qi(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&Ve.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Qi(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Qi(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Qi(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new ko(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1],l=i.buffer[this.index+2];e.push(i.slice(r,s,o,l)),t.push(0)}return new Zt(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Ln(this,e,t,!1)}resolveInner(e,t=0){return Ln(this,e,t,!0)}enterUnfinishedNodesBefore(e){return xm(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let r=wo(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return wo(this,e,t,i)}get node(){return this}matchContext(e){return So(this,e)}}class ko{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof si)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof si?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&Ve.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ve.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ve.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=r)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let l=i._tree.children[s];if(this.mode&Ve.IncludeAnonymous||l instanceof on||!l.type.isAnonymous||sc(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer){e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,i=s+1;break e}r=this.stack[--s]}}for(let r=i;r<this.stack.length;r++)t=new Qi(this.buffer,t,this.stack[r]);return this.bufferNode=new Qi(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return So(this.node,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return So(this.node,e,r);let o=i[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function sc(n){return n.children.some(e=>e instanceof on||!e.type.isAnonymous||sc(e))}function Cv(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:r=Tv,reused:s=[],minRepeatType:o=i.types.length}=n,l=Array.isArray(t)?new rc(t,t.length):t,a=i.types,h=0,c=0;function f(y,w,v,R,N){let{id:M,start:C,end:O,size:k}=l,T=c;for(;k<0;)if(l.next(),k==-1){let X=s[M];v.push(X),R.push(C-y);return}else if(k==-3){h=M;return}else if(k==-4){c=M;return}else throw new RangeError(`Unrecognized record size: ${k}`);let z=a[M],W,D,U=C-y;if(O-C<=r&&(D=g(l.pos-w,N))){let X=new Uint16Array(D.size-D.skip),_=l.pos-D.size,q=X.length;for(;l.pos>_;)q=x(D.start,X,q);W=new on(X,O-D.start,i),U=D.start-y}else{let X=l.pos-k;l.next();let _=[],q=[],I=M>=o?M:-1,V=0,oe=O;for(;l.pos>X;)I>=0&&l.id==I&&l.size>=0?(l.end<=oe-r&&(d(_,q,C,V,l.end,oe,I,T),V=_.length,oe=l.end),l.next()):f(C,X,_,q,I);if(I>=0&&V>0&&V<_.length&&d(_,q,C,V,C,oe,I,T),_.reverse(),q.reverse(),I>-1&&V>0){let ue=u(z);W=oc(z,_,q,0,_.length,0,O-C,ue,ue)}else W=p(z,_,q,O-C,T-O)}v.push(W),R.push(U)}function u(y){return(w,v,R)=>{let N=0,M=w.length-1,C,O;if(M>=0&&(C=w[M])instanceof Zt){if(!M&&C.type==y&&C.length==R)return C;(O=C.prop($e.lookAhead))&&(N=v[M]+C.length+O)}return p(y,w,v,R,N)}}function d(y,w,v,R,N,M,C,O){let k=[],T=[];for(;y.length>R;)k.push(y.pop()),T.push(w.pop()+v-N);y.push(p(i.types[C],k,T,M-N,O-M)),w.push(N-v)}function p(y,w,v,R,N=0,M){if(h){let C=[$e.contextHash,h];M=M?[C].concat(M):[C]}if(N>25){let C=[$e.lookAhead,N];M=M?[C].concat(M):[C]}return new Zt(y,w,v,R,M)}function g(y,w){let v=l.fork(),R=0,N=0,M=0,C=v.end-r,O={size:0,start:0,skip:0};e:for(let k=v.pos-y;v.pos>k;){let T=v.size;if(v.id==w&&T>=0){O.size=R,O.start=N,O.skip=M,M+=4,R+=4,v.next();continue}let z=v.pos-T;if(T<0||z<k||v.start<C)break;let W=v.id>=o?4:0,D=v.start;for(v.next();v.pos>z;){if(v.size<0)if(v.size==-3)W+=4;else break e;else v.id>=o&&(W+=4);v.next()}N=D,R+=T,M+=W}return(w<0||R==y)&&(O.size=R,O.start=N,O.skip=M),O.size>4?O:void 0}function x(y,w,v){let{id:R,start:N,end:M,size:C}=l;if(l.next(),C>=0&&R<o){let O=v;if(C>4){let k=l.pos-(C-4);for(;l.pos>k;)v=x(y,w,v)}w[--v]=O,w[--v]=M-y,w[--v]=N-y,w[--v]=R}else C==-3?h=R:C==-4&&(c=R);return v}let Q=[],m=[];for(;l.pos>0;)f(n.start||0,n.bufferStart||0,Q,m,-1);let b=(e=n.length)!==null&&e!==void 0?e:Q.length?m[0]+Q[0].length:0;return new Zt(a[n.topID],Q.reverse(),m.reverse(),b)}const Uu=new WeakMap;function Ds(n,e){if(!n.isAnonymous||e instanceof on||e.type!=n)return 1;let t=Uu.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof Zt)){t=1;break}t+=Ds(n,i)}Uu.set(e,t)}return t}function oc(n,e,t,i,r,s,o,l,a){let h=0;for(let p=i;p<r;p++)h+=Ds(n,e[p]);let c=Math.ceil(h*1.5/8),f=[],u=[];function d(p,g,x,Q,m){for(let b=x;b<Q;){let y=b,w=g[b],v=Ds(n,p[b]);for(b++;b<Q;b++){let R=Ds(n,p[b]);if(v+R>=c)break;v+=R}if(b==y+1){if(v>c){let R=p[y];d(R.children,R.positions,0,R.children.length,g[y]+m);continue}f.push(p[y])}else{let R=g[b-1]+p[b-1].length-w;f.push(oc(n,p,g,y,b,w,R,null,a))}u.push(w+m-s)}}return d(e,t,i,r,0),(l||a)(f,u,o)}new $e({perNode:!0});let Iv=0;class Lt{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=Iv++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new Lt([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new $o;return t=>t.modified.indexOf(e)>-1?t:$o.get(t.base||t,t.modified.concat(e).sort((i,r)=>i.id-r.id))}}let Ev=0;class $o{constructor(){this.instances=[],this.id=Ev++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(l=>l.base==e&&Wv(t,l.modified));if(i)return i;let r=[],s=new Lt(r,e,t);for(let l of t)l.instances.push(s);let o=bm(t);for(let l of e.set)for(let a of o)r.push($o.get(l,a));return s}}function Wv(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function bm(n){let e=[n];for(let t=0;t<n.length;t++)for(let i of bm(n.slice(0,t).concat(n.slice(t+1))))e.push(i);return e}function Dv(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let f=0;;){if(l=="..."&&f>0&&f+3==r.length){o=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!u)throw new RangeError("Invalid path: "+r);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),f+=u[0].length,f==r.length)break;let d=r[f++];if(f==r.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+r);l=r.slice(f)}let a=s.length-1,h=s[a];if(!h)throw new RangeError("Invalid path: "+r);let c=new Bv(i,o,a>0?s.slice(0,a):null);e[h]=c.sort(e[h])}}return Mv.add(e)}const Mv=new $e;class Bv{constructor(e,t,i,r){this.tags=e,this.mode=t,this.context=i,this.next=r}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function Lv(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let l of s)for(let a of l.set){let h=t[a.id];if(h){o=o?o+" "+h:h;break}}return o},scope:i}}const L=Lt.define,ws=L(),Oi=L(),Nu=L(Oi),Xu=L(Oi),xi=L(),Ss=L(xi),Dl=L(xi),Mt=L(),Ui=L(Mt),Et=L(),Wt=L(),oh=L(),sr=L(oh),ks=L(),ie={comment:ws,lineComment:L(ws),blockComment:L(ws),docComment:L(ws),name:Oi,variableName:L(Oi),typeName:Nu,tagName:L(Nu),propertyName:Xu,attributeName:L(Xu),className:L(Oi),labelName:L(Oi),namespace:L(Oi),macroName:L(Oi),literal:xi,string:Ss,docString:L(Ss),character:L(Ss),attributeValue:L(Ss),number:Dl,integer:L(Dl),float:L(Dl),bool:L(xi),regexp:L(xi),escape:L(xi),color:L(xi),url:L(xi),keyword:Et,self:L(Et),null:L(Et),atom:L(Et),unit:L(Et),modifier:L(Et),operatorKeyword:L(Et),controlKeyword:L(Et),definitionKeyword:L(Et),moduleKeyword:L(Et),operator:Wt,derefOperator:L(Wt),arithmeticOperator:L(Wt),logicOperator:L(Wt),bitwiseOperator:L(Wt),compareOperator:L(Wt),updateOperator:L(Wt),definitionOperator:L(Wt),typeOperator:L(Wt),controlOperator:L(Wt),punctuation:oh,separator:L(oh),bracket:sr,angleBracket:L(sr),squareBracket:L(sr),paren:L(sr),brace:L(sr),content:Mt,heading:Ui,heading1:L(Ui),heading2:L(Ui),heading3:L(Ui),heading4:L(Ui),heading5:L(Ui),heading6:L(Ui),contentSeparator:L(Mt),list:L(Mt),quote:L(Mt),emphasis:L(Mt),strong:L(Mt),link:L(Mt),monospace:L(Mt),strikethrough:L(Mt),inserted:L(),deleted:L(),changed:L(),invalid:L(),meta:ks,documentMeta:L(ks),annotation:L(ks),processingInstruction:L(ks),definition:Lt.defineModifier(),constant:Lt.defineModifier(),function:Lt.defineModifier(),standard:Lt.defineModifier(),local:Lt.defineModifier(),special:Lt.defineModifier()};Lv([{tag:ie.link,class:"tok-link"},{tag:ie.heading,class:"tok-heading"},{tag:ie.emphasis,class:"tok-emphasis"},{tag:ie.strong,class:"tok-strong"},{tag:ie.keyword,class:"tok-keyword"},{tag:ie.atom,class:"tok-atom"},{tag:ie.bool,class:"tok-bool"},{tag:ie.url,class:"tok-url"},{tag:ie.labelName,class:"tok-labelName"},{tag:ie.inserted,class:"tok-inserted"},{tag:ie.deleted,class:"tok-deleted"},{tag:ie.literal,class:"tok-literal"},{tag:ie.string,class:"tok-string"},{tag:ie.number,class:"tok-number"},{tag:[ie.regexp,ie.escape,ie.special(ie.string)],class:"tok-string2"},{tag:ie.variableName,class:"tok-variableName"},{tag:ie.local(ie.variableName),class:"tok-variableName tok-local"},{tag:ie.definition(ie.variableName),class:"tok-variableName tok-definition"},{tag:ie.special(ie.variableName),class:"tok-variableName2"},{tag:ie.definition(ie.propertyName),class:"tok-propertyName tok-definition"},{tag:ie.typeName,class:"tok-typeName"},{tag:ie.namespace,class:"tok-namespace"},{tag:ie.className,class:"tok-className"},{tag:ie.macroName,class:"tok-macroName"},{tag:ie.propertyName,class:"tok-propertyName"},{tag:ie.operator,class:"tok-operator"},{tag:ie.comment,class:"tok-comment"},{tag:ie.meta,class:"tok-meta"},{tag:ie.invalid,class:"tok-invalid"},{tag:ie.punctuation,class:"tok-punctuation"}]);var Ml;typeof navigator!="undefined"&&((Ml=navigator.scheduling)===null||Ml===void 0||Ml.isInputPending);const lc=Ne.define({combine:n=>{if(!n.length)return"  ";if(!/^(?: +|\t+)$/.test(n[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return n[0]}});function zv(n){let e=n.facet(lc);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function _v(n,e){let t="",i=n.tabSize;if(n.facet(lc).charCodeAt(0)==9)for(;e>=i;)t+="	",e-=i;for(let r=0;r<e;r++)t+=" ";return t}const Uv=Object.create(null),Zu=[Qt.none],ju=[],Nv=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Nv[n]=Xv(Uv,e);function Bl(n,e){ju.indexOf(n)>-1||(ju.push(n),console.warn(e))}function Xv(n,e){let t=null;for(let s of e.split(".")){let o=n[s]||ie[s];o?typeof o=="function"?t?t=o(t):Bl(s,`Modifier ${s} used at start of tag`):t?Bl(s,`Tag ${s} used as modifier`):t=o:Bl(s,`Unknown highlighting tag ${s}`)}if(!t)return 0;let i=e.replace(/ /g,"_"),r=Qt.define({id:Zu.length,name:i,props:[Dv({[i]:t})]});return Zu.push(r),r.id}function ym(n,e){let t=-1;return n.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let l=n.doc.lineAt(o);l.number>t&&(i.empty||i.to>l.from)&&(e(l,r,i),t=l.number),o=l.to+1}let s=n.changes(r);return{changes:r,range:se.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const Zv=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(ym(n,(t,i)=>{i.push({from:t.from,insert:n.facet(lc)})}),{userEvent:"input.indent"})),!0),jv=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(ym(n,(t,i)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=J$(r,n.tabSize),o=0,l=_v(n,Math.max(0,s-zv(n)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),Gv={key:"Tab",run:Zv,shift:jv};class vo{constructor(e,t,i,r,s,o,l,a,h,c=0,f){this.p=e,this.stack=t,this.state=i,this.reducePos=r,this.pos=s,this.score=o,this.buffer=l,this.bufferBase=a,this.curContext=h,this.lookAhead=c,this.parent=f}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let r=e.parser.context;return new vo(e,[],t,i,i,0,[],0,r?new Gu(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){let t=e>>19,i=e&65535,{parser:r}=this.p,s=r.dynamicPrecedence(i);if(s&&(this.score+=s),t==0){this.pushState(r.getGoto(this.state,i,!0),this.reducePos),i<r.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),this.reduceContext(i,this.reducePos);return}let o=this.stack.length-(t-1)*3-(e&262144?6:0),l=this.stack[o-2],a=this.stack[o-1],h=this.bufferBase+this.buffer.length-a;if(i<r.minRepeatTerm||e&131072){let c=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,l,c,h+4,!0)}if(e&262144)this.state=this.stack[o];else{let c=this.stack[o-3];this.state=r.getGoto(c,i,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(i,l)}storeNode(e,t,i,r=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(t==i)return;if(o.buffer[l-2]>=t){o.buffer[l-2]=i;return}}}if(!s||this.pos==i)this.buffer.push(e,t,i,r);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,r>4&&(r-=4);this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=i,this.buffer[o+3]=r}}shift(e,t,i){let r=this.pos;if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let s=e,{parser:o}=this.p;(i>this.pos||t<=o.maxNode)&&(this.pos=i,o.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,r),this.shiftContext(t,r),t<=o.maxNode&&this.buffer.push(t,r,i,4)}else this.pos=i,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,i,4)}apply(e,t,i){e&65536?this.reduce(e):this.shift(e,t,i)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(i,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new vo(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new qv(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if((i&65536)==0)return!0;if(i==0)return!1;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>4<<1||this.stack.length>=120){let r=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&r.push(t[s],o);if(this.stack.length<120)for(let s=0;r.length<4<<1&&s<t.length;s+=2){let o=t[s+1];r.some((l,a)=>a&1&&l==o)||r.push(t[s],o)}t=r}let i=[];for(let r=0;r<t.length&&i.length<4;r+=2){let s=t[r+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[r],this.pos),o.score-=200,i.push(o)}return i}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if((e&65536)==0)return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let i=e>>19,r=e&65535,s=this.stack.length-i*3;if(s<0||t.getGoto(this.stack[s],r,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Gu(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Gu{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}var qu;(function(n){n[n.Insert=200]="Insert",n[n.Delete=190]="Delete",n[n.Reduce=100]="Reduce",n[n.MaxNext=4]="MaxNext",n[n.MaxInsertStackDepth=300]="MaxInsertStackDepth",n[n.DampenInsertStackDepth=120]="DampenInsertStackDepth"})(qu||(qu={}));class qv{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class Qo{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Qo(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Qo(this.stack,this.pos,this.index)}}class Ms{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Fu=new Ms;class Fv{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Fu,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,r=this.rangeIndex,s=this.pos+e;for(;s<i.from;){if(!r)return null;let o=this.ranges[--r];s-=i.from-o.to,i=o}for(;t<0?s>i.to:s>=i.to;){if(r==this.ranges.length-1)return null;let o=this.ranges[++r];s+=o.from-i.to,i=o}return s}peek(e){let t=this.chunkOff+e,i,r;if(t>=0&&t<this.chunk.length)i=this.pos+e,r=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(i=s,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=i;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-i)),r=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),r}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Fu,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(i+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return i}}class Bs{constructor(e,t){this.data=e,this.id=t}token(e,t){Vv(this.data,e,t,this.id)}}Bs.prototype.contextual=Bs.prototype.fallback=Bs.prototype.extend=!1;class Yo{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function Vv(n,e,t,i){let r=0,s=1<<i,{parser:o}=t.p,{dialect:l}=o;e:for(;(s&n[r])!=0;){let a=n[r+1];for(let h=r+3;h<a;h+=2)if((n[h+1]&s)>0){let c=n[h];if(l.allows(c)&&(e.token.value==-1||e.token.value==c||o.overrides(c,e.token.value))){e.acceptToken(c);break}}for(let h=e.next,c=0,f=n[r+2];c<f;){let u=c+f>>1,d=a+u+(u<<1),p=n[d],g=n[d+1];if(h<p)f=u;else if(h>=g)c=u+1;else{r=n[d+2],e.advance();continue e}}break}}function $s(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let i=0,r=0;i<n.length;){let s=0;for(;;){let o=n.charCodeAt(i++),l=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let a=o-32;if(a>=46&&(a-=46,l=!0),s+=a,l)break;s*=46}t?t[r++]=s:t=new e(s)}return t}const kt=typeof process!="undefined"&&process.env&&/\bparse\b/.test({}.LOG);let Ll=null;var Vu;(function(n){n[n.Margin=25]="Margin"})(Vu||(Vu={}));function Yu(n,e,t){let i=n.cursor(ze.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(n.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:n.length}}class Yv{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Yu(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Yu(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],r=this.index[t];if(r==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[r],o=this.start[t]+i.positions[r];if(o>e)return this.nextStart=o,null;if(s instanceof Ae){if(o==e){if(o<this.safeFrom)return null;let l=o+s.length;if(l<=this.safeTo){let a=s.prop(ne.lookAhead);if(!a||l+a<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class Hv{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new Ms)}getActions(e){let t=0,i=null,{parser:r}=e.p,{tokenizers:s}=r,o=r.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,a=0;for(let h=0;h<s.length;h++){if((1<<h&o)==0)continue;let c=s[h],f=this.tokens[h];if(!(i&&!c.fallback)&&((c.contextual||f.start!=e.pos||f.mask!=o||f.context!=l)&&(this.updateCachedToken(f,c,e),f.mask=o,f.context=l),f.lookAhead>f.end+25&&(a=Math.max(f.lookAhead,a)),f.value!=0)){let u=t;if(f.extended>-1&&(t=this.addActions(e,f.extended,f.end,t)),t=this.addActions(e,f.value,f.end,t),!c.extend&&(i=f,t>u))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!i&&e.pos==this.stream.end&&(i=new Ms,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Ms,{pos:i,p:r}=e;return t.start=i,t.end=Math.min(i+1,r.stream.end),t.value=i==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,i){if(t.token(this.stream.reset(i.pos,e),i),e.value>-1){let{parser:r}=i.p;for(let s=0;s<r.specialized.length;s++)if(r.specialized[s]==e.value){let o=r.specializers[s](this.stream.read(e.start,e.end),i);if(o>=0&&i.p.parser.dialect.allows(o>>1)){(o&1)==0?e.value=o>>1:e.extended=o>>1;break}}}else e.value=0,e.end=Math.min(i.p.stream.end,i.pos+1)}putAction(e,t,i,r){for(let s=0;s<r;s+=3)if(this.actions[s]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=i,r}addActions(e,t,i,r){let{state:s}=e,{parser:o}=e.p,{data:l}=o;for(let a=0;a<2;a++)for(let h=o.stateSlot(s,a?2:1);;h+=3){if(l[h]==65535)if(l[h+1]==1)h=Jt(l,h+2);else{r==0&&l[h+1]==2&&(r=this.putAction(Jt(l,h+2),t,i,r));break}l[h]==t&&(r=this.putAction(Jt(l,h+1),t,i,r))}return r}}var Hu;(function(n){n[n.Distance=5]="Distance",n[n.MaxRemainingPerStep=3]="MaxRemainingPerStep",n[n.MinBufferLengthPrune=500]="MinBufferLengthPrune",n[n.ForceReduceLimit=10]="ForceReduceLimit",n[n.CutDepth=15e3]="CutDepth",n[n.CutTo=9e3]="CutTo"})(Hu||(Hu={}));class Jv{constructor(e,t,i,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new Fv(t,r),this.tokens=new Hv(e,this.stream),this.topTerm=e.top[1];let{from:s}=r[0];this.stacks=[vo.start(this,e.top[0],s)],this.fragments=i.length&&this.stream.end-s>e.bufferLength*4?new Yv(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],r,s;for(let o=0;o<e.length;o++){let l=e[o];for(;;){if(this.tokens.mainToken=null,l.pos>t)i.push(l);else{if(this.advanceStack(l,i,e))continue;{r||(r=[],s=[]),r.push(l);let a=this.tokens.getMainToken(l);s.push(a.value,a.end)}}break}}if(!i.length){let o=r&&tQ(r);if(o)return this.stackToTree(o);if(this.parser.strict)throw kt&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let o=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,s,i);if(o)return this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((l,a)=>a.score-l.score);i.length>o;)i.pop();i.some(l=>l.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let o=0;o<i.length-1;o++){let l=i[o];for(let a=o+1;a<i.length;a++){let h=i[a];if(l.sameState(h)||l.buffer.length>500&&h.buffer.length>500)if((l.score-h.score||l.buffer.length-h.buffer.length)>0)i.splice(a--,1);else{i.splice(o--,1);continue e}}}}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let r=e.pos,{parser:s}=this,o=kt?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let h=e.curContext&&e.curContext.tracker.strict,c=h?e.curContext.hash:0;for(let f=this.fragments.nodeAt(r);f;){let u=this.parser.nodeSet.types[f.type.id]==f.type?s.getGoto(e.state,f.type.id):-1;if(u>-1&&f.length&&(!h||(f.prop(ne.contextHash)||0)==c))return e.useNode(f,u),kt&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(f.type.id)})`),!0;if(!(f instanceof Ae)||f.children.length==0||f.positions[0]>0)break;let d=f.children[0];if(d instanceof Ae&&f.positions[0]==0)f=d;else break}}let l=s.stateSlot(e.state,4);if(l>0)return e.reduce(l),kt&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(l&65535)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let h=0;h<a.length;){let c=a[h++],f=a[h++],u=a[h++],d=h==a.length||!i,p=d?e:e.split();if(p.apply(c,f,u),kt&&console.log(o+this.stackID(p)+` (via ${(c&65536)==0?"shift":`reduce of ${s.getName(c&65535)}`} for ${s.getName(f)} @ ${r}${p==e?"":", split"})`),d)return!0;p.pos>r?t.push(p):i.push(p)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return Ju(e,t),!0}}runRecovery(e,t,i){let r=null,s=!1;for(let o=0;o<e.length;o++){let l=e[o],a=t[o<<1],h=t[(o<<1)+1],c=kt?this.stackID(l)+" -> ":"";if(l.deadEnd&&(s||(s=!0,l.restart(),kt&&console.log(c+this.stackID(l)+" (restarted)"),this.advanceFully(l,i))))continue;let f=l.split(),u=c;for(let d=0;f.forceReduce()&&d<10&&(kt&&console.log(u+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,i));d++)kt&&(u=this.stackID(f)+" -> ");for(let d of l.recoverByInsert(a))kt&&console.log(c+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,i);this.stream.end>l.pos?(h==l.pos&&(h++,a=0),l.recoverByDelete(a,h),kt&&console.log(c+this.stackID(l)+` (via recover-delete ${this.parser.getName(a)})`),Ju(l,i)):(!r||r.score<l.score)&&(r=l)}return r}stackToTree(e){return e.close(),Ae.build({buffer:Qo.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Ll||(Ll=new WeakMap)).get(e);return t||Ll.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Ju(n,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==n.pos&&i.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class Kv{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}const zl=n=>n;class eQ{constructor(e){this.start=e.start,this.shift=e.shift||zl,this.reduce=e.reduce||zl,this.reuse=e.reuse||zl,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class To extends fp{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (${14})`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let l=0;l<e.repeatNodeCount;l++)t.push("");let i=Object.keys(e.topRules).map(l=>e.topRules[l][1]),r=[];for(let l=0;l<t.length;l++)r.push([]);function s(l,a,h){r[l].push([a,a.deserialize(String(h))])}if(e.nodeProps)for(let l of e.nodeProps){let a=l[0];typeof a=="string"&&(a=ne[a]);for(let h=1;h<l.length;){let c=l[h++];if(c>=0)s(c,a,l[h++]);else{let f=l[h+-c];for(let u=-c;u>0;u--)s(l[h++],a,f);h++}}}this.nodeSet=new Rh(t.map((l,a)=>st.define({name:a>=this.minRepeatTerm?void 0:l,id:a,props:r[a],top:i.indexOf(a)>-1,error:a==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(a)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=ap;let o=$s(e.tokenData);if(this.context=e.context,this.specialized=new Uint16Array(e.specialized?e.specialized.length:0),this.specializers=[],e.specialized)for(let l=0;l<e.specialized.length;l++)this.specialized[l]=e.specialized[l].term,this.specializers[l]=e.specialized[l].get;this.states=$s(e.states,Uint32Array),this.data=$s(e.stateData),this.goto=$s(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new Bs(o,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let r=new Jv(this,e,t,i);for(let s of this.wrappers)r=s(r,e,t,i);return r}getGoto(e,t,i=!1){let r=this.goto;if(t>=r[0])return-1;for(let s=r[t+1];;){let o=r[s++],l=o&1,a=r[s++];if(l&&i)return a;for(let h=s+(o>>1);s<h;s++)if(r[s]==e)return a;if(l)return-1}}hasAction(e,t){let i=this.data;for(let r=0;r<2;r++)for(let s=this.stateSlot(e,r?2:1),o;;s+=3){if((o=i[s])==65535)if(i[s+1]==1)o=i[s=Jt(i,s+2)];else{if(i[s+1]==2)return Jt(i,s+2);break}if(o==t||o==0)return Jt(i,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=Jt(this.data,i+2);else return!1;if(t==Jt(this.data,i+1))return!0}}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=Jt(this.data,i+2);else break;if((this.data[i+2]&1)==0){let r=this.data[i+1];t.some((s,o)=>o&1&&s==r)||t.push(this.data[i],r)}}return t}overrides(e,t){let i=Ku(this.data,this.tokenPrecTable,t);return i<0||Ku(this.data,this.tokenPrecTable,e)<i}configure(e){let t=Object.assign(Object.create(To.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let r=e.tokenizers.find(s=>s.from==i);return r?r.to:i})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(i[o]=!0)}let r=null;for(let s=0;s<t.length;s++)if(!i[s])for(let o=this.dialects[t[s]],l;(l=this.data[o++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[l]=1;return new Kv(e,i,r)}static deserialize(e){return new To(e)}}function Jt(n,e){return n[e]|n[e+1]<<16}function Ku(n,e,t){for(let i=e,r;(r=n[i])!=65535;i++)if(r==t)return i-e;return-1}function tQ(n){let e=null;for(let t of n){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}const ed=281,td=1,iQ=2,vs=282,nQ=3,rQ=283,id=284,sQ=4,oQ=286,lQ=287,aQ=5,hQ=6,cQ=1,fQ=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],wm=125,uQ=123,dQ=59,nd=47,pQ=42,gQ=43,mQ=45,OQ=36,xQ=96,bQ=92,yQ=new eQ({start:!1,shift(n,e){return e==aQ||e==hQ||e==oQ?n:e==lQ},strict:!1}),wQ=new Yo((n,e)=>{let{next:t}=n;(t==wm||t==-1||e.context)&&e.canShift(id)&&n.acceptToken(id)},{contextual:!0,fallback:!0}),SQ=new Yo((n,e)=>{let{next:t}=n,i;fQ.indexOf(t)>-1||t==nd&&((i=n.peek(1))==nd||i==pQ)||t!=wm&&t!=dQ&&t!=-1&&!e.context&&e.canShift(ed)&&n.acceptToken(ed)},{contextual:!0}),kQ=new Yo((n,e)=>{let{next:t}=n;if((t==gQ||t==mQ)&&(n.advance(),t==n.next)){n.advance();let i=!e.context&&e.canShift(td);n.acceptToken(i?td:iQ)}},{contextual:!0}),$Q=new Yo(n=>{for(let e=!1,t=0;;t++){let{next:i}=n;if(i<0){t&&n.acceptToken(vs);break}else if(i==xQ){t?n.acceptToken(vs):n.acceptToken(rQ,1);break}else if(i==uQ&&e){t==1?n.acceptToken(nQ,1):n.acceptToken(vs,-1);break}else if(i==10&&t){n.advance(),n.acceptToken(vs);break}else i==bQ&&n.advance();e=i==OQ,n.advance()}});function vQ(n,e){return n=="extends"&&e.dialectEnabled(cQ)?sQ:-1}const QQ=dp({"get set async static":S.modifier,"for while do if else switch try catch finally return throw break continue default case":S.controlKeyword,"in of await yield void typeof delete instanceof":S.operatorKeyword,"let var const function class extends":S.definitionKeyword,"import export from":S.moduleKeyword,"with debugger as new":S.keyword,TemplateString:S.special(S.string),Super:S.atom,BooleanLiteral:S.bool,this:S.self,null:S.null,Star:S.modifier,VariableName:S.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":S.function(S.variableName),VariableDefinition:S.definition(S.variableName),Label:S.labelName,PropertyName:S.propertyName,PrivatePropertyName:S.special(S.propertyName),"CallExpression/MemberExpression/PropertyName":S.function(S.propertyName),"FunctionDeclaration/VariableDefinition":S.function(S.definition(S.variableName)),"ClassDeclaration/VariableDefinition":S.definition(S.className),PropertyDefinition:S.definition(S.propertyName),PrivatePropertyDefinition:S.definition(S.special(S.propertyName)),UpdateOp:S.updateOperator,LineComment:S.lineComment,BlockComment:S.blockComment,Number:S.number,String:S.string,ArithOp:S.arithmeticOperator,LogicOp:S.logicOperator,BitOp:S.bitwiseOperator,CompareOp:S.compareOperator,RegExp:S.regexp,Equals:S.definitionOperator,"Arrow : Spread":S.punctuation,"( )":S.paren,"[ ]":S.squareBracket,"{ }":S.brace,"InterpolationStart InterpolationEnd":S.special(S.brace),".":S.derefOperator,", ;":S.separator,TypeName:S.typeName,TypeDefinition:S.definition(S.typeName),"type enum interface implements namespace module declare":S.definitionKeyword,"abstract global Privacy readonly override":S.modifier,"is keyof unique infer":S.operatorKeyword,JSXAttributeValue:S.attributeValue,JSXText:S.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":S.angleBracket,"JSXIdentifier JSXNameSpacedName":S.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":S.attributeName}),TQ={__proto__:null,export:18,as:23,from:29,default:32,async:37,function:38,this:48,true:56,false:56,void:66,typeof:70,null:86,super:88,new:122,await:139,yield:141,delete:142,class:152,extends:154,public:197,private:197,protected:197,readonly:199,instanceof:220,in:222,const:224,import:256,keyof:307,unique:311,infer:317,is:351,abstract:371,implements:373,type:375,let:378,var:380,interface:387,enum:391,namespace:397,module:399,declare:403,global:407,for:428,of:437,while:440,with:444,do:448,if:452,else:454,switch:458,case:464,try:470,catch:474,finally:478,return:482,throw:486,break:490,continue:494,debugger:498},PQ={__proto__:null,async:109,get:111,set:113,public:161,private:161,protected:161,static:163,abstract:165,override:167,readonly:173,new:355},AQ={__proto__:null,"<":129},RQ=To.deserialize({version:14,states:"$4|O`QYOOO'QQ$IfO'#ChO'XOSO'#DVO)dQYO'#D]O)tQYO'#DhO){QYO'#DrO-xQYO'#DxOOQO'#E]'#E]O.]QWO'#E[O.bQWO'#E[OOQ$IU'#Ef'#EfO0aQ$IfO'#ItO2wQ$IfO'#IuO3eQWO'#EzO3jQpO'#FaOOQ$IU'#FS'#FSO3rO!bO'#FSO4QQWO'#FhO5_QWO'#FgOOQ$IU'#Iu'#IuOOQ$IS'#It'#ItOOQQ'#J^'#J^O5dQWO'#HpO5iQ$I[O'#HqOOQQ'#Ih'#IhOOQQ'#Hr'#HrQ`QYOOO){QYO'#DjO5qQWO'#G[O5vQ#tO'#CmO6UQWO'#EZO6aQWO'#EgO6fQ#tO'#FRO7QQWO'#G[O7VQWO'#G`O7bQWO'#G`O7pQWO'#GcO7pQWO'#GdO7pQWO'#GfO5qQWO'#GiO8aQWO'#GlO9oQWO'#CdO:PQWO'#GyO:XQWO'#HPO:XQWO'#HRO`QYO'#HTO:XQWO'#HVO:XQWO'#HYO:^QWO'#H`O:cQ$I]O'#HfO){QYO'#HhO:nQ$I]O'#HjO:yQ$I]O'#HlO5iQ$I[O'#HnO){QYO'#DWOOOS'#Ht'#HtO;UOSO,59qOOQ$IU,59q,59qO=gQbO'#ChO=qQYO'#HuO>UQWO'#IvO@TQbO'#IvO'dQYO'#IvO@[QWO,59wO@rQ&jO'#DbOAkQWO'#E]OAxQWO'#JROBTQWO'#JQOBTQWO'#JQOB]QWO,5:yOBbQWO'#JPOBiQWO'#DyO5vQ#tO'#EZOBwQWO'#EZOCSQ`O'#FROOQ$IU,5:S,5:SOC[QYO,5:SOEYQ$IfO,5:^OEvQWO,5:dOFaQ$I[O'#JOO7VQWO'#I}OFhQWO'#I}OFpQWO,5:xOFuQWO'#I}OGTQYO,5:vOITQWO'#EWOJ_QWO,5:vOKnQWO'#DlOKuQYO'#DqOLPQ&jO,5;PO){QYO,5;POOQQ'#Er'#ErOOQQ'#Et'#EtO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;RO){QYO,5;ROOQQ'#Ex'#ExOLXQYO,5;cOOQ$IU,5;h,5;hOOQ$IU,5;i,5;iONXQWO,5;iOOQ$IU,5;j,5;jO){QYO'#IPON^Q$I[O,5<TONxQWO,5;RO){QYO,5;fO! bQpO'#JVO! PQpO'#JVO! iQpO'#JVO! zQpO,5;qOOOO,5;{,5;{O!!YQYO'#FcOOOO'#IO'#IOO3rO!bO,5;nO!!aQpO'#FeOOQ$IU,5;n,5;nO!!}Q,UO'#CrOOQ$IU'#Cu'#CuO!#bQWO'#CuO!#gOSO'#CyO!$TQ#tO,5<QO!$[QWO,5<SO!%hQWO'#FrO!%uQWO'#FsO!%zQWO'#FwO!&yQ&jO'#F{O!'lQ,UO'#IqOOQ$IU'#Iq'#IqO!'vQWO'#IpO!(UQWO'#IoOOQ$IU'#Cs'#CsOOQ$IU'#C|'#C|O!(^QWO'#DOOJdQWO'#FjOJdQWO'#FlO!(cQWO'#FnO!(hQWO'#FoO!(mQWO'#FuOJdQWO'#FzO!(rQWO'#E^O!)ZQWO,5<RO`QYO,5>[OOQQ'#Ik'#IkOOQQ,5>],5>]OOQQ-E;p-E;pO!+VQ$IfO,5:UOOQ$IS'#Cp'#CpO!+vQ#tO,5<vOOQO'#Cf'#CfO!,XQWO'#CqO!,aQ$I[O'#IlO5_QWO'#IlO:^QWO,59XO!,rQpO,59XO!,zQ#tO,59XO5vQ#tO,59XO!-VQWO,5:vO!-_QWO'#GxO!-mQWO'#JbO){QYO,5;kO!-uQ&jO,5;mO!-zQWO,5=cO!.PQWO,5=cO!.UQWO,5=cO5iQ$I[O,5=cO5qQWO,5<vO!.dQWO'#E_O!.xQ&jO'#E`OOQ$IS'#JP'#JPO!/ZQ$I[O'#J_O5iQ$I[O,5<zO7pQWO,5=QOOQO'#Cr'#CrO!/fQpO,5<}O!/nQ#tO,5=OO!/yQWO,5=QO!0OQ`O,5=TO:^QWO'#GnO5qQWO'#GpO!0WQWO'#GpO5vQ#tO'#GsO!0]QWO'#GsOOQQ,5=W,5=WO!0bQWO'#GtO!0jQWO'#CmO!0oQWO,59OO!0yQWO,59OO!2{QYO,59OOOQQ,59O,59OO!3YQ$I[O,59OO){QYO,59OO!3eQYO'#G{OOQQ'#G|'#G|OOQQ'#G}'#G}O`QYO,5=eO!3uQWO,5=eO){QYO'#DxO`QYO,5=kO`QYO,5=mO!3zQWO,5=oO`QYO,5=qO!4PQWO,5=tO!4UQYO,5=zOOQQ,5>Q,5>QO){QYO,5>QO5iQ$I[O,5>SOOQQ,5>U,5>UO!8VQWO,5>UOOQQ,5>W,5>WO!8VQWO,5>WOOQQ,5>Y,5>YO!8[Q`O,59rOOOS-E;r-E;rOOQ$IU1G/]1G/]O!8aQbO,5>aO'dQYO,5>aOOQO,5>f,5>fO!8kQYO'#HuOOQO-E;s-E;sO!8xQWO,5?bO!9QQbO,5?bO!9XQWO,5?lOOQ$IU1G/c1G/cO!9aQpO'#DTOOQO'#Ix'#IxO){QYO'#IxO!:OQpO'#IxO!:mQpO'#DcO!;OQ&jO'#DcO!=ZQYO'#DcO!=bQWO'#IwO!=jQWO,59|O!=oQWO'#EaO!=}QWO'#JSO!>VQWO,5:zO!>mQ&jO'#DcO){QYO,5?mO!>wQWO'#HzOOQO-E;x-E;xO!9XQWO,5?lOOQ$IS1G0e1G0eO!@TQ&jO'#D|OOQ$IU,5:e,5:eO){QYO,5:eOITQWO,5:eO!@[QWO,5:eO:^QWO,5:uO!,rQpO,5:uO!,zQ#tO,5:uO5vQ#tO,5:uOOQ$IU1G/n1G/nOOQ$IU1G0O1G0OOOQ$IS'#EV'#EVO){QYO,5?jO!@gQ$I[O,5?jO!@xQ$I[O,5?jO!APQWO,5?iO!AXQWO'#H|O!APQWO,5?iOOQ$IS1G0d1G0dO7VQWO,5?iOOQ$IU1G0b1G0bO!AsQ$IfO1G0bO!BdQ$IdO,5:rOOQ$IU'#Fq'#FqO!CQQ$IfO'#IqOGTQYO1G0bO!EPQ#tO'#IyO!EZQWO,5:WO!E`QbO'#IzO){QYO'#IzO!EjQWO,5:]OOQ$IU'#DT'#DTOOQ$IU1G0k1G0kO!EoQWO1G0kO!HQQ$IfO1G0mO!HXQ$IfO1G0mO!JlQ$IfO1G0mO!JsQ$IfO1G0mO!LzQ$IfO1G0mO!M_Q$IfO1G0mO#!OQ$IfO1G0mO#!VQ$IfO1G0mO#$jQ$IfO1G0mO#$qQ$IfO1G0mO#&fQ$IfO1G0mO#)`Q7^O'#ChO#+ZQ7^O1G0}O#-UQ7^O'#IuOOQ$IU1G1T1G1TO#-iQ$IfO,5>kOOQ$IS-E;}-E;}O#.YQ$IfO1G0mOOQ$IU1G0m1G0mO#0[Q$IfO1G1QO#0{QpO,5;sO#1QQpO,5;tO#1VQpO'#F[O#1kQWO'#FZOOQO'#JW'#JWOOQO'#H}'#H}O#1pQpO1G1]OOQ$IU1G1]1G1]OOOO1G1f1G1fO#2OQ7^O'#ItO#2YQWO,5;}OLXQYO,5;}OOOO-E;|-E;|OOQ$IU1G1Y1G1YOOQ$IU,5<P,5<PO#2_QpO,5<POOQ$IU,59a,59aOITQWO'#C{OOOS'#Hs'#HsO#2dOSO,59eOOQ$IU,59e,59eO){QYO1G1lO!(hQWO'#IRO#2oQWO,5<eOOQ$IU,5<b,5<bOOQO'#GV'#GVOJdQWO,5<pOOQO'#GX'#GXOJdQWO,5<rOJdQWO,5<tOOQO1G1n1G1nO#2zQ`O'#CpO#3_Q`O,5<^O#3fQWO'#JZO5qQWO'#JZO#3tQWO,5<`OJdQWO,5<_O#3yQ`O'#FqO#4WQ`O'#J[O#4bQWO'#J[OITQWO'#J[O#4gQWO,5<cOOQ$IS'#Dg'#DgO#4lQWO'#FtO#4wQpO'#F|O!&tQ&jO'#F|O!&tQ&jO'#GOO#5YQWO'#GPO!(mQWO'#GSO#5_Q$I[O'#ITO#5jQ&jO,5<gOOQ$IU,5<g,5<gO#5qQ&jO'#F|O#6PQ&jO'#F}O#6XQ&jO'#F}OOQ$IU,5<u,5<uOJdQWO,5?[OJdQWO,5?[O#6^QWO'#IUO#6iQWO,5?ZOOQ$IU'#Ch'#ChO#7]Q#tO,59jOOQ$IU,59j,59jO#8OQ#tO,5<UO#8qQ#tO,5<WO#8{QWO,5<YOOQ$IU,5<Z,5<ZO#9QQWO,5<aO#9VQ#tO,5<fOGTQYO1G1mO#9gQWO1G1mOOQQ1G3v1G3vOOQ$IU1G/p1G/pONXQWO1G/pOOQQ1G2b1G2bOITQWO1G2bO){QYO1G2bOITQWO1G2bO#9lQWO1G2bO#9zQWO,59]O#;TQWO'#EWOOQ$IS,5?W,5?WO#;_Q$I[O,5?WOOQQ1G.s1G.sO:^QWO1G.sO!,rQpO1G.sO!,zQ#tO1G.sO#;pQWO1G0bO#;uQWO'#ChO#<QQWO'#JcO#<YQWO,5=dO#<_QWO'#JcO#<dQWO'#JcO#<lQWO'#I^O#<zQWO,5?|O#=SQbO1G1VOOQ$IU1G1X1G1XO5qQWO1G2}O#=ZQWO1G2}O#=`QWO1G2}O#=eQWO1G2}OOQQ1G2}1G2}O#=jQ#tO1G2bO7VQWO'#JQO7VQWO'#EaO7VQWO'#IWO#={Q$I[O,5?yOOQQ1G2f1G2fO!/yQWO1G2lOITQWO1G2iO#>WQWO1G2iOOQQ1G2j1G2jOITQWO1G2jO#>]QWO1G2jO#>eQ&jO'#GhOOQQ1G2l1G2lO!&tQ&jO'#IYO!0OQ`O1G2oOOQQ1G2o1G2oOOQQ,5=Y,5=YO#>mQ#tO,5=[O5qQWO,5=[O#5YQWO,5=_O5_QWO,5=_O!,rQpO,5=_O!,zQ#tO,5=_O5vQ#tO,5=_O#?OQWO'#JaO#?ZQWO,5=`OOQQ1G.j1G.jO#?`Q$I[O1G.jO#?kQWO1G.jO#?pQWO1G.jO5iQ$I[O1G.jO#?xQbO,5@OO#@SQWO,5@OO#@_QYO,5=gO#@fQWO,5=gO7VQWO,5@OOOQQ1G3P1G3PO`QYO1G3POOQQ1G3V1G3VOOQQ1G3X1G3XO:XQWO1G3ZO#@kQYO1G3]O#DfQYO'#H[OOQQ1G3`1G3`O#DsQWO'#HbO:^QWO'#HdOOQQ1G3f1G3fO#D{QYO1G3fO5iQ$I[O1G3lOOQQ1G3n1G3nOOQ$IS'#Fx'#FxO5iQ$I[O1G3pO5iQ$I[O1G3rOOOS1G/^1G/^O#HyQ`O,5<TO#IRQbO1G3{OOQO1G4Q1G4QO){QYO,5>aO#I]QWO1G4|O#IeQWO1G5WO#ImQWO,5?dOLXQYO,5:{O7VQWO,5:{O:^QWO,59}OLXQYO,59}O!,rQpO,59}O#IrQ7^O,59}OOQO,5:{,5:{O#I|Q&jO'#HvO#JdQWO,5?cOOQ$IU1G/h1G/hO#JlQ&jO'#H{O#KQQWO,5?nOOQ$IS1G0f1G0fO!;OQ&jO,59}O#KYQbO1G5XO7VQWO,5>fOOQ$IS'#ES'#ESO#KdQ$ItO'#ETO!?{Q&jO'#D}OOQO'#Hy'#HyO#LOQ&jO,5:hOOQ$IU,5:h,5:hO#LVQ&jO'#D}O#LhQ&jO'#D}O#LoQ&jO'#EYO#LrQ&jO'#ETO#MPQ&jO'#ETO!?{Q&jO'#ETO#MdQWO1G0PO#MiQ`O1G0POOQ$IU1G0P1G0PO){QYO1G0POITQWO1G0POOQ$IU1G0a1G0aO:^QWO1G0aO!,rQpO1G0aO!,zQ#tO1G0aO#MpQ$IfO1G5UO){QYO1G5UO#NQQ$I[O1G5UO#NcQWO1G5TO7VQWO,5>hOOQO,5>h,5>hO#NkQWO,5>hOOQO-E;z-E;zO#NcQWO1G5TO#NyQ$IfO,59jO$!xQ$IfO,5<UO$$zQ$IfO,5<WO$&|Q$IfO,5<fOOQ$IU7+%|7+%|O$)UQ$IfO7+%|O$)uQWO'#HwO$*PQWO,5?eOOQ$IU1G/r1G/rO$*XQYO'#HxO$*fQWO,5?fO$*nQbO,5?fOOQ$IU1G/w1G/wOOQ$IU7+&V7+&VO$*xQ7^O,5:^O){QYO7+&iO$+SQ7^O,5:UOOQO1G1_1G1_OOQO1G1`1G1`O$+aQMhO,5;vOLXQYO,5;uOOQO-E;{-E;{OOQ$IU7+&w7+&wOOOO7+'Q7+'QOOOO1G1i1G1iO$+lQWO1G1iOOQ$IU1G1k1G1kO$+qQ`O,59gOOOS-E;q-E;qOOQ$IU1G/P1G/PO$+xQ$IfO7+'WOOQ$IU,5>m,5>mO$,iQWO,5>mOOQ$IU1G2P1G2PP$,nQWO'#IRPOQ$IU-E<P-E<PO$-_Q#tO1G2[O$.QQ#tO1G2^O$.[Q#tO1G2`OOQ$IU1G1x1G1xO$.cQWO'#IQO$.qQWO,5?uO$.qQWO,5?uO$.yQWO,5?uO$/UQWO,5?uOOQO1G1z1G1zO$/dQ#tO1G1yO$/tQWO'#ISO$0UQWO,5?vOITQWO,5?vO$0^Q`O,5?vOOQ$IU1G1}1G1}OOQ$IS,5<h,5<hOOQ$IS,5<i,5<iO$0hQWO,5<iO#5TQWO,5<iO!,rQpO,5<hO$0mQWO,5<jOOQ$IS,5<k,5<kO$0hQWO,5<nOOQO,5>o,5>oOOQO-E<R-E<ROOQ$IU1G2R1G2RO!&tQ&jO,5<hO$0uQWO,5<iO!&tQ&jO,5<jO!&tQ&jO,5<iO$1QQ#tO1G4vO$1[Q#tO1G4vOOQO,5>p,5>pOOQO-E<S-E<SO!-uQ&jO,59lO){QYO,59lO$1iQWO1G1tOJdQWO1G1{O$1nQ$IfO7+'XOOQ$IU7+'X7+'XOGTQYO7+'XOOQ$IU7+%[7+%[O$2_Q`O'#J]O#MdQWO7+'|O$2iQWO7+'|O$2qQ`O7+'|OOQQ7+'|7+'|OITQWO7+'|O){QYO7+'|OITQWO7+'|OOQO1G.w1G.wO$2{Q$IdO'#ChO$3`Q$IdO,5<lO$4QQWO,5<lOOQ$IS1G4r1G4rOOQQ7+$_7+$_O:^QWO7+$_O!,rQpO7+$_OGTQYO7+%|O$4VQWO'#I]O$4hQWO,5?}OOQO1G3O1G3OO5qQWO,5?}O$4hQWO,5?}O$4pQWO,5?}OOQO,5>x,5>xOOQO-E<[-E<[OOQ$IU7+&q7+&qO$4uQWO7+(iO5iQ$I[O7+(iO5qQWO7+(iO$4zQWO7+(iO$5PQWO7+'|OOQ$IS,5>r,5>rOOQ$IS-E<U-E<UOOQQ7+(W7+(WO$5_Q$IdO7+(TOITQWO7+(TO$5iQ`O7+(UOOQQ7+(U7+(UOITQWO7+(UO$5pQWO'#J`O$5{QWO,5=SOOQO,5>t,5>tOOQO-E<W-E<WOOQQ7+(Z7+(ZO$6uQ&jO'#GqOOQQ1G2v1G2vOITQWO1G2vO){QYO1G2vOITQWO1G2vO$6|QWO1G2vO$7[Q#tO1G2vO5iQ$I[O1G2yO#5YQWO1G2yO5_QWO1G2yO!,rQpO1G2yO!,zQ#tO1G2yO$7mQWO'#I[O$7xQWO,5?{O$8QQ&jO,5?{OOQ$IS1G2z1G2zOOQQ7+$U7+$UO$8YQWO7+$UO5iQ$I[O7+$UO$8_QWO7+$UO){QYO1G5jO){QYO1G5kO$8dQYO1G3RO$8kQWO1G3RO$8pQYO1G3RO$8wQ$I[O1G5jOOQQ7+(k7+(kO5iQ$I[O7+(uO`QYO7+(wOOQQ'#Jf'#JfOOQQ'#I_'#I_O$9RQYO,5=vOOQQ,5=v,5=vO){QYO'#H]O$9`QWO'#H_OOQQ,5=|,5=|O7VQWO,5=|OOQQ,5>O,5>OOOQQ7+)Q7+)QOOQQ7+)W7+)WOOQQ7+)[7+)[OOQQ7+)^7+)^OOQO1G5O1G5OO$9eQ7^O1G0gO$9oQWO1G0gOOQO1G/i1G/iO$9zQ7^O1G/iO:^QWO1G/iOLXQYO'#DcOOQO,5>b,5>bOOQO-E;t-E;tOOQO,5>g,5>gOOQO-E;y-E;yO!,rQpO1G/iO:^QWO,5:iOOQO,5:o,5:oO){QYO,5:oO$:UQ$I[O,5:oO$:aQ$I[O,5:oO!,rQpO,5:iOOQO-E;w-E;wOOQ$IU1G0S1G0SO!?{Q&jO,5:iO$:oQ&jO,5:iO$;QQ$ItO,5:oO$;lQ&jO,5:iO!?{Q&jO,5:oOOQO,5:t,5:tO$;sQ&jO,5:oO$<QQ$I[O,5:oOOQ$IU7+%k7+%kO#MdQWO7+%kO#MiQ`O7+%kOOQ$IU7+%{7+%{O:^QWO7+%{O!,rQpO7+%{O$<fQ$IfO7+*pO){QYO7+*pOOQO1G4S1G4SO7VQWO1G4SO$<vQWO7+*oO$=OQ$IfO1G2[O$?QQ$IfO1G2^O$ASQ$IfO1G1yO$C[Q#tO,5>cOOQO-E;u-E;uO$CfQbO,5>dO){QYO,5>dOOQO-E;v-E;vO$CpQWO1G5QO$CxQ7^O1G0bO$FPQ7^O1G0mO$FWQ7^O1G0mO$HXQ7^O1G0mO$H`Q7^O1G0mO$JTQ7^O1G0mO$JhQ7^O1G0mO$LuQ7^O1G0mO$L|Q7^O1G0mO$N}Q7^O1G0mO% UQ7^O1G0mO%!yQ7^O1G0mO%#^Q$IfO<<JTO%#}Q7^O1G0mO%&UQ7^O'#IqO%'nQ7^O1G1QOLXQYO'#F^OOQO'#JX'#JXOOQO1G1b1G1bO%'{QWO1G1aO%(QQ7^O,5>kOOOO7+'T7+'TOOOS1G/R1G/ROOQ$IU1G4X1G4XOJdQWO7+'zO%([QWO,5>lO5qQWO,5>lOOQO-E<O-E<OO%(jQWO1G5aO%(jQWO1G5aO%(rQWO1G5aO%(}Q`O,5>nO%)XQWO,5>nOITQWO,5>nOOQO-E<Q-E<QO%)^Q`O1G5bO%)hQWO1G5bOOQ$IS1G2T1G2TO$0hQWO1G2TOOQ$IS1G2S1G2SO%)pQWO1G2UOITQWO1G2UOOQ$IS1G2Y1G2YO!,rQpO1G2SO#5TQWO1G2TO%)uQWO1G2UO%)}QWO1G2TOJdQWO7+*bOOQ$IU1G/W1G/WO%*YQWO1G/WOOQ$IU7+'`7+'`O%*_Q#tO7+'gO%*oQ$IfO<<JsOOQ$IU<<Js<<JsOITQWO'#IVO%+`QWO,5?wOOQQ<<Kh<<KhOITQWO<<KhO#MdQWO<<KhO%+hQWO<<KhO%+pQ`O<<KhOITQWO1G2WOOQQ<<Gy<<GyO:^QWO<<GyO%+zQ$IfO<<IhOOQ$IU<<Ih<<IhOOQO,5>w,5>wO%,kQWO,5>wO%,pQWO,5>wOOQO-E<Z-E<ZO%,xQWO1G5iO%,xQWO1G5iO5qQWO1G5iO%-QQWO<<LTOOQQ<<LT<<LTO%-VQWO<<LTO5iQ$I[O<<LTO){QYO<<KhOITQWO<<KhOOQQ<<Ko<<KoO$5_Q$IdO<<KoOOQQ<<Kp<<KpO$5iQ`O<<KpO%-[Q&jO'#IXO%-gQWO,5?zOLXQYO,5?zOOQQ1G2n1G2nO#KdQ$ItO'#ETO!?{Q&jO'#GrOOQO'#IZ'#IZO%-oQ&jO,5=]OOQQ,5=],5=]O%-vQ&jO'#ETO%.RQ&jO'#ETO%.jQ&jO'#ETO%.tQ&jO'#GrO%/VQWO7+(bO%/[QWO7+(bO%/dQ`O7+(bOOQQ7+(b7+(bOITQWO7+(bO){QYO7+(bOITQWO7+(bO%/nQWO7+(bOOQQ7+(e7+(eO5iQ$I[O7+(eO#5YQWO7+(eO5_QWO7+(eO!,rQpO7+(eO%/|QWO,5>vOOQO-E<Y-E<YOOQO'#Gu'#GuO%0XQWO1G5gO5iQ$I[O<<GpOOQQ<<Gp<<GpO%0aQWO<<GpO%0fQWO7++UO%0kQWO7++VOOQQ7+(m7+(mO%0pQWO7+(mO%0uQYO7+(mO%0|QWO7+(mO){QYO7++UO){QYO7++VOOQQ<<La<<LaOOQQ<<Lc<<LcOOQQ-E<]-E<]OOQQ1G3b1G3bO%1RQWO,5=wOOQQ,5=y,5=yO%1WQWO1G3hOLXQYO7+&ROOQO7+%T7+%TO%1]Q7^O1G5XO:^QWO7+%TOOQO1G0T1G0TO%1gQ$IfO1G0ZOOQO1G0Z1G0ZO){QYO1G0ZO%1qQ$I[O1G0ZO:^QWO1G0TO!,rQpO1G0TO!?{Q&jO1G0TO%1|Q$I[O1G0ZO%2[Q&jO1G0TO%2mQ$I[O1G0ZO%3RQ$ItO1G0ZO%3]Q&jO1G0TO!?{Q&jO1G0ZOOQ$IU<<IV<<IVOOQ$IU<<Ig<<IgO:^QWO<<IgO%3dQ$IfO<<N[OOQO7+)n7+)nO%3tQ$IfO7+'gO%5|QbO1G4OO%6WQ7^O7+%|O%6|Q7^O,59jO%8zQ7^O,5<UO%:{Q7^O,5<WO%<hQ7^O,5<fO%>WQ7^O7+'WO%>eQ7^O7+'XO%>rQWO,5;xOOQO7+&{7+&{O%>wQ#tO<<KfOOQO1G4W1G4WO%?XQWO1G4WO%?dQWO1G4WO%?rQWO7+*{O%?rQWO7+*{OITQWO1G4YO%?zQ`O1G4YO%@UQWO7+*|OOQ$IS7+'o7+'oO$0hQWO7+'pO%@^Q`O7+'pOOQ$IS7+'n7+'nO$0hQWO7+'oO%@eQWO7+'pOITQWO7+'pO#5TQWO7+'oO%@jQ#tO<<M|OOQ$IU7+$r7+$rO%@tQ`O,5>qOOQO-E<T-E<TO#MdQWOANASOOQQANASANASOITQWOANASO%AOQ$IdO7+'rOOQQAN=eAN=eO5qQWO1G4cOOQO1G4c1G4cO%A`QWO1G4cO%AeQWO7++TO%AeQWO7++TO5iQ$I[OANAoO%AmQWOANAoOOQQANAoANAoO%ArQWOANASO%AzQ`OANASOOQQANAZANAZOOQQANA[ANA[O%BUQWO,5>sOOQO-E<V-E<VO%BaQ7^O1G5fO#5YQWO,5=^O5_QWO,5=^O!,rQpO,5=^OOQO-E<X-E<XOOQQ1G2w1G2wO$;QQ$ItO,5:oO!?{Q&jO,5=^O%BkQ&jO,5=^O%B|Q&jO,5:oOOQQ<<K|<<K|OITQWO<<K|O%/VQWO<<K|O%CWQWO<<K|O%C`Q`O<<K|O){QYO<<K|OITQWO<<K|OOQQ<<LP<<LPO5iQ$I[O<<LPO#5YQWO<<LPO5_QWO<<LPO%CjQ&jO1G4bO%CrQWO7++ROOQQAN=[AN=[O5iQ$I[OAN=[OOQQ<<Np<<NpOOQQ<<Nq<<NqOOQQ<<LX<<LXO%CzQWO<<LXO%DPQYO<<LXO%DWQWO<<NpO%D]QWO<<NqOOQQ1G3c1G3cO:^QWO7+)SO%DbQ7^O<<ImOOQO<<Ho<<HoOOQO7+%u7+%uO%1gQ$IfO7+%uO){QYO7+%uOOQO7+%o7+%oO:^QWO7+%oO!,rQpO7+%oO%DlQ$I[O7+%uO!?{Q&jO7+%oO%DwQ$I[O7+%uO%EVQ&jO7+%oO%EhQ$I[O7+%uOOQ$IUAN?RAN?RO%E|Q$IfO<<KfO%HUQ7^O<<JTO%HcQ7^O1G1yO%JgQ7^O1G2[O%LhQ7^O1G2^O%NTQ7^O<<JsO%NbQ7^O<<IhOOQO1G1d1G1dOOQO7+)r7+)rO%NoQWO7+)rO%NzQWO<<NgO& SQ`O7+)tOOQ$IS<<K[<<K[O$0hQWO<<K[OOQ$IS<<KZ<<KZO& ^Q`O<<K[O$0hQWO<<KZOOQQG26nG26nO#MdQWOG26nOOQO7+)}7+)}O5qQWO7+)}O& eQWO<<NoOOQQG27ZG27ZO5iQ$I[OG27ZOITQWOG26nOLXQYO1G4_O& mQWO7++QO5iQ$I[O1G2xO#5YQWO1G2xO5_QWO1G2xO!,rQpO1G2xO!?{Q&jO1G2xO%3RQ$ItO1G0ZO& uQ&jO1G2xO%/VQWOANAhOOQQANAhANAhOITQWOANAhO&!WQWOANAhO&!`Q`OANAhOOQQANAkANAkO5iQ$I[OANAkO#5YQWOANAkOOQO'#Gv'#GvOOQO7+)|7+)|OOQQG22vG22vOOQQANAsANAsO&!jQWOANAsOOQQAND[AND[OOQQAND]AND]OOQQ<<Ln<<LnOOQO<<Ia<<IaO%1gQ$IfO<<IaOOQO<<IZ<<IZO:^QWO<<IZO){QYO<<IaO!,rQpO<<IZO&!oQ$I[O<<IaO!?{Q&jO<<IZO&!zQ$I[O<<IaO&#YQ7^O7+'gOOQO<<M^<<M^OOQ$ISAN@vAN@vO$0hQWOAN@vOOQ$ISAN@uAN@uOOQQLD,YLD,YOOQO<<Mi<<MiOOQQLD,uLD,uO#MdQWOLD,YO&$xQ7^O7+)yOOQO7+(d7+(dO5iQ$I[O7+(dO#5YQWO7+(dO5_QWO7+(dO!,rQpO7+(dO!?{Q&jO7+(dOOQQG27SG27SO%/VQWOG27SOITQWOG27SOOQQG27VG27VO5iQ$I[OG27VOOQQG27_G27_OOQOAN>{AN>{OOQOAN>uAN>uO%1gQ$IfOAN>{O:^QWOAN>uO){QYOAN>{O!,rQpOAN>uO&%SQ$I[OAN>{O&%_Q7^O<<KfOOQ$ISG26bG26bOOQQ!$( t!$( tOOQO<<LO<<LOO5iQ$I[O<<LOO#5YQWO<<LOO5_QWO<<LOO!,rQpO<<LOOOQQLD,nLD,nO%/VQWOLD,nOOQQLD,qLD,qOOQOG24gG24gOOQOG24aG24aO%1gQ$IfOG24gO:^QWOG24aO){QYOG24gO&&}QMhO,5:rO&'tQ!LQO'#IqOOQOANAjANAjO5iQ$I[OANAjO#5YQWOANAjO5_QWOANAjOOQQ!$(!Y!$(!YOOQOLD*RLD*ROOQOLD){LD){O%1gQ$IfOLD*RO&(hQMhO,59jO&)[QMhO,5<UO&*OQMhO,5<WO&*rQMhO,5<fOOQOG27UG27UO5iQ$I[OG27UO#5YQWOG27UOOQO!$'Mm!$'MmO&+iQMhO1G2[O&,]QMhO1G2^O&-PQMhO1G1yOOQOLD,pLD,pO5iQ$I[OLD,pO&-vQMhO7+'gOOQO!$(![!$(![O&.mQMhO<<KfOLXQYO'#DrO&/dQbO'#ItOLXQYO'#DjO&/kQ$IfO'#ChO&0UQbO'#ChO&0fQYO,5:vO&2fQWO'#EWOLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO,5;ROLXQYO'#IPO&3pQWO,5<TO&5SQWO,5;ROLXQYO,5;fO!(^QWO'#DOO!(^QWO'#DOO!(^QWO'#DOOITQWO'#FjO&2fQWO'#FjO&3xQWO'#FjOITQWO'#FlO&2fQWO'#FlO&3xQWO'#FlOITQWO'#FzO&2fQWO'#FzO&3xQWO'#FzOLXQYO,5?mO&0fQYO1G0bO&5ZQ7^O'#ChOLXQYO1G1lOITQWO,5<pO&2fQWO,5<pO&3xQWO,5<pOITQWO,5<rO&2fQWO,5<rO&3xQWO,5<rOITQWO,5<_O&2fQWO,5<_O&3xQWO,5<_O&0fQYO1G1mOLXQYO7+&iOITQWO1G1{O&2fQWO1G1{O&3xQWO1G1{O&0fQYO7+'XO&0fQYO7+%|OITQWO7+'zO&2fQWO7+'zO&3xQWO7+'zO&5eQWO7+'pO&5eQWO<<K[O&5eQWOAN@vO&5jQWO'#E[O&5oQWO'#E[O&5wQWO'#EzO&5|QWO'#EgO&6RQWO'#JRO&6^QWO'#JPO&6iQWO,5:vO&6nQ#tO,5<QO&6uQWO'#FsO&6zQWO'#FsO&7PQWO'#FsO&7UQWO,5<RO&7^QWO,5:vO&7fQ7^O1G0}O&7mQWO,5<aO&7rQWO,5<aO&7wQWO,5<aO&7|QWO1G1mO&8RQWO1G0bO&8WQ#tO1G2`O&8_Q#tO1G2`O&8fQ#tO1G2`O&8mQWO1G2UO&8rQ`O7+'pO&8yQWO7+'pO&9OQ`O<<K[O4QQWO'#FhO5_QWO'#FgOBwQWO'#EZOLXQYO,5;cO!(mQWO'#FuO!(mQWO'#FuO!(mQWO'#FuOJdQWO,5<tOJdQWO,5<tOJdQWO,5<tO&9VQWO,5<jOITQWO1G2UO&9_QWO1G2UOITQWO7+'pO!&tQ&jO'#GOO!&tQ&jO,5<j",stateData:"&:]~O'YOS'ZOSTOSUOS~OPTOQTOXyO]cO_hObnOcmOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!TSO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!nlO#dsO#tpO#x^O%PqO%RtO%TrO%UrO%XuO%ZvO%^wO%_wO%axO%nzO%t{O%v|O%x}O%z!OO%}!PO&T!QO&Z!RO&]!SO&_!TO&a!UO&c!VO']PO'fQO'oYO'|aO~OP[XZ[X_[Xj[Xu[Xv[Xx[X!R[X!a[X!b[X!d[X!j[X!{[X#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'W[X'f[X'p[X'w[X'x[X~O!]$lX~P$zOR!WO'U!XO'V!ZO~OPTOQTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']![O'fQO'oYO'|aO~O!Q!`O!R!]O!O'jP!O'tP~P'dO!S!mO~P`OPTOQTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']9WO'fQO'oYO'|aO~OPTOQTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O'fQO'oYO'|aO~O!Q!rO#U!uO#V!rO']9XO!c'qP~P+{O#W!vO~O!]!wO#W!vO~OP#^OZ#dOj#ROu!{Ov!{Ox!|O!R#bO!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O_'hX'W'hX!c'hX!O'hX!T'hX%Q'hX!]'hX~P.jO!{#eO#o#eOP'iXZ'iX_'iXj'iXu'iXv'iXx'iX!R'iX!a'iX!b'iX!d'iX!j'iX#['iX#]'iX#^'iX#_'iX#`'iX#a'iX#b'iX#e'iX#g'iX#i'iX#j'iX'f'iX'p'iX'w'iX'x'iX~O#c'iX'W'iX!O'iX!c'iXn'iX!T'iX%Q'iX!]'iX~P0zO!{#eO~O#z#fO$R#jO~O!T#kO#x^O$U#lO$W#nO~O]#qOh$OOj#rOk#qOl#qOq$POs$QOx#xO!T#yO!_$VO!d#vO#V$WO#t$TO$_$RO$a$SO$d$UO']#pO'f#sO'a'cP~O!d$XO~O!]$ZO~O_$[O'W$[O~O']$`O~O!d$XO']$`O'^$bO'b$cO~Oc$iO!d$XO']$`O~O#c#TO~O]$rOu$nO!T$kO!d$mO%R$qO']$`O'^$bO^(UP~O!n$sO~Ox$tO!T$uO']$`O~Ox$tO!T$uO%Z$yO']$`O~O']$zO~O#dsO%RtO%TrO%UrO%XuO%ZvO%^wO%_wO~Ob%TOc%SO!n%QO%P%RO%c%PO~P7uOb%WOcmO!T%VO!nlO#dsO%PqO%TrO%UrO%XuO%ZvO%^wO%_wO%axO~O`%ZO!{%^O%R%XO'^$bO~P8tO!d%_O!g%cO~O!d%dO~O!TSO~O_$[O'T%lO'W$[O~O_$[O'T%oO'W$[O~O_$[O'T%qO'W$[O~OR!WO'U!XO'V%uO~OP[XZ[Xj[Xu[Xv[Xx[X!R[X!RdX!a[X!b[X!d[X!j[X!{[X!{dX#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'f[X'p[X'w[X'x[X~O!O[X!OdX~P;aO!Q%wO!O&iX!O&nX!R&iX!R&nX~P'dO!R%yO!O'jX~OP#^OZ#dOj#ROu!{Ov!{Ox!|O!R%yO!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O!O'jX~P>^O!O&OO~Ox&RO!W&]O!X&UO!Y&UO'^$bO~O]&SOk&SO!Q&VO'g&PO!S'kP!S'vP~P@aO!O'sX!R'sX!]'sX!c'sX'p'sX~O!{'sX#W#PX!S'sX~PAYO!{&^O!O'uX!R'uX~O!R&_O!O'tX~O!O&bO~O!{#eO~PAYOS&fO!T&cO!o&eO']$`O~Oc&kO!d$XO']$`O~Ou$nO!d$mO~O!S&lO~P`Ou!{Ov!{Ox!|O!b!yO!d!zO'fQOP!faZ!faj!fa!R!fa!a!fa!j!fa#[!fa#]!fa#^!fa#_!fa#`!fa#a!fa#b!fa#c!fa#e!fa#g!fa#i!fa#j!fa'p!fa'w!fa'x!fa~O_!fa'W!fa!O!fa!c!fan!fa!T!fa%Q!fa!]!fa~PCcO!c&mO~O!]!wO!{&oO'p&nO!R'rX_'rX'W'rX~O!c'rX~PE{O!R&sO!c'qX~O!c&uO~Ox$tO!T$uO#V&vO']$`O~OPTOQTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!TSO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']9WO'fQO'oYO'|aO~O]#qOh$OOj#rOk#qOl#qOq$POs9kOx#xO!T#yO!_;RO!d#vO#V9tO#t$TO$_9nO$a9qO$d$UO']&zO'f#sO~O#W&|O~O]#qOh$OOj#rOk#qOl#qOq$POs$QOx#xO!T#yO!_$VO!d#vO#V$WO#t$TO$_$RO$a$SO$d$UO']&zO'f#sO~O'a'mP~PJdO!Q'QO!c'nP~P){O'g'SO'oYO~OP9TOQ9TO]cOb;POc!jOhcOj9TOkcOlcOq9TOs9TOxRO{cO|cO}cO!T!bO!_9VO!dUO!g9TO!h9TO!i9TO!j9TO!k9TO!n!iO#t!lO#x^O']'bO'fQO'oYO'|:}O~O!d!zO~O!R#bO_$]a'W$]a!c$]a!O$]a!T$]a%Q$]a!]$]a~O#d'iO~PITO!]'kO!T'yX#w'yX#z'yX$R'yX~Ou'lO~P! POu'lO!T'yX#w'yX#z'yX$R'yX~O!T'nO#w'rO#z'mO$R'sO~O!Q'vO~PLXO#z#fO$R'yO~Ou$eXx$eX!b$eX'p$eX'w$eX'x$eX~OSfX!RfX!{fX'afX'a$eX~P!!iOk'{O~OR'|O'U'}O'V(PO~Ou(ROx(SO'p#[O'w(UO'x(WO~O'a(QO~P!#rO'a(ZO~O]#qOh$OOj#rOk#qOl#qOq$POs9kOx#xO!T#yO!_;RO!d#vO#V9tO#t$TO$_9nO$a9qO$d$UO'f#sO~O!Q(_O']([O!c'}P~P!$aO#W(aO~O!Q(eO'](bO!O(OP~P!$aOj(sOx(kO!W(qO!X(jO!Y(jO!d(hO!x(rO$w(mO'^$bO'g(gO~O!S(pO~P!&XO!b!yOu'eXx'eX'p'eX'w'eX'x'eX!R'eX!{'eX~O'a'eX#m'eX~P!'QOS(vO!{(uO!R'dX'a'dX~O!R(wO'a'cX~O'](yO~O!d)OO~O']&zO~O!d(hO~Ox$tO!Q!rO!T$uO#U!uO#V!rO']$`O!c'qP~O!]!wO#W)SO~OP#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O_!^a!R!^a'W!^a!O!^a!c!^an!^a!T!^a%Q!^a!]!^a~P!)cOS)[O!T&cO!o)ZO%Q)YO'b$cO~O']$zO'a'cP~O!])_O!T'`X_'`X!R'`X'W'`X~O!d$XO'b$cO~O!d$XO']$`O'b$cO~O!]!wO#W&|O~O])jO%R)kO'])gO!S(VP~O!R)lO^(UX~O'g'SO~OZ)pO~O^)qO~O!T$kO']$`O'^$bO^(UP~Ox$tO!Q)vO!R&_O!T$uO']$`O!O'tP~O]&YOk&YO!Q)wO'g'SO!S'vP~O!R)xO_(RX'W(RX~O!{)|O'b$cO~OS*PO!T#yO'b$cO~O!T*RO~Ou*TO!TSO~O!n*YO~Oc*_O~O'](yO!S(TP~Oc$iO~O%RtO']$zO~P8tOZ*eO^*dO~OPTOQTO]cObnOcmOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!nlO#x^O%PqO'fQO'oYO'|aO~O!T!bO#t!lO']9WO~P!1RO^*dO_$[O'W$[O~O_*iO#d*kO%T*kO%U*kO~P){O!d%_O~O%t*pO~O!T*rO~O&V*tO&X*uOP&SaQ&SaX&Sa]&Sa_&Sab&Sac&Sah&Saj&Sak&Sal&Saq&Sas&Sax&Sa{&Sa|&Sa}&Sa!T&Sa!_&Sa!d&Sa!g&Sa!h&Sa!i&Sa!j&Sa!k&Sa!n&Sa#d&Sa#t&Sa#x&Sa%P&Sa%R&Sa%T&Sa%U&Sa%X&Sa%Z&Sa%^&Sa%_&Sa%a&Sa%n&Sa%t&Sa%v&Sa%x&Sa%z&Sa%}&Sa&T&Sa&Z&Sa&]&Sa&_&Sa&a&Sa&c&Sa'S&Sa']&Sa'f&Sa'o&Sa'|&Sa!S&Sa%{&Sa`&Sa&Q&Sa~O']*zO~On*}O~O!O&ia!R&ia~P!)cO!Q+RO!O&iX!R&iX~P){O!R%yO!O'ja~O!O'ja~P>^O!R&_O!O'ta~O!RwX!R!ZX!SwX!S!ZX!]wX!]!ZX!d!ZX!{wX'b!ZX~O!]+WO!{+VO!R#TX!R'lX!S#TX!S'lX!]'lX!d'lX'b'lX~O!]+YO!d$XO'b$cO!R!VX!S!VX~O]&QOk&QOx&RO'g(gO~OP9TOQ9TO]cOb;POc!jOhcOj9TOkcOlcOq9TOs9TOxRO{cO|cO}cO!T!bO!_9VO!dUO!g9TO!h9TO!i9TO!j9TO!k9TO!n!iO#t!lO#x^O'fQO'oYO'|:}O~O']9yO~P!;^O!R+^O!S'kX~O!S+`O~O!]+WO!{+VO!R#TX!S#TX~O!R+aO!S'vX~O!S+cO~O]&QOk&QOx&RO'^$bO'g(gO~O!X+dO!Y+dO~P!>[Ox$tO!Q+fO!T$uO']$`O!O&nX!R&nX~O_+jO!W+mO!X+iO!Y+iO!r+qO!s+oO!t+pO!u+nO!x+rO'^$bO'g(gO'o+gO~O!S+lO~P!?]OS+wO!T&cO!o+vO~O!{+}O!R'ra!c'ra_'ra'W'ra~O!]!wO~P!@gO!R&sO!c'qa~Ox$tO!Q,QO!T$uO#U,SO#V,QO']$`O!R&pX!c&pX~O_#Oi!R#Oi'W#Oi!O#Oi!c#Oin#Oi!T#Oi%Q#Oi!]#Oi~P!)cO#W!za!R!za!c!za!{!za!T!za_!za'W!za!O!za~P!#rO#W'eXP'eXZ'eX_'eXj'eXv'eX!a'eX!d'eX!j'eX#['eX#]'eX#^'eX#_'eX#`'eX#a'eX#b'eX#c'eX#e'eX#g'eX#i'eX#j'eX'W'eX'f'eX!c'eX!O'eX!T'eXn'eX%Q'eX!]'eX~P!'QO!R,]O'a'mX~P!#rO'a,_O~O!R,`O!c'nX~P!)cO!c,cO~O!O,dO~OP#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O'fQOZ#Zi_#Zij#Zi!R#Zi!a#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O#[#Zi~P!EtO#[#PO~P!EtOP#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO'fQOZ#Zi_#Zi!R#Zi!a#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~Oj#Zi~P!H`Oj#RO~P!H`OP#^Oj#ROu!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO'fQO_#Zi!R#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~OZ#Zi!a#Zi#a#Zi#b#Zi#c#Zi~P!JzOZ#dO!a#TO#a#TO#b#TO#c#TO~P!JzOP#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO'fQO_#Zi!R#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O'w#Zi~P!MrO'w!}O~P!MrOP#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO'fQO'w!}O_#Zi!R#Zi#i#Zi#j#Zi'W#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O'x#Zi~P#!^O'x#OO~P#!^OP#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO'fQO'w!}O'x#OO~O_#Zi!R#Zi#j#Zi'W#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~P#$xOP[XZ[Xj[Xu[Xv[Xx[X!a[X!b[X!d[X!j[X!{[X#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'f[X'p[X'w[X'x[X!R[X!S[X~O#m[X~P#']OP#^OZ9iOj9^Ou!{Ov!{Ox!|O!a9`O!b!yO!d!zO!j#^O#[9[O#]9]O#^9]O#_9]O#`9_O#a9`O#b9`O#c9`O#e9aO#g9cO#i9eO#j9fO'fQO'p#[O'w!}O'x#OO~O#m,fO~P#)gOP'iXZ'iXj'iXu'iXv'iXx'iX!a'iX!b'iX!d'iX!j'iX#['iX#]'iX#^'iX#_'iX#`'iX#a'iX#b'iX#e'iX#g'iX#i'iX#j'iX'f'iX'p'iX'w'iX'x'iX!R'iX~O!{9jO#o9jO#c'iX#m'iX!S'iX~P#+bO_&sa!R&sa'W&sa!c&san&sa!O&sa!T&sa%Q&sa!]&sa~P!)cOP#ZiZ#Zi_#Zij#Ziv#Zi!R#Zi!a#Zi!b#Zi!d#Zi!j#Zi#[#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'f#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~P!#rO_#ni!R#ni'W#ni!O#ni!c#nin#ni!T#ni%Q#ni!]#ni~P!)cO#z,hO~O#z,iO~O!]'kO!{,jO!T$OX#w$OX#z$OX$R$OX~O!Q,kO~O!T'nO#w,mO#z'mO$R,nO~O!R9gO!S'hX~P#)gO!S,oO~O$R,qO~OR'|O'U'}O'V,tO~O],wOk,wO!O,xO~O!RdX!]dX!cdX!c$eX'pdX~P!!iO!c-OO~P!#rO!R-PO!]!wO'p&nO!c'}X~O!c-UO~O!O$eX!R$eX!]$lX~P!!iO!R-WO!O(OX~P!#rO!]-YO~O!O-[O~O!Q(_O']$`O!c'}P~Oj-`O!]!wO!d$XO'b$cO'p&nO~O!])_O~O_$[O!R-eO'W$[O~O!S-gO~P!&XO!X-hO!Y-hO'^$bO'g(gO~Ox-jO'g(gO~O!x-kO~O']$zO!R&xX'a&xX~O!R(wO'a'ca~Ou-pOv-pOx-qO'pra'wra'xra!Rra!{ra~O'ara#mra~P#6qOu(ROx(SO'p$^a'w$^a'x$^a!R$^a!{$^a~O'a$^a#m$^a~P#7gOu(ROx(SO'p$`a'w$`a'x$`a!R$`a!{$`a~O'a$`a#m$`a~P#8YO]-rO~O#W-sO~O'a$na!R$na#m$na!{$na~P!#rO#W-vO~OS.PO!T&cO!o.OO%Q-}O~O'a.QO~O]#qOj#rOk#qOl#qOq$POs9kOx#xO!T#yO!_;RO!d#vO#V9tO#t$TO$_9nO$a9qO$d$UO'f#sO~Oh.SO'].RO~P#:PO!])_O!T'`a_'`a!R'`a'W'`a~O#W.YO~OZ[X!RdX!SdX~O!R.ZO!S(VX~O!S.]O~OZ.^O~O].`O'])gO~O!T$kO']$`O^'QX!R'QX~O!R)lO^(Ua~O!c.cO~P!)cO].eO~OZ.fO~O^.gO~OS.PO!T&cO!o.OO%Q-}O'b$cO~O!R)xO_(Ra'W(Ra~O!{.mO~OS.pO!T#yO~O'g'SO!S(SP~OS.zO!T.vO!o.yO%Q.xO'b$cO~OZ/UO!R/SO!S(TX~O!S/VO~O^/XO_$[O'W$[O~O]/YO~O]/ZO'](yO~O#c/[O%r/]O~P0zO!{#eO#c/[O%r/]O~O_/^O~P){O_/`O~O%{/dOP%yiQ%yiX%yi]%yi_%yib%yic%yih%yij%yik%yil%yiq%yis%yix%yi{%yi|%yi}%yi!T%yi!_%yi!d%yi!g%yi!h%yi!i%yi!j%yi!k%yi!n%yi#d%yi#t%yi#x%yi%P%yi%R%yi%T%yi%U%yi%X%yi%Z%yi%^%yi%_%yi%a%yi%n%yi%t%yi%v%yi%x%yi%z%yi%}%yi&T%yi&Z%yi&]%yi&_%yi&a%yi&c%yi'S%yi']%yi'f%yi'o%yi'|%yi!S%yi`%yi&Q%yi~O`/jO!S/hO&Q/iO~P`O!TSO!d/lO~O&X*uOP&SiQ&SiX&Si]&Si_&Sib&Sic&Sih&Sij&Sik&Sil&Siq&Sis&Six&Si{&Si|&Si}&Si!T&Si!_&Si!d&Si!g&Si!h&Si!i&Si!j&Si!k&Si!n&Si#d&Si#t&Si#x&Si%P&Si%R&Si%T&Si%U&Si%X&Si%Z&Si%^&Si%_&Si%a&Si%n&Si%t&Si%v&Si%x&Si%z&Si%}&Si&T&Si&Z&Si&]&Si&_&Si&a&Si&c&Si'S&Si']&Si'f&Si'o&Si'|&Si!S&Si%{&Si`&Si&Q&Si~O!R#bOn$]a~O!O&ii!R&ii~P!)cO!R%yO!O'ji~O!R&_O!O'ti~O!O/rO~O!R!Va!S!Va~P#)gO]&QOk&QO!Q/xO'g(gO!R&jX!S&jX~P@aO!R+^O!S'ka~O]&YOk&YO!Q)wO'g'SO!R&oX!S&oX~O!R+aO!S'va~O!O'ui!R'ui~P!)cO_$[O!]!wO!d$XO!j0SO!{0QO'W$[O'b$cO'p&nO~O!S0VO~P!?]O!X0WO!Y0WO'^$bO'g(gO'o+gO~O!W0XO~P#LVO!TSO!W0XO!u0ZO!x0[O~P#LVO!W0XO!s0^O!t0^O!u0ZO!x0[O~P#LVO!T&cO~O!T&cO~P!#rO!R'ri!c'ri_'ri'W'ri~P!)cO!{0gO!R'ri!c'ri_'ri'W'ri~O!R&sO!c'qi~Ox$tO!T$uO#V0iO']$`O~O#WraPraZra_rajra!ara!bra!dra!jra#[ra#]ra#^ra#_ra#`ra#ara#bra#cra#era#gra#ira#jra'Wra'fra!cra!Ora!Tranra%Qra!]ra~P#6qO#W$^aP$^aZ$^a_$^aj$^av$^a!a$^a!b$^a!d$^a!j$^a#[$^a#]$^a#^$^a#_$^a#`$^a#a$^a#b$^a#c$^a#e$^a#g$^a#i$^a#j$^a'W$^a'f$^a!c$^a!O$^a!T$^an$^a%Q$^a!]$^a~P#7gO#W$`aP$`aZ$`a_$`aj$`av$`a!a$`a!b$`a!d$`a!j$`a#[$`a#]$`a#^$`a#_$`a#`$`a#a$`a#b$`a#c$`a#e$`a#g$`a#i$`a#j$`a'W$`a'f$`a!c$`a!O$`a!T$`an$`a%Q$`a!]$`a~P#8YO#W$naP$naZ$na_$naj$nav$na!R$na!a$na!b$na!d$na!j$na#[$na#]$na#^$na#_$na#`$na#a$na#b$na#c$na#e$na#g$na#i$na#j$na'W$na'f$na!c$na!O$na!T$na!{$nan$na%Q$na!]$na~P!#rO_#Oq!R#Oq'W#Oq!O#Oq!c#Oqn#Oq!T#Oq%Q#Oq!]#Oq~P!)cO!R&kX'a&kX~PJdO!R,]O'a'ma~O!Q0qO!R&lX!c&lX~P){O!R,`O!c'na~O!R,`O!c'na~P!)cO#m!fa!S!fa~PCcO#m!^a!R!^a!S!^a~P#)gO!T1UO#x^O$P1VO~O!S1ZO~On1[O~P!#rO_$Yq!R$Yq'W$Yq!O$Yq!c$Yqn$Yq!T$Yq%Q$Yq!]$Yq~P!)cO!O1]O~O],wOk,wO~Ou(ROx(SO'x(WO'p$xi'w$xi!R$xi!{$xi~O'a$xi#m$xi~P$,vOu(ROx(SO'p$zi'w$zi'x$zi!R$zi!{$zi~O'a$zi#m$zi~P$-iO#m1^O~P!#rO!Q1`O']$`O!R&tX!c&tX~O!R-PO!c'}a~O!R-PO!]!wO!c'}a~O!R-PO!]!wO'p&nO!c'}a~O'a$gi!R$gi#m$gi!{$gi~P!#rO!Q1gO'](bO!O&vX!R&vX~P!$aO!R-WO!O(Oa~O!R-WO!O(Oa~P!#rO!]!wO~O!]!wO#c1oO~Oj1rO!]!wO'p&nO~O!R'di'a'di~P!#rO!{1uO!R'di'a'di~P!#rO!c1xO~O_$Zq!R$Zq'W$Zq!O$Zq!c$Zqn$Zq!T$Zq%Q$Zq!]$Zq~P!)cO!R1|O!T(PX~P!#rO!T&cO%Q2PO~O!T&cO%Q2PO~P!#rO!T$eX$u[X_$eX!R$eX'W$eX~P!!iO$u2TOugXxgX!TgX'pgX'wgX'xgX_gX!RgX'WgX~O$u2TO~O]2ZO%R2[O'])gO!R'PX!S'PX~O!R.ZO!S(Va~OZ2`O~O^2aO~O]2dO~OS2fO!T&cO!o2eO%Q2PO~O_$[O'W$[O~P!#rO!T#yO~P!#rO!R2kO!{2mO!S(SX~O!S2nO~Ox;]O!W2wO!X2pO!Y2pO!r2vO!s2uO!t2uO!x2tO'^$bO'g(gO'o+gO~O!S2sO~P$6QOS3OO!T.vO!o2}O%Q2|O~OS3OO!T.vO!o2}O%Q2|O'b$cO~O'](yO!R'OX!S'OX~O!R/SO!S(Ta~O]3YO'g3XO~O]3ZO~O^3]O~O!c3`O~P){O_3bO~O_3bO~P){O#c3dO%r3eO~PE{O`/jO!S3iO&Q/iO~P`O!]3kO~O!R#Ti!S#Ti~P#)gO!{3mO!R#Ti!S#Ti~O!R!Vi!S!Vi~P#)gO_$[O!{3tO'W$[O~O_$[O!]!wO!{3tO'W$[O~O!X3xO!Y3xO'^$bO'g(gO'o+gO~O_$[O!]!wO!d$XO!j3yO!{3tO'W$[O'b$cO'p&nO~O!W3zO~P$:oO!W3zO!u3}O!x4OO~P$:oO_$[O!]!wO!j3yO!{3tO'W$[O'p&nO~O!R'rq!c'rq_'rq'W'rq~P!)cO!R&sO!c'qq~O#W$xiP$xiZ$xi_$xij$xiv$xi!a$xi!b$xi!d$xi!j$xi#[$xi#]$xi#^$xi#_$xi#`$xi#a$xi#b$xi#c$xi#e$xi#g$xi#i$xi#j$xi'W$xi'f$xi!c$xi!O$xi!T$xin$xi%Q$xi!]$xi~P$,vO#W$ziP$ziZ$zi_$zij$ziv$zi!a$zi!b$zi!d$zi!j$zi#[$zi#]$zi#^$zi#_$zi#`$zi#a$zi#b$zi#c$zi#e$zi#g$zi#i$zi#j$zi'W$zi'f$zi!c$zi!O$zi!T$zin$zi%Q$zi!]$zi~P$-iO#W$giP$giZ$gi_$gij$giv$gi!R$gi!a$gi!b$gi!d$gi!j$gi#[$gi#]$gi#^$gi#_$gi#`$gi#a$gi#b$gi#c$gi#e$gi#g$gi#i$gi#j$gi'W$gi'f$gi!c$gi!O$gi!T$gi!{$gin$gi%Q$gi!]$gi~P!#rO!R&ka'a&ka~P!#rO!R&la!c&la~P!)cO!R,`O!c'ni~O#m#Oi!R#Oi!S#Oi~P#)gOP#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O'fQOZ#Zij#Zi!a#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~O#[#Zi~P$DVO#[9[O~P$DVOP#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[9[O#]9]O#^9]O#_9]O'fQOZ#Zi!a#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~Oj#Zi~P$F_Oj9^O~P$F_OP#^Oj9^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[9[O#]9]O#^9]O#_9]O#`9_O'fQO#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~OZ#Zi!a#Zi#a#Zi#b#Zi#c#Zi~P$HgOZ9iO!a9`O#a9`O#b9`O#c9`O~P$HgOP#^OZ9iOj9^Ou!{Ov!{Ox!|O!a9`O!b!yO!d!zO!j#^O#[9[O#]9]O#^9]O#_9]O#`9_O#a9`O#b9`O#c9`O#e9aO'fQO#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'x#Zi!R#Zi!S#Zi~O'w#Zi~P$J{O'w!}O~P$J{OP#^OZ9iOj9^Ou!{Ov!{Ox!|O!a9`O!b!yO!d!zO!j#^O#[9[O#]9]O#^9]O#_9]O#`9_O#a9`O#b9`O#c9`O#e9aO#g9cO'fQO'w!}O#i#Zi#j#Zi#m#Zi'p#Zi!R#Zi!S#Zi~O'x#Zi~P$MTO'x#OO~P$MTOP#^OZ9iOj9^Ou!{Ov!{Ox!|O!a9`O!b!yO!d!zO!j#^O#[9[O#]9]O#^9]O#_9]O#`9_O#a9`O#b9`O#c9`O#e9aO#g9cO#i9eO'fQO'w!}O'x#OO~O#j#Zi#m#Zi'p#Zi!R#Zi!S#Zi~P% ]O_#ky!R#ky'W#ky!O#ky!c#kyn#ky!T#ky%Q#ky!]#ky~P!)cOP#ZiZ#Zij#Ziv#Zi!a#Zi!b#Zi!d#Zi!j#Zi#[#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'f#Zi!R#Zi!S#Zi~P!#rO!b!yOu'eXx'eX'p'eX'w'eX'x'eX!S'eX~OP'eXZ'eXj'eXv'eX!a'eX!d'eX!j'eX#['eX#]'eX#^'eX#_'eX#`'eX#a'eX#b'eX#c'eX#e'eX#g'eX#i'eX#j'eX#m'eX'f'eX!R'eX~P%%mO#m#ni!R#ni!S#ni~P#)gO!S4`O~O!R&sa!S&sa~P#)gO!]!wO'p&nO!R&ta!c&ta~O!R-PO!c'}i~O!R-PO!]!wO!c'}i~O!O&va!R&va~P!#rO!]4gO~O!R-WO!O(Oi~P!#rO!R-WO!O(Oi~O!O4kO~O!]!wO#c4pO~Oj4qO!]!wO'p&nO~O!O4sO~O'a$iq!R$iq#m$iq!{$iq~P!#rO_$Zy!R$Zy'W$Zy!O$Zy!c$Zyn$Zy!T$Zy%Q$Zy!]$Zy~P!)cO!R1|O!T(Pa~O!T&cO%Q4xO~O!T&cO%Q4xO~P!#rO_#Oy!R#Oy'W#Oy!O#Oy!c#Oyn#Oy!T#Oy%Q#Oy!]#Oy~P!)cOZ4{O~O]4}O'])gO~O!R.ZO!S(Vi~O]5QO~O^5RO~O'g'SO!R&{X!S&{X~O!R2kO!S(Sa~O!S5`O~P$6QOx;^O'g(gO'o+gO~O!W5cO!X5bO!Y5bO!x0[O'^$bO'g(gO'o+gO~O!s5dO!t5dO~P%.RO!X5bO!Y5bO'^$bO'g(gO'o+gO~O!T.vO~O!T.vO%Q5fO~O!T.vO%Q5fO~P!#rOS5kO!T.vO!o5jO%Q5fO~OZ5pO!R'Oa!S'Oa~O!R/SO!S(Ti~O]5sO~O!c5tO~O!c5uO~O!c5vO~O!c5vO~P){O_5xO~O!]5{O~O!c5|O~O!R'ui!S'ui~P#)gO_$[O'W$[O~P!)cO_$[O!{6RO'W$[O~O_$[O!]!wO!{6RO'W$[O~O!X6WO!Y6WO'^$bO'g(gO'o+gO~O_$[O!]!wO!j6XO!{6RO'W$[O'p&nO~O!d$XO'b$cO~P%2mO!W6YO~P%2[O!R'ry!c'ry_'ry'W'ry~P!)cO#W$iqP$iqZ$iq_$iqj$iqv$iq!R$iq!a$iq!b$iq!d$iq!j$iq#[$iq#]$iq#^$iq#_$iq#`$iq#a$iq#b$iq#c$iq#e$iq#g$iq#i$iq#j$iq'W$iq'f$iq!c$iq!O$iq!T$iq!{$iqn$iq%Q$iq!]$iq~P!#rO!R&li!c&li~P!)cO#m#Oq!R#Oq!S#Oq~P#)gOu-pOv-pOx-qO'pra'wra'xra!Sra~OPraZrajra!ara!bra!dra!jra#[ra#]ra#^ra#_ra#`ra#ara#bra#cra#era#gra#ira#jra#mra'fra!Rra~P%6eOu(ROx(SO'p$^a'w$^a'x$^a!S$^a~OP$^aZ$^aj$^av$^a!a$^a!b$^a!d$^a!j$^a#[$^a#]$^a#^$^a#_$^a#`$^a#a$^a#b$^a#c$^a#e$^a#g$^a#i$^a#j$^a#m$^a'f$^a!R$^a~P%8fOu(ROx(SO'p$`a'w$`a'x$`a!S$`a~OP$`aZ$`aj$`av$`a!a$`a!b$`a!d$`a!j$`a#[$`a#]$`a#^$`a#_$`a#`$`a#a$`a#b$`a#c$`a#e$`a#g$`a#i$`a#j$`a#m$`a'f$`a!R$`a~P%:gOP$naZ$naj$nav$na!a$na!b$na!d$na!j$na#[$na#]$na#^$na#_$na#`$na#a$na#b$na#c$na#e$na#g$na#i$na#j$na#m$na'f$na!R$na!S$na~P!#rO#m$Yq!R$Yq!S$Yq~P#)gO#m$Zq!R$Zq!S$Zq~P#)gO!S6dO~O'a$|y!R$|y#m$|y!{$|y~P!#rO!]!wO!R&ti!c&ti~O!]!wO'p&nO!R&ti!c&ti~O!R-PO!c'}q~O!O&vi!R&vi~P!#rO!R-WO!O(Oq~O!O6jO~P!#rO!O6jO~O!R'dy'a'dy~P!#rO!R&ya!T&ya~P!#rO!T$tq_$tq!R$tq'W$tq~P!#rOZ6qO~O!R.ZO!S(Vq~O]6tO~O!T&cO%Q6uO~O!T&cO%Q6uO~P!#rO!{6vO!R&{a!S&{a~O!R2kO!S(Si~P#)gO!X6|O!Y6|O'^$bO'g(gO'o+gO~O!W7OO!x4OO~P%BkO!T.vO%Q7RO~O!T.vO%Q7RO~P!#rO]7YO'g7XO~O!R/SO!S(Tq~O!c7[O~O!c7[O~P){O!c7^O~O!c7_O~O!R#Ty!S#Ty~P#)gO_$[O!{7eO'W$[O~O_$[O!]!wO!{7eO'W$[O~O!X7hO!Y7hO'^$bO'g(gO'o+gO~O_$[O!]!wO!j7iO!{7eO'W$[O'p&nO~O#W$|yP$|yZ$|y_$|yj$|yv$|y!R$|y!a$|y!b$|y!d$|y!j$|y#[$|y#]$|y#^$|y#_$|y#`$|y#a$|y#b$|y#c$|y#e$|y#g$|y#i$|y#j$|y'W$|y'f$|y!c$|y!O$|y!T$|y!{$|yn$|y%Q$|y!]$|y~P!#rO#m#ky!R#ky!S#ky~P#)gOP$giZ$gij$giv$gi!a$gi!b$gi!d$gi!j$gi#[$gi#]$gi#^$gi#_$gi#`$gi#a$gi#b$gi#c$gi#e$gi#g$gi#i$gi#j$gi#m$gi'f$gi!R$gi!S$gi~P!#rOu(ROx(SO'x(WO'p$xi'w$xi!S$xi~OP$xiZ$xij$xiv$xi!a$xi!b$xi!d$xi!j$xi#[$xi#]$xi#^$xi#_$xi#`$xi#a$xi#b$xi#c$xi#e$xi#g$xi#i$xi#j$xi#m$xi'f$xi!R$xi~P%JROu(ROx(SO'p$zi'w$zi'x$zi!S$zi~OP$ziZ$zij$ziv$zi!a$zi!b$zi!d$zi!j$zi#[$zi#]$zi#^$zi#_$zi#`$zi#a$zi#b$zi#c$zi#e$zi#g$zi#i$zi#j$zi#m$zi'f$zi!R$zi~P%LSO#m$Zy!R$Zy!S$Zy~P#)gO#m#Oy!R#Oy!S#Oy~P#)gO!]!wO!R&tq!c&tq~O!R-PO!c'}y~O!O&vq!R&vq~P!#rO!O7mO~P!#rO!R.ZO!S(Vy~O!R2kO!S(Sq~O!X7yO!Y7yO'^$bO'g(gO'o+gO~O!T.vO%Q7|O~O!T.vO%Q7|O~P!#rO!c8PO~O_$[O!{8UO'W$[O~O_$[O!]!wO!{8UO'W$[O~OP$iqZ$iqj$iqv$iq!a$iq!b$iq!d$iq!j$iq#[$iq#]$iq#^$iq#_$iq#`$iq#a$iq#b$iq#c$iq#e$iq#g$iq#i$iq#j$iq#m$iq'f$iq!R$iq!S$iq~P!#rO!R&{q!S&{q~P#)gO_$[O!{8hO'W$[O~OP$|yZ$|yj$|yv$|y!a$|y!b$|y!d$|y!j$|y#[$|y#]$|y#^$|y#_$|y#`$|y#a$|y#b$|y#c$|y#e$|y#g$|y#i$|y#j$|y#m$|y'f$|y!R$|y!S$|y~P!#rO!S!za!W!za!X!za!Y!za!r!za!s!za!t!za!x!za'^!za'g!za'o!za~P!#rO!W'eX!X'eX!Y'eX!r'eX!s'eX!t'eX!x'eX'^'eX'g'eX'o'eX~P%%mO!Wra!Xra!Yra!rra!sra!tra!xra'^ra'gra'ora~P%6eO!W$^a!X$^a!Y$^a!r$^a!s$^a!t$^a!x$^a'^$^a'g$^a'o$^a~P%8fO!W$`a!X$`a!Y$`a!r$`a!s$`a!t$`a!x$`a'^$`a'g$`a'o$`a~P%:gO!S$na!W$na!X$na!Y$na!r$na!s$na!t$na!x$na'^$na'g$na'o$na~P!#rO!W$xi!X$xi!Y$xi!r$xi!s$xi!t$xi!x$xi'^$xi'g$xi'o$xi~P%JRO!W$zi!X$zi!Y$zi!r$zi!s$zi!t$zi!x$zi'^$zi'g$zi'o$zi~P%LSO!S$gi!W$gi!X$gi!Y$gi!r$gi!s$gi!t$gi!x$gi'^$gi'g$gi'o$gi~P!#rO!S$iq!W$iq!X$iq!Y$iq!r$iq!s$iq!t$iq!x$iq'^$iq'g$iq'o$iq~P!#rO!S$|y!W$|y!X$|y!Y$|y!r$|y!s$|y!t$|y!x$|y'^$|y'g$|y'o$|y~P!#rOn'hX~P.jOn[X!O[X!c[X%r[X!T[X%Q[X!][X~P$zO!]dX!c[X!cdX'pdX~P;aOP9TOQ9TO]cOb;POc!jOhcOj9TOkcOlcOq9TOs9TOxRO{cO|cO}cO!TSO!_9VO!dUO!g9TO!h9TO!i9TO!j9TO!k9TO!n!iO#t!lO#x^O']'bO'fQO'oYO'|:}O~O]#qOh$OOj#rOk#qOl#qOq$POs9lOx#xO!T#yO!_;SO!d#vO#V9uO#t$TO$_9oO$a9rO$d$UO']&zO'f#sO~O!R9gO!S$]a~O]#qOh$OOj#rOk#qOl#qOq$POs9mOx#xO!T#yO!_;TO!d#vO#V9vO#t$TO$_9pO$a9sO$d$UO']&zO'f#sO~O#d'iO~P&3xO!S[X!SdX~P;aO!]9ZO~O#W9YO~O!]!wO#W9YO~O!{9jO~O#c9`O~O!{9wO!R'uX!S'uX~O!{9jO!R'sX!S'sX~O#W9xO~O'a9zO~P!#rO#W:RO~O#W:SO~O#W:TO~O!]!wO#W:UO~O!]!wO#W9xO~O#m:VO~P#)gO#W:WO~O#W:XO~O#W:YO~O#W:ZO~O#W:[O~O#m:]O~P!#rO#m:^O~P!#rO#m:_O~P!#rO!O:`O~O!O:aO~P!#rO!O:aO~O!O:bO~P!#rO!]!wO#c;YO~O!]!wO#c;[O~O#x~!b!r!t!u#U#V'|$_$a$d$u%P%Q%R%X%Z%^%_%a%c~UT#x'|#]}'Y'Z#z'Y']'g~",goto:"#Hc(ZPPPPPPPP([P(lP*`PPPP-zPP.a3s5g5zP5zPPP5zP7t5zP5zP7xPP8OP8d<uPPPP<yPPPP<y?kPPP?qBSP<yPDgPPPPF`<yPPPPPHX<yPPKYLVPPPPLZMsPM{N|PLV<y<y!$^!'X!+z!+z!/ZPPP!/b!2W<yPPPPPPPPPP!4}P!6`PP<y!7mP<yP<y<y<y<yP<y!:[PP!=TP!?x!@Q!@U!@UP!=QP!@Y!@YP!B}P!CR<y<y!CX!E{5zP5zP5z5zP!GO5z5z!IU5z!Ki5z!Mi5z5z!NV#!]#!]#!a#!]#!iP#!]P5z##e5z#$y5z5z-zPPP#&cPP#&{#&{P#&{P#'b#&{PP#'hP#'_P#'_#'zMw#'_#(i#(o#(r([#(u([P#(|#(|#(|P([P([P([P([PP([P#)S#)VP#)V([P#)ZP#)^P([P([P([P([P([P([([#)d#)n#)t#)z#*Y#*`#*f#*p#*v#+V#+]#+k#+q#+w#,V#,l#.[#.j#.p#.v#.|#/S#/^#/d#/j#/t#0W#0^PPPPPPPP#0dPP#1W#4`PP#5v#5}#6VPP#;X#=l#Ch#Ck#Cn#Cy#C|PP#DP#DT#Dr#Ei#Em#FRPP#FV#F]#FaP#Fd#Fh#Fk#GZ#Gq#Gv#Gy#G|#HS#HV#HZ#H_mhOSj}!n$Z%b%e%f%h*m*r/d/gQ$hmQ$opQ%YyS&U!b+^Q&j!jS(j#y(oQ)e$iQ)r$qQ*^%SQ+d&]S+i&c+kQ+{&kQ-h(qQ/R*_Y0W+m+n+o+p+qS2p.v2rU3x0X0Z0^U5b2u2v2wS6W3z3}S6|5c5dQ7h6YR7y7O$p[ORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%b%d%e%f%h%l%w%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8h!j'd#]#k&V'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QQ(z$QQ)j$kQ*`%VQ*g%_Q,V9kQ.T)_Q.`)kQ/Z*eQ2Z.ZQ3V/SQ4X9mQ4}2[R8s9lpeOSjy}!n$Z%X%b%e%f%h*m*r/d/gR*b%Z&WVOSTjkn}!S!W!k!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$Z$m%Z%^%_%b%d%e%f%h%l%y&R&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;P;Q[!cRU!]!`%w&VQ$alQ$gmS$lp$qv$vrs!r!u$X$t&_&s&v)v)w)x*k+W+f,Q,S/l0iQ%OwQ&g!iQ&i!jS(^#v(hS)d$h$iQ)h$kQ)u$sQ*X%QQ*]%SS+z&j&kQ-T(_Q.X)eQ._)kQ.a)lQ.d)pQ.|*YS/Q*^*_Q0e+{Q1_-PQ2Y.ZQ2^.^Q2c.fQ3U/RQ4d1`Q4|2[Q5P2`Q6p4{R7p6q!Y$em!j$g$h$i&T&i&j&k(i)d)e+Z+h+z+{-a.X/}0T0Y0e1q3w3|6U7f8VQ)]$aQ)}${Q*Q$|Q*[%SQ.h)uQ.{*XU/P*]*^*_Q3P.|S3T/Q/RQ5]2oQ5o3US6z5^5aS7w6{6}Q8_7xR8n8`W#|a$c(w:}S${t%XQ$|uQ$}vR){$y$o#{a!w!y#d#v#x$R$S$W&f'|(V(X(Y(a(e(u(v)Y)[)_)|*P+w,]-W-Y-s-}.P.m.p.x.z1^1g1o1u1|2P2T2f2|3O4g4p4x5f5k6u7R7|9Z9i9n9o9p9q9r9s9t9u9v9{9|9}:O:P:Q:R:S:T:W:X:Y:]:^:_:};U;V;W;Y;[T'}#s(OX({$Q9k9l9mU&Y!b$u+aQ'T!{Q)o$nQ.q*RQ1v-pR5X2k&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&V&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;Q$]#aZ!_!o$_%v%|&x'P'V'W'X'Y'Z'[']'^'_'`'a'c'f'j't)n+P+[+e+|,[,b,e,g,u-t/s/v0f0p0t0u0v0w0x0y0z0{0|0}1O1P1Q1T1Y1z2W3o3r4S4V4W4]4^5Z5}6Q6^6b6c7b7s8S8f8r9U:pT!XQ!Y&_cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&V&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QQ&W!bR/y+^Y&Q!b&U&]+^+dS(i#y(oS+h&c+kS-a(j(qQ-b(kQ-i(rQ.s*TU0T+i+m+nU0Y+o+p+qS0_+r2tQ1q-hQ1s-jQ1t-kS2o.v2rU3w0W0X0ZQ3{0[Q3|0^S5^2p2wS5a2u2vU6U3x3z3}Q6Z4OS6{5b5cQ6}5dS7f6W6YS7x6|7OQ8V7hQ8`7yQ;X;]R;Z;^lhOSj}!n$Z%b%e%f%h*m*r/d/gQ%j!QS&w!v9YQ)b$fQ*V%OQ*W%PQ+x&hS,Z&|9xS-u)S:UQ.V)cQ.u*UQ/k*tQ/m*uQ/u+XQ0]+oQ0c+yS1{-v:ZQ2U.WS2X.Y:[Q3n/wQ3q0OQ4Q0dQ4z2VQ6O3pQ6S3vQ6[4RQ7`5|Q7c6TQ8R7dQ8e8TR8q8g$W#`Z!_!o%v%|&x'P'V'W'X'Y'Z'[']'^'_'`'a'c'f'j't)n+P+[+e+|,[,b,e,u-t/s/v0f0p0t0u0v0w0x0y0z0{0|0}1O1P1Q1T1Y1z2W3o3r4S4V4W4]4^5Z5}6Q6^6b6c7b7s8S8f8r9U:pW(t#z&{1S8jT)W$_,g$W#_Z!_!o%v%|&x'P'V'W'X'Y'Z'[']'^'_'`'a'c'f'j't)n+P+[+e+|,[,b,e,u-t/s/v0f0p0t0u0v0w0x0y0z0{0|0}1O1P1Q1T1Y1z2W3o3r4S4V4W4]4^5Z5}6Q6^6b6c7b7s8S8f8r9U:pQ'e#`S)V$_,gR-w)W&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&V&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QQ%e{Q%f|Q%h!OQ%i!PR/c*pQ&d!iQ)X$aQ+u&gS-|)])uS0`+s+tW2O-y-z-{.hS4P0a0bU4w2Q2R2SU6n4v5T5UQ7o6oR8Z7rT+j&c+kS+h&c+kU0T+i+m+nU0Y+o+p+qS0_+r2tS2o.v2rU3w0W0X0ZQ3{0[Q3|0^S5^2p2wS5a2u2vU6U3x3z3}Q6Z4OS6{5b5cQ6}5dS7f6W6YS7x6|7OQ8V7hR8`7yS+j&c+kT2q.v2rS&q!q/aQ-S(^Q-_(iS0S+h2oQ1d-TS1l-`-iU3y0Y0_5aQ4c1_S4n1r1tU6X3{3|6}Q6f4dQ6m4qR7i6ZQ!xXS&p!q/aQ)T$YQ)`$dQ)f$jQ,O&qQ-R(^Q-^(iQ-c(lQ.U)aQ.}*ZS0R+h2oS1c-S-TS1k-_-iQ1n-bQ1p-dQ3R/OW3u0S0Y0_5aQ4b1_Q4f1dS4j1l1tQ4o1sQ5m3SW6V3y3{3|6}S6e4c4dS6i4k:`Q6k4nQ6x5[Q7V5nS7g6X6ZQ7k6fS7l6j:aQ7n6mQ7u6yQ8O7WQ8W7iS8Y7m:bQ8]7vQ8l8^Q8x8mQ9P8yQ:i:dQ:t:nQ:u:oQ:y;XR:{;Z$rWORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8hS!xn!k!j:c#]#k&V'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QR:i;P$rXORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8hQ$Yb!Y$dm!j$g$h$i&T&i&j&k(i)d)e+Z+h+z+{-a.X/}0T0Y0e1q3w3|6U7f8VS$jn!kQ)a$eQ*Z%SW/O*[*]*^*_U3S/P/Q/RQ5[2oS5n3T3UU6y5]5^5aQ7W5oU7v6z6{6}S8^7w7xS8m8_8`Q8y8n!j:d#]#k&V'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QQ:n;OR:o;P$f]OSTjk}!S!W!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%b%d%e%f%h%l%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8hY!hRU!]!`%wv$vrs!r!u$X$t&_&s&v)v)w)x*k+W+f,Q,S/l0iQ*h%_!h:e#]#k'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QR:h&VS&Z!b$uR/{+a$p[ORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%b%d%e%f%h%l%w%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8h!j'd#]#k&V'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QR*g%_$roORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8hQ'T!{!k:f#]#k&V'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;Q!h#VZ!_$_%v%|&x'P'^'_'`'a'f'j)n+P+e+|,[,b,u-t0f0p1Q1z2W3r4S4V6Q7b8S8f8r9U!R9b'c't+[,g/s/v0t0|0}1O1P1T1Y3o4W4]4^5Z5}6^6b6c7s:p!d#XZ!_$_%v%|&x'P'`'a'f'j)n+P+e+|,[,b,u-t0f0p1Q1z2W3r4S4V6Q7b8S8f8r9U}9d'c't+[,g/s/v0t1O1P1T1Y3o4W4]4^5Z5}6^6b6c7s:p!`#]Z!_$_%v%|&x'P'f'j)n+P+e+|,[,b,u-t0f0p1Q1z2W3r4S4V6Q7b8S8f8r9Un(Y#t&})R,}-V-l-m0n1y4a4r:j:v:w:xx;Q'c't+[,g/s/v0t1T1Y3o4W4]4^5Z5}6^6b6c7s:p!d;U&y'h(](c+t,Y,r-Z-x-{.l.n0b0m1e1i2S2h2j2z4U4h4l4t4y5U5i6]6h6l7T:z:|Y;V8i8v8}9Q9SZ;W1R4[6_7j8X&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&V&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QS#l`#mR1V,j&e_ORSTU`jk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k#m$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&V&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,j,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QS#g^#nT'm#i'qT#h^#nT'o#i'q&e`ORSTU`jk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k#m$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&V&^&e&o&|'Q'v(Q)S)Z*i*m*r+R+V+Y+v+},`,f,j,k-q-v.O.Y.y/[/]/^/`/d/g/i/x0Q0g0q1U2e2m2}3b3d3e3m3t5j5x6R6v7e8U8h9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;QT#l`#mQ#o`R'x#m$rbORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$Z$m%Z%^%_%b%d%e%f%h%l%w%y&R&^&e&o&|'Q(Q)S)Z*i*m*r+R+v+},`,f-q-v.O.Y.y/[/]/^/`/d/g/i0Q0g0q2e2}3b3d3e3t5j5x6R7e8U8h!k;O#]#k&V'v+V+Y,k/x1U2m3m6v9T9V9Y9[9]9^9_9`9a9b9c9d9e9f9g9j9w9x9z:U:V:Z:[;Q#RdOSUj}!S!W!n!|#k$Z%Z%^%_%b%d%e%f%h%l&R&e'v)Z*i*m*r+v,k-q.O.y/[/]/^/`/d/g/i1U2e2}3b3d3e5j5xv#za!y$R$S$W(V(X(Y(a(u(v,]-s1^1u:};U;V;W#Q&{!w#d#v#x&f'|(e)Y)[)_)|*P+w-W-Y-}.P.m.p.x.z1g1o1|2P2T2f2|3O4g4p4x5f5k6u7R7|9n9q9t9{:O:R:W:];Y;[Q)P$UQ,v(Rb1S9i9p9s9v9}:Q:T:Y:_c8j9Z9o9r9u9|:P:S:X:^v#wa!y$R$S$W(V(X(Y(a(u(v,]-s1^1u:};U;V;WS(l#y(oQ)Q$VQ-d(m#Q:k!w#d#v#x&f'|(e)Y)[)_)|*P+w-W-Y-}.P.m.p.x.z1g1o1|2P2T2f2|3O4g4p4x5f5k6u7R7|9n9q9t9{:O:R:W:];Y;[b:l9Z9o9r9u9|:P:S:X:^b:m9i9p9s9v9}:Q:T:Y:_Q:q;RQ:r;SR:s;Tv#za!y$R$S$W(V(X(Y(a(u(v,]-s1^1u:};U;V;W#Q&{!w#d#v#x&f'|(e)Y)[)_)|*P+w-W-Y-}.P.m.p.x.z1g1o1|2P2T2f2|3O4g4p4x5f5k6u7R7|9n9q9t9{:O:R:W:];Y;[b1S9i9p9s9v9}:Q:T:Y:_c8j9Z9o9r9u9|:P:S:X:^lfOSj}!n$Z%b%e%f%h*m*r/d/gQ(d#xQ*{%oQ*|%qR1f-W$n#{a!w!y#d#v#x$R$S$W&f'|(V(X(Y(a(e(u(v)Y)[)_)|*P+w,]-W-Y-s-}.P.m.p.x.z1^1g1o1u1|2P2T2f2|3O4g4p4x5f5k6u7R7|9Z9i9n9o9p9q9r9s9t9u9v9{9|9}:O:P:Q:R:S:T:W:X:Y:]:^:_:};U;V;W;Y;[Q*O$|Q.o*QQ2i.nR5W2jT(n#y(oS(n#y(oT2q.v2rQ)`$dQ-c(lQ.U)aQ.}*ZQ3R/OQ5m3SQ6x5[Q7V5nQ7u6yQ8O7WQ8]7vQ8l8^Q8x8mR9P8yn(V#t&})R,}-V-l-m0n1y4a4r:j:v:w:x!d9{&y'h(](c+t,Y,r-Z-x-{.l.n0b0m1e1i2S2h2j2z4U4h4l4t4y5U5i6]6h6l7T:z:|Y9|8i8v8}9Q9SZ9}1R4[6_7j8Xp(X#t&})R,{,}-V-l-m0n1y4a4r:j:v:w:x!f:O&y'h(](c+t,Y,r-Z-x-{.l.n0b0k0m1e1i2S2h2j2z4U4h4l4t4y5U5i6]6h6l7T:z:|[:P8i8v8{8}9Q9S]:Q1R4[6_6`7j8XpeOSjy}!n$Z%X%b%e%f%h*m*r/d/gQ%UxR*i%_peOSjy}!n$Z%X%b%e%f%h*m*r/d/gR%UxQ*S$}R.k){qeOSjy}!n$Z%X%b%e%f%h*m*r/d/gQ.w*XS2{.{.|W5e2x2y2z3PU7Q5g5h5iU7z7P7S7TQ8a7{R8o8bQ%]yR*c%XR3Y/UR7Y5pS$lp$qR.a)lQ%bzR*m%cR*s%iT/e*r/gR*w%jQ*v%jR/n*wQjOQ!nST$^j!nQ(O#sR,s(OQ!YQR%t!YQ!^RU%z!^%{+SQ%{!_R+S%|Q+_&WR/z+_Q,^&}R0o,^Q,a'PS0r,a0sR0s,bQ+k&cR0U+kS!eR$tU&`!e&a+TQ&a!fR+T%}Q+b&ZR/|+bQ&t!sQ,P&rU,T&t,P0jR0j,UQ'q#iR,l'qQ#m`R'w#mQ#cZU'g#c+O9hQ+O9UR9h'tQ-Q(^W1a-Q1b4e6gU1b-R-S-TS4e1c1dR6g4f$Z(T#t&y&}'h(](c(|(})R+t,W,X,Y,r,{,|,}-V-Z-l-m-x-{.l.n0b0k0l0m0n1R1e1i1y2S2h2j2z4U4Y4Z4[4a4h4l4r4t4y5U5i6]6_6`6a6h6l7T7j8X8i8t8u8v8{8|8}9Q9S:j:v:w:x:z:|Q-X(cU1h-X1j4iQ1j-ZR4i1iQ(o#yR-f(oQ(x#}R-o(xQ1}-xR4u1}Q)y$wR.j)yQ2l.qS5Y2l6wR6w5ZQ*U%OR.t*UQ2r.vR5_2rQ/T*`S3W/T5qR5q3YQ.[)hW2].[2_5O6rQ2_._Q5O2^R6r5PQ)m$lR.b)mQ/g*rR3h/gWiOSj!nQ%g}Q)U$ZQ*l%bQ*n%eQ*o%fQ*q%hQ/b*mS/e*r/gR3g/dQ$]gQ%k!RQ%n!TQ%p!UQ%r!VQ)t$rQ)z$xQ*b%]Q*y%mQ-e(nS/W*c*fQ/o*xQ/p*{Q/q*|S0P+h2oQ2b.eQ2g.lQ3Q.}Q3[/YQ3f/cY3s0R0S0Y0_5aQ5S2dQ5V2hQ5l3RQ5r3Z[6P3r3u3y3{3|6}Q6s5QQ7U5mQ7Z5sW7a6Q6V6X6ZQ7q6tQ7t6xQ7}7VU8Q7b7g7iQ8[7uQ8c8OS8d8S8WQ8k8]Q8p8fQ8w8lQ8z8rQ9O8xR9R9PQ$fmQ&h!jU)c$g$h$iQ+X&TU+y&i&j&kQ-](iS.W)d)eQ/w+ZQ0O+hS0d+z+{Q1m-aQ2V.XQ3p/}S3v0T0YQ4R0eQ4m1qS6T3w3|Q7d6UQ8T7fR8g8VS#ua:}R)^$cU#}a$c:}R-n(wQ#taS&y!w)_Q&}!yQ'h#dQ(]#vQ(c#xQ(|$RQ(}$SQ)R$WQ+t&fQ,W9nQ,X9qQ,Y9tQ,r'|Q,{(VQ,|(XQ,}(YQ-V(aQ-Z(eQ-l(uQ-m(vd-x)Y-}.x2P2|4x5f6u7R7|Q-{)[Q.l)|Q.n*PQ0b+wQ0k9{Q0l:OQ0m:RQ0n,]Q1R9iQ1e-WQ1i-YQ1y-sQ2S.PQ2h.mQ2j.pQ2z.zQ4U:WQ4Y9pQ4Z9sQ4[9vQ4a1^Q4h1gQ4l1oQ4r1uQ4t1|Q4y2TQ5U2fQ5i3OQ6]:]Q6_:TQ6`9}Q6a:QQ6h4gQ6l4pQ7T5kQ7j:YQ8X:_Q8i9ZQ8t9oQ8u9rQ8v9uQ8{9|Q8|:PQ8}:SQ9Q:XQ9S:^Q:j:}Q:v;UQ:w;VQ:x;WQ:z;YR:|;[lgOSj}!n$Z%b%e%f%h*m*r/d/gS!pU%dQ%m!SQ%s!WQ'U!|Q'u#kS*f%Z%^Q*j%_Q*x%lQ+U&RQ+s&eQ,p'vQ-z)ZQ/_*iQ0a+vQ1X,kQ1w-qQ2R.OQ2y.yQ3^/[Q3_/]Q3a/^Q3c/`Q3j/iQ4_1UQ5T2eQ5h2}Q5w3bQ5y3dQ5z3eQ7S5jR7]5x!vZOSUj}!S!n!|$Z%Z%^%_%b%d%e%f%h%l&R&e)Z*i*m*r+v-q.O.y/[/]/^/`/d/g/i2e2}3b3d3e5j5xQ!_RQ!oTQ$_kS%v!]%yQ%|!`Q&x!vQ'P!zQ'V#PQ'W#QQ'X#RQ'Y#SQ'Z#TQ'[#UQ']#VQ'^#WQ'_#XQ'`#YQ'a#ZQ'c#]Q'f#bQ'j#eW't#k'v,k1UQ)n$mS+P%w+RS+[&V/xQ+e&^Q+|&oQ,[&|Q,b'QQ,e9TQ,g9VQ,u(QQ-t)SQ/s+VQ/v+YQ0f+}Q0p,`Q0t9YQ0u9[Q0v9]Q0w9^Q0x9_Q0y9`Q0z9aQ0{9bQ0|9cQ0}9dQ1O9eQ1P9fQ1Q,fQ1T9jQ1Y9gQ1z-vQ2W.YQ3o9wQ3r0QQ4S0gQ4V0qQ4W9xQ4]9zQ4^:UQ5Z2mQ5}3mQ6Q3tQ6^:VQ6b:ZQ6c:[Q7b6RQ7s6vQ8S7eQ8f8UQ8r8hQ9U!WR:p;QR!aRR&X!bS&T!b+^S+Z&U&]R/}+dR'O!yR'R!zT!tU$XS!sU$XU$wrs*kS&r!r!uQ,R&sQ,U&vQ.i)xS0h,Q,SR4T0i`!dR!]!`$t%w&_)v+fh!qUrs!r!u$X&s&v)x,Q,S0iQ/a*kQ/t+WQ3l/lT:g&V)wT!gR$tS!fR$tS%x!]&_S%}!`)vS+Q%w+fT+]&V)wT&[!b$uQ#i^R'z#nT'p#i'qR1W,jT(`#v(hR(f#xQ-y)YQ2Q-}Q2x.xQ4v2PQ5g2|Q6o4xQ7P5fQ7r6uQ7{7RR8b7|lhOSj}!n$Z%b%e%f%h*m*r/d/gQ%[yR*b%XV$xrs*kR.r*RR*a%VQ$ppR)s$qR)i$kT%`z%cT%az%cT/f*r/g",nodeNames:"\u26A0 ArithOp ArithOp InterpolationStart extends LineComment BlockComment Script ExportDeclaration export Star as VariableName String from ; default FunctionDeclaration async function VariableDefinition TypeParamList TypeDefinition ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Interpolation null super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression await yield delete LogicOp BitOp ParenthesizedExpression ClassExpression class extends ClassBody MethodDeclaration Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression PrivatePropertyName BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody MethodDeclaration AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement",maxTerm:332,context:yQ,nodeProps:[["closedBy",3,"InterpolationEnd",40,"]",51,"}",66,")",132,"JSXSelfCloseEndTag JSXEndTag",146,"JSXEndTag"],["group",-26,8,15,17,58,184,188,191,192,194,197,200,211,213,219,221,223,225,228,234,240,242,244,246,248,250,251,"Statement",-30,12,13,24,27,28,41,43,44,45,47,52,60,68,74,75,91,92,101,103,119,122,124,125,126,127,129,130,148,149,151,"Expression",-22,23,25,29,32,34,152,154,156,157,159,160,161,163,164,165,167,168,169,178,180,182,183,"Type",-3,79,85,90,"ClassItem"],["openedBy",30,"InterpolationStart",46,"[",50,"{",65,"(",131,"JSXStartTag",141,"JSXStartTag JSXStartCloseTag"]],propSources:[QQ],skippedNodes:[0,5,6],repeatNodeCount:28,tokenData:"!C}~R!`OX%TXY%cYZ'RZ[%c[]%T]^'R^p%Tpq%cqr'crs(kst0htu2`uv4pvw5ewx6cxy<yyz=Zz{=k{|>k|}?O}!O>k!O!P?`!P!QCl!Q!R!0[!R![!1q![!]!7s!]!^!8V!^!_!8g!_!`!9d!`!a!:[!a!b!<R!b!c%T!c!}2`!}#O!=d#O#P%T#P#Q!=t#Q#R!>U#R#S2`#S#T!>i#T#o2`#o#p!>y#p#q!?O#q#r!?f#r#s!?x#s$f%T$f$g%c$g#BY2`#BY#BZ!@Y#BZ$IS2`$IS$I_!@Y$I_$I|2`$I|$I}!Bq$I}$JO!Bq$JO$JT2`$JT$JU!@Y$JU$KV2`$KV$KW!@Y$KW&FU2`&FU&FV!@Y&FV?HT2`?HT?HU!@Y?HU~2`W%YR$UWO!^%T!_#o%T#p~%T7Z%jg$UW'Y7ROX%TXY%cYZ%TZ[%c[p%Tpq%cq!^%T!_#o%T#p$f%T$f$g%c$g#BY%T#BY#BZ%c#BZ$IS%T$IS$I_%c$I_$JT%T$JT$JU%c$JU$KV%T$KV$KW%c$KW&FU%T&FU&FV%c&FV?HT%T?HT?HU%c?HU~%T7Z'YR$UW'Z7RO!^%T!_#o%T#p~%T$T'jS$UW!j#{O!^%T!_!`'v!`#o%T#p~%T$O'}S#e#v$UWO!^%T!_!`(Z!`#o%T#p~%T$O(bR#e#v$UWO!^%T!_#o%T#p~%T'u(rZ$UW]!ROY(kYZ)eZr(krs*rs!^(k!^!_+U!_#O(k#O#P-b#P#o(k#o#p+U#p~(k&r)jV$UWOr)ers*Ps!^)e!^!_*a!_#o)e#o#p*a#p~)e&r*WR$P&j$UWO!^%T!_#o%T#p~%T&j*dROr*ars*ms~*a&j*rO$P&j'u*{R$P&j$UW]!RO!^%T!_#o%T#p~%T'm+ZV]!ROY+UYZ*aZr+Urs+ps#O+U#O#P+w#P~+U'm+wO$P&j]!R'm+zROr+Urs,Ts~+U'm,[U$P&j]!ROY,nZr,nrs-Vs#O,n#O#P-[#P~,n!R,sU]!ROY,nZr,nrs-Vs#O,n#O#P-[#P~,n!R-[O]!R!R-_PO~,n'u-gV$UWOr(krs-|s!^(k!^!_+U!_#o(k#o#p+U#p~(k'u.VZ$P&j$UW]!ROY.xYZ%TZr.xrs/rs!^.x!^!_,n!_#O.x#O#P0S#P#o.x#o#p,n#p~.x!Z/PZ$UW]!ROY.xYZ%TZr.xrs/rs!^.x!^!_,n!_#O.x#O#P0S#P#o.x#o#p,n#p~.x!Z/yR$UW]!RO!^%T!_#o%T#p~%T!Z0XT$UWO!^.x!^!_,n!_#o.x#o#p,n#p~.x2k0mZ$UWOt%Ttu1`u!^%T!_!c%T!c!}1`!}#R%T#R#S1`#S#T%T#T#o1`#p$g%T$g~1`2k1g]$UW'o2cOt%Ttu1`u!Q%T!Q![1`![!^%T!_!c%T!c!}1`!}#R%T#R#S1`#S#T%T#T#o1`#p$g%T$g~1`7Z2k_$UW#zS']%k'g2bOt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$g%T$g~2`[3q_$UW#zSOt%Ttu3ju}%T}!O3j!O!Q%T!Q![3j![!^%T!_!c%T!c!}3j!}#R%T#R#S3j#S#T%T#T#o3j#p$g%T$g~3j$O4wS#^#v$UWO!^%T!_!`5T!`#o%T#p~%T$O5[R$UW#o#vO!^%T!_#o%T#p~%T6d5lU'x6[$UWOv%Tvw6Ow!^%T!_!`5T!`#o%T#p~%T$O6VS$UW#i#vO!^%T!_!`5T!`#o%T#p~%T'u6jZ$UW]!ROY6cYZ7]Zw6cwx*rx!^6c!^!_8T!_#O6c#O#P:T#P#o6c#o#p8T#p~6c&r7bV$UWOw7]wx*Px!^7]!^!_7w!_#o7]#o#p7w#p~7]&j7zROw7wwx*mx~7w'm8YV]!ROY8TYZ7wZw8Twx+px#O8T#O#P8o#P~8T'm8rROw8Twx8{x~8T'm9SU$P&j]!ROY9fZw9fwx-Vx#O9f#O#P9}#P~9f!R9kU]!ROY9fZw9fwx-Vx#O9f#O#P9}#P~9f!R:QPO~9f'u:YV$UWOw6cwx:ox!^6c!^!_8T!_#o6c#o#p8T#p~6c'u:xZ$P&j$UW]!ROY;kYZ%TZw;kwx/rx!^;k!^!_9f!_#O;k#O#P<e#P#o;k#o#p9f#p~;k!Z;rZ$UW]!ROY;kYZ%TZw;kwx/rx!^;k!^!_9f!_#O;k#O#P<e#P#o;k#o#p9f#p~;k!Z<jT$UWO!^;k!^!_9f!_#o;k#o#p9f#p~;k%V=QR!d$}$UWO!^%T!_#o%T#p~%TZ=bR!cR$UWO!^%T!_#o%T#p~%T5s=tU'^2s#_#v$UWOz%Tz{>W{!^%T!_!`5T!`#o%T#p~%T$O>_S#[#v$UWO!^%T!_!`5T!`#o%T#p~%T$u>rSj$m$UWO!^%T!_!`5T!`#o%T#p~%T&i?VR!R&a$UWO!^%T!_#o%T#p~%T7Z?gVu6`$UWO!O%T!O!P?|!P!Q%T!Q![@r![!^%T!_#o%T#p~%Ty@RT$UWO!O%T!O!P@b!P!^%T!_#o%T#p~%Ty@iR!Qq$UWO!^%T!_#o%T#p~%Ty@yZ$UWkqO!Q%T!Q![@r![!^%T!_!g%T!g!hAl!h#R%T#R#S@r#S#X%T#X#YAl#Y#o%T#p~%TyAqZ$UWO{%T{|Bd|}%T}!OBd!O!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%TyBiV$UWO!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%TyCVV$UWkqO!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T7ZCs`$UW#]#vOYDuYZ%TZzDuz{Jl{!PDu!P!Q!-e!Q!^Du!^!_Fx!_!`!.^!`!a!/]!a!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~DuXD|[$UW}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~DuXEy_$UW}PO!^%T!_#Z%T#Z#[Er#[#]%T#]#^Er#^#a%T#a#bEr#b#g%T#g#hEr#h#i%T#i#jEr#j#m%T#m#nEr#n#o%T#p~%TPF}V}POYFxZ!PFx!P!QGd!Q!}Fx!}#OG{#O#PHh#P~FxPGiU}P#Z#[Gd#]#^Gd#a#bGd#g#hGd#i#jGd#m#nGdPHOTOYG{Z#OG{#O#PH_#P#QFx#Q~G{PHbQOYG{Z~G{PHkQOYFxZ~FxXHvY$UWOYHqYZ%TZ!^Hq!^!_G{!_#OHq#O#PIf#P#QDu#Q#oHq#o#pG{#p~HqXIkV$UWOYHqYZ%TZ!^Hq!^!_G{!_#oHq#o#pG{#p~HqXJVV$UWOYDuYZ%TZ!^Du!^!_Fx!_#oDu#o#pFx#p~Du7ZJs^$UW}POYJlYZKoZzJlz{NQ{!PJl!P!Q!,R!Q!^Jl!^!_!!]!_!}Jl!}#O!'|#O#P!+a#P#oJl#o#p!!]#p~Jl7ZKtV$UWOzKoz{LZ{!^Ko!^!_M]!_#oKo#o#pM]#p~Ko7ZL`X$UWOzKoz{LZ{!PKo!P!QL{!Q!^Ko!^!_M]!_#oKo#o#pM]#p~Ko7ZMSR$UWU7RO!^%T!_#o%T#p~%T7RM`ROzM]z{Mi{~M]7RMlTOzM]z{Mi{!PM]!P!QM{!Q~M]7RNQOU7R7ZNX^$UW}POYJlYZKoZzJlz{NQ{!PJl!P!Q! T!Q!^Jl!^!_!!]!_!}Jl!}#O!'|#O#P!+a#P#oJl#o#p!!]#p~Jl7Z! ^_$UWU7R}PO!^%T!_#Z%T#Z#[Er#[#]%T#]#^Er#^#a%T#a#bEr#b#g%T#g#hEr#h#i%T#i#jEr#j#m%T#m#nEr#n#o%T#p~%T7R!!bY}POY!!]YZM]Zz!!]z{!#Q{!P!!]!P!Q!&x!Q!}!!]!}#O!$`#O#P!&f#P~!!]7R!#VY}POY!!]YZM]Zz!!]z{!#Q{!P!!]!P!Q!#u!Q!}!!]!}#O!$`#O#P!&f#P~!!]7R!#|UU7R}P#Z#[Gd#]#^Gd#a#bGd#g#hGd#i#jGd#m#nGd7R!$cWOY!$`YZM]Zz!$`z{!${{#O!$`#O#P!&S#P#Q!!]#Q~!$`7R!%OYOY!$`YZM]Zz!$`z{!${{!P!$`!P!Q!%n!Q#O!$`#O#P!&S#P#Q!!]#Q~!$`7R!%sTU7ROYG{Z#OG{#O#PH_#P#QFx#Q~G{7R!&VTOY!$`YZM]Zz!$`z{!${{~!$`7R!&iTOY!!]YZM]Zz!!]z{!#Q{~!!]7R!&}_}POzM]z{Mi{#ZM]#Z#[!&x#[#]M]#]#^!&x#^#aM]#a#b!&x#b#gM]#g#h!&x#h#iM]#i#j!&x#j#mM]#m#n!&x#n~M]7Z!(R[$UWOY!'|YZKoZz!'|z{!(w{!^!'|!^!_!$`!_#O!'|#O#P!*o#P#QJl#Q#o!'|#o#p!$`#p~!'|7Z!(|^$UWOY!'|YZKoZz!'|z{!(w{!P!'|!P!Q!)x!Q!^!'|!^!_!$`!_#O!'|#O#P!*o#P#QJl#Q#o!'|#o#p!$`#p~!'|7Z!*PY$UWU7ROYHqYZ%TZ!^Hq!^!_G{!_#OHq#O#PIf#P#QDu#Q#oHq#o#pG{#p~Hq7Z!*tX$UWOY!'|YZKoZz!'|z{!(w{!^!'|!^!_!$`!_#o!'|#o#p!$`#p~!'|7Z!+fX$UWOYJlYZKoZzJlz{NQ{!^Jl!^!_!!]!_#oJl#o#p!!]#p~Jl7Z!,Yc$UW}POzKoz{LZ{!^Ko!^!_M]!_#ZKo#Z#[!,R#[#]Ko#]#^!,R#^#aKo#a#b!,R#b#gKo#g#h!,R#h#iKo#i#j!,R#j#mKo#m#n!,R#n#oKo#o#pM]#p~Ko7Z!-lV$UWT7ROY!-eYZ%TZ!^!-e!^!_!.R!_#o!-e#o#p!.R#p~!-e7R!.WQT7ROY!.RZ~!.R$P!.g[$UW#o#v}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~Du]!/f[#wS$UW}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~Duy!0cd$UWkqO!O%T!O!P@r!P!Q%T!Q![!1q![!^%T!_!g%T!g!hAl!h#R%T#R#S!1q#S#U%T#U#V!3X#V#X%T#X#YAl#Y#b%T#b#c!2w#c#d!4m#d#l%T#l#m!5{#m#o%T#p~%Ty!1x_$UWkqO!O%T!O!P@r!P!Q%T!Q![!1q![!^%T!_!g%T!g!hAl!h#R%T#R#S!1q#S#X%T#X#YAl#Y#b%T#b#c!2w#c#o%T#p~%Ty!3OR$UWkqO!^%T!_#o%T#p~%Ty!3^W$UWO!Q%T!Q!R!3v!R!S!3v!S!^%T!_#R%T#R#S!3v#S#o%T#p~%Ty!3}Y$UWkqO!Q%T!Q!R!3v!R!S!3v!S!^%T!_#R%T#R#S!3v#S#b%T#b#c!2w#c#o%T#p~%Ty!4rV$UWO!Q%T!Q!Y!5X!Y!^%T!_#R%T#R#S!5X#S#o%T#p~%Ty!5`X$UWkqO!Q%T!Q!Y!5X!Y!^%T!_#R%T#R#S!5X#S#b%T#b#c!2w#c#o%T#p~%Ty!6QZ$UWO!Q%T!Q![!6s![!^%T!_!c%T!c!i!6s!i#R%T#R#S!6s#S#T%T#T#Z!6s#Z#o%T#p~%Ty!6z]$UWkqO!Q%T!Q![!6s![!^%T!_!c%T!c!i!6s!i#R%T#R#S!6s#S#T%T#T#Z!6s#Z#b%T#b#c!2w#c#o%T#p~%T%w!7|R!]V$UW#m%hO!^%T!_#o%T#p~%T!P!8^R_w$UWO!^%T!_#o%T#p~%T6i!8rR'bd!a0`#x&s'|P!P!Q!8{!^!_!9Q!_!`!9_W!9QO$WW#v!9VP#`#v!_!`!9Y#v!9_O#o#v#v!9dO#a#v%w!9kT!{%o$UWO!^%T!_!`'v!`!a!9z!a#o%T#p~%T$P!:RR#W#w$UWO!^%T!_#o%T#p~%T%w!:gT'a!s#a#v$RS$UWO!^%T!_!`!:v!`!a!;W!a#o%T#p~%T$O!:}R#a#v$UWO!^%T!_#o%T#p~%T$O!;_T#`#v$UWO!^%T!_!`5T!`!a!;n!a#o%T#p~%T$O!;uS#`#v$UWO!^%T!_!`5T!`#o%T#p~%T6i!<YV'p6a$UWO!O%T!O!P!<o!P!^%T!_!a%T!a!b!=P!b#o%T#p~%T)z!<vRv)r$UWO!^%T!_#o%T#p~%T$O!=WS$UW#j#vO!^%T!_!`5T!`#o%T#p~%T7V!=kRx6}$UWO!^%T!_#o%T#p~%TZ!={R!OR$UWO!^%T!_#o%T#p~%T$O!>]S#g#v$UWO!^%T!_!`5T!`#o%T#p~%T$P!>pR$UW'f#wO!^%T!_#o%T#p~%T~!?OO!T~6d!?VT'w6[$UWO!^%T!_!`5T!`#o%T#p#q!=P#q~%T5g!?oR!S5]nQ$UWO!^%T!_#o%T#p~%TX!@PR!kP$UWO!^%T!_#o%T#p~%T7Z!@gr$UW'Y7R#zS']%k'g2bOX%TXY%cYZ%TZ[%c[p%Tpq%cqt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$f%T$f$g%c$g#BY2`#BY#BZ!@Y#BZ$IS2`$IS$I_!@Y$I_$JT2`$JT$JU!@Y$JU$KV2`$KV$KW!@Y$KW&FU2`&FU&FV!@Y&FV?HT2`?HT?HU!@Y?HU~2`7Z!CO_$UW'Z7R#zS']%k'g2bOt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$g%T$g~2`",tokenizers:[SQ,kQ,$Q,0,1,2,3,4,5,6,7,8,9,wQ],topRules:{Script:[0,7]},dialects:{jsx:11707,ts:11709},dynamicPrecedences:{149:1,176:1},specialized:[{term:289,get:(n,e)=>vQ(n,e)<<1},{term:289,get:n=>TQ[n]||-1},{term:299,get:n=>PQ[n]||-1},{term:63,get:n=>AQ[n]||-1}],tokenPrec:11730}),CQ=[_i("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),_i("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),_i("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),_i(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"block",type:"keyword"}),_i(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),_i('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),_i('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],zn=no.define({parser:RQ.configure({props:[Op.add({IfStatement:kl({except:/^\s*({|else\b)/}),TryStatement:kl({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:y2,SwitchBody:n=>{let e=n.textAfter,t=/^\s*\}/.test(e),i=/^\s*(case|default)\b/.test(e);return n.baseIndent+(t?0:i?1:2)*n.unit},Block:b2({closing:"}"}),ArrowFunction:n=>n.baseIndent+n.unit,"TemplateString BlockComment":()=>-1,"Statement Property":kl({except:/^{/}),JSXElement(n){let e=/^\s*<\//.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},JSXEscape(n){let e=/\s*\}/.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},"JSXOpenTag JSXSelfClosingTag"(n){return n.column(n.node.from)+n.unit}}),wp.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression":k2,BlockComment(n){return{from:n.from+2,to:n.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),IQ=zn.configure({dialect:"ts"}),EQ=zn.configure({dialect:"jsx"}),WQ=zn.configure({dialect:"jsx ts"});function DQ(n={}){let e=n.jsx?n.typescript?WQ:EQ:n.typescript?IQ:zn;return new f2(e,[zn.data.of({autocomplete:Pk(["LineComment","BlockComment","String"],bg(CQ))}),n.jsx?BQ:[]])}function rd(n,e,t=n.length){if(!e)return"";let i=e.getChild("JSXIdentifier");return i?n.sliceString(i.from,Math.min(i.to,t)):""}const MQ=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),BQ=Y.inputHandler.of((n,e,t,i)=>{if((MQ?n.composing:n.compositionStarted)||n.state.readOnly||e!=t||i!=">"&&i!="/"||!zn.isActiveAt(n.state,e,-1))return!1;let{state:r}=n,s=r.changeByRange(o=>{var l,a,h;let{head:c}=o,f=Re(r).resolveInner(c,-1),u;if(f.name=="JSXStartTag"&&(f=f.parent),i==">"&&f.name=="JSXFragmentTag")return{range:P.cursor(c+1),changes:{from:c,insert:"><>"}};if(i==">"&&f.name=="JSXIdentifier"){if(((a=(l=f.parent)===null||l===void 0?void 0:l.lastChild)===null||a===void 0?void 0:a.name)!="JSXEndTag"&&(u=rd(r.doc,f.parent,c)))return{range:P.cursor(c+1),changes:{from:c,insert:`></${u}>`}}}else if(i=="/"&&f.name=="JSXFragmentTag"){let d=f.parent,p=d==null?void 0:d.parent;if(d.from==c-1&&((h=p.lastChild)===null||h===void 0?void 0:h.name)!="JSXEndTag"&&(u=rd(r.doc,p==null?void 0:p.firstChild,c))){let g=`/${u}>`;return{range:P.cursor(c+g.length),changes:{from:c,insert:g}}}}return{range:o}});return s.changes.empty?!1:(n.dispatch(s,{userEvent:"input.type",scrollIntoView:!0}),!0)});class LQ extends At{constructor(e){super(),this.checked=e}eq(e){return e.checked===this.checked}ignoreEvent(){return!1}toDOM(){const e=document.createElement("span");e.classList.add("cm-boolean-toggle"),e.setAttribute("aria-hidden","true");const t=e.appendChild(document.createElement("input"));return t.type="checkbox",t.checked=this.checked,e}}function sd(n){const e=[],t=Re(n.state);for(const{from:i,to:r}of n.visibleRanges)t.iterate({from:i,to:r,enter(s){if(s.name!=="BooleanLiteral")return;const o=n.state.doc.sliceString(s.from,s.to)==="true",l=j.widget({widget:new LQ(o),side:0});e.push(l.range(s.from))}});return j.set(e)}function zQ(n,e){const t=n.state.doc.sliceString(e,e+5);let i;if(t==="false")i={from:e,to:e+5,insert:"true"};else if(t.startsWith("true"))i={from:e,to:e+4,insert:"false"};else return!1;return n.dispatch({changes:i}),ge("RUN"),!0}var _Q=Pe.fromClass(class{constructor(n){this.decorations=sd(n)}update(n){(n.docChanged||n.viewportChanged)&&(this.decorations=sd(n.view))}},{decorations:n=>n.decorations,eventHandlers:{mousedown:(n,e)=>{if(n.target.nodeName==="INPUT"&&n.target.parentElement.classList.contains("cm-boolean-toggle"))return zQ(e,e.posAtDOM(n.target))}}});function UQ(n,e,t,i){if(e.name!=="TaggedTemplateExpression")return;const r=t.resolve(e.from,1);if((r==null?void 0:r.name)!=="VariableName"||i.sliceString(r.from,r.to)!==n)return;const o=r.nextSibling;if((o==null?void 0:o.name)!=="TemplateString")return;const l=i.sliceString(o.from,o.to);if(!!l.endsWith("`"))return{text:l.slice(1,-1),nameFrom:r.from,nameTo:r.to,textFrom:o.from+1,textTo:o.to-1}}const NQ=[["bitmap","bitmap"],["tune","sequencer"],["map","map"]];class XQ extends At{constructor(e,t,i,r,s){super(),this.label=e,this.editorType=t,this.text=i,this.from=r,this.to=s}eq(e){return e.text===this.text&&e.from===this.from&&e.to===this.to}ignoreEvent(){return!1}toDOM(){const e=document.createElement("span");e.classList.add("cm-open-button");const t=e.appendChild(document.createElement("button"));return t.textContent=this.label,t.addEventListener("click",()=>this.onClick()),this.editorType==="bitmap"&&e.appendChild(document.createElement("bitmap-preview")).setAttribute("text",this.text),e}updateDOM(e){const t=e.children[0],i=t.cloneNode(!0);return i.addEventListener("click",()=>this.onClick()),e.replaceChild(i,t),this.editorType==="sprite"&&e.querySelector("bitmap-preview").setAttribute("text",this.text),!0}onClick(){ge("SET_EDIT_RANGE",{range:[this.from,this.to]}),ge("SET_ASSET_EDITOR",{type:this.editorType,text:this.text})}}function od(n){const e=[],t=[],i=Re(n);return i.iterate({enter(r){for(const[s,o]of NQ){const l=UQ(s,r,i,n.doc);if(!l)continue;const a=j.replace({widget:new XQ(s,o,l.text,l.textFrom,l.textTo)});e.push(a.range(l.nameFrom,l.nameTo)),t.push({from:l.textFrom,to:l.textTo});break}}}),{decorations:j.set(e),foldRanges:t}}var ZQ=Ce.define({create(n){return od(n)},update(n,e){return e.docChanged?od(e.state):{...n,decorations:n.decorations.map(e.changes)}},provide(n){return[Y.decorations.from(n,e=>e.decorations),yp.from(n,e=>(t,i,r)=>{var s;return(s=e.foldRanges.find(o=>o.from>=i&&o.from<=r))!=null?s:null})]}});function jQ(n=()=>{}){return new Y({state:le.create({extensions:[E$,Nr.of([Gv]),Xr.of("    "),DQ(),_Q,ZQ,Y.updateListener.of(n)]})})}function GQ(n,e=[]){let t=n[0],i=t.name.split(".");if(i[0],i[i.length-1],e.length>0&&e.includes(enxtension))throw"Extension not recongized: "+i;qQ(t)}function qQ(n){var e=new FileReader;e.readAsText(n),e.onloadend=t=>{let i=e.result;try{const r=oi.codemirror.state.doc.toString();ge("SET_EDITOR_TEXT",{text:i,range:[0,r.length]})}catch{}}}function FQ(n,e){e("drop","",function(t){let r=t.dataTransfer.files;GQ(r),ld(t)}),e("dragover","",function(t){ld(t)})}function ld(n){return n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,n.returnValue=!1,!1}function VQ(n,e){let t=!1;e("mousedown",".vertical-bar",i=>{t=!0}),e("mousemove","",i=>{if(!t)return;let r=i.clientX/window.innerWidth*100;if(r===0)return;const s=0,o=100;r<s&&(r=s),r>o&&(r=o),document.documentElement.style.setProperty("--editor-width",`${r}%`),YQ(i)}),e("mouseup","",i=>{t=!1}),e("mouseleave","",i=>{t=!1})}function YQ(n){return n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,n.returnValue=!1,!1}const Sm=n=>n.composedPath()[0],HQ=(n,e)=>Sm(n).matches(e),JQ=n=>(e,t,i)=>{n.addEventListener(e,r=>{r.trigger=Sm(r),(t===""||HQ(r,t))&&i(r)})};function KQ(n){const e=JQ(document.body);e("keydown","",function(t){t.code==="Enter"&&(t.shiftKey||t.ctrlKey||t.metaKey)&&(t.preventDefault(),ge("RUN"))}),e("mousedown",".docs-trigger",function(t){const i=s=>{document.documentElement.style.setProperty("--docs-percentage",`${s}%`)};getComputedStyle(document.documentElement).getPropertyValue("--docs-percentage").trim()==="0%"?i(75):i(0),document.querySelector(".docs").classList.toggle("docs-expanded")}),window.addEventListener("unload",()=>{ah(n)}),VQ(n,e),FQ(n,e)}function eT({err:n},e){console.log(n);const t=n.stack.match(/<anonymous>:(.+)\)/);let i=null,r=null;if(t){let o=t[1].split(":").map(Number);i=o[0]-2,r=o[1]}const s=i&&r?`${n.message} on line ${i} in column ${r}`:n.message;e.errorInfo={line:i},e.logs=[...e.logs,s],ge("RENDER"),km(e)}function km(n){var i;const e=(i=n.errorInfo)==null?void 0:i.line,t=document.querySelectorAll(".cm-line");for(let r=0;r<t.length;r++){if(!e||r+1!==e)continue;const s=t[r];s.classList.add("err-line"),s.style.background="#ecb2b2"}}async function tT(n,e){ge("RENDER"),e.codemirror=jQ(()=>{km(e)}),e.codemirror.dom.id="code-editor",console.log(e.codemirror.dom),console.log(document.querySelector("#code-editor")),document.querySelector("#code-editor").replaceWith(e.codemirror.dom),KQ(e);const t=window.localStorage.getItem("puzzle-lab")||"[]";e.savedGames=JSON.parse(t);const i=Object.fromEntries(e.savedGames);"DRAFT"in i&&ge("SET_EDITOR_TEXT",{text:i.DRAFT,range:[0,0]}),window.addEventListener("error",s=>{s.message.includes("Uncaught EvalError")||(console.error(s.error),ge("LOG_ERROR",{err:s.error}))});const r=await Ob();if(r){const s={from:0,insert:r};e.codemirror.dispatch({changes:s})}fetch("/docs.md").then(s=>s.text()).then(s=>{e.docs=s,ge("RENDER")}),document.querySelector(".game-canvas").focus(),ge("RENDER")}function iT(n){return n=n.replaceAll(" ","-"),n===""&&(n="defaultName"),console.log(n),n}function nT({name:n},e){e.name=iT(n);const t=document.querySelector(".menu-name");t.innerText=e.name}function rT(n,e){const t=new Blob([e],{type:"text/plain"}),i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=`${n}`,i.click(),URL.revokeObjectURL(i)}async function sT(n){console.log(n);const e=await fetch(n).then(s=>s.text()),t=/(import).*(from)\s*"(.*)"/gm,i=n.split("/").slice(0,-1).join("/"),r=[...e.matchAll(t)].map(s=>s[3].startsWith("./")?`${i}${s[3].slice(1)}`:s[3]);return console.log(r),e}const oT=`http://${window.location.host}/dispatches/fetchAndBundle/test1.js`;sT(oT);const lT={INIT:tT,RUN:pb,SET_BITMAPS({bitmaps:n},e){e.bitmaps=n},UPLOAD(n,e){rb(e.codemirror.state.doc.toString())},SAVE_TO_FILE(n,e){const t=e.codemirror.state.doc.toString(),i=t.match(/@title:\s+([^\n]+)/),r=i!==null?i[1]:"DRAFT";rT(`${r}.js`,t)},LOG_ERROR:eT,SET_EDIT_RANGE({range:n},e){e.editRange=n},SET_ASSET_EDITOR({type:n,text:e},t){if(t.editor=n,ge("RENDER"),n===null)return;const i=document.getElementById("asset-editor");i.loadInitValue&&i.loadInitValue({text:e,bitmaps:t.bitmaps})},SET_EDITOR_TEXT({text:n,range:e},t){const[i,r]=e,s={from:i,to:r,insert:n};t.codemirror.dispatch({changes:s}),ge("RENDER"),t.editRange!==null&&(t.editRange[1]=t.editRange[0]+n.length)},SET_NAME:nT,LOAD_FROM_DATA({data:n},e){console.log(n)},RENDER(n,e){fO(document.querySelector(".root"),a1(e))}};function ge(n,e={}){const t=lT[n];return t?t(e,oi):(console.log("Action not recongnized:",n),null)}ge("INIT");
